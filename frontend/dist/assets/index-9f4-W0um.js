(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}})();function Fh(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var pd={exports:{}},Sl={},gd={exports:{}},se={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Js=Symbol.for("react.element"),Rh=Symbol.for("react.portal"),Ah=Symbol.for("react.fragment"),Lh=Symbol.for("react.strict_mode"),Ih=Symbol.for("react.profiler"),Mh=Symbol.for("react.provider"),Ph=Symbol.for("react.context"),$h=Symbol.for("react.forward_ref"),Oh=Symbol.for("react.suspense"),zh=Symbol.for("react.memo"),Uh=Symbol.for("react.lazy"),Uc=Symbol.iterator;function Bh(e){return e===null||typeof e!="object"?null:(e=Uc&&e[Uc]||e["@@iterator"],typeof e=="function"?e:null)}var yd={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},vd=Object.assign,bd={};function Wr(e,t,n){this.props=e,this.context=t,this.refs=bd,this.updater=n||yd}Wr.prototype.isReactComponent={};Wr.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Wr.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function wd(){}wd.prototype=Wr.prototype;function Ri(e,t,n){this.props=e,this.context=t,this.refs=bd,this.updater=n||yd}var Ai=Ri.prototype=new wd;Ai.constructor=Ri;vd(Ai,Wr.prototype);Ai.isPureReactComponent=!0;var Bc=Array.isArray,jd=Object.prototype.hasOwnProperty,Li={current:null},Nd={key:!0,ref:!0,__self:!0,__source:!0};function Sd(e,t,n){var s,a={},l=null,o=null;if(t!=null)for(s in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(l=""+t.key),t)jd.call(t,s)&&!Nd.hasOwnProperty(s)&&(a[s]=t[s]);var i=arguments.length-2;if(i===1)a.children=n;else if(1<i){for(var c=Array(i),u=0;u<i;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(s in i=e.defaultProps,i)a[s]===void 0&&(a[s]=i[s]);return{$$typeof:Js,type:e,key:l,ref:o,props:a,_owner:Li.current}}function Wh(e,t){return{$$typeof:Js,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Ii(e){return typeof e=="object"&&e!==null&&e.$$typeof===Js}function Hh(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Wc=/\/+/g;function ql(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Hh(""+e.key):t.toString(36)}function Da(e,t,n,s,a){var l=typeof e;(l==="undefined"||l==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(l){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Js:case Rh:o=!0}}if(o)return o=e,a=a(o),e=s===""?"."+ql(o,0):s,Bc(a)?(n="",e!=null&&(n=e.replace(Wc,"$&/")+"/"),Da(a,t,n,"",function(u){return u})):a!=null&&(Ii(a)&&(a=Wh(a,n+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(Wc,"$&/")+"/")+e)),t.push(a)),1;if(o=0,s=s===""?".":s+":",Bc(e))for(var i=0;i<e.length;i++){l=e[i];var c=s+ql(l,i);o+=Da(l,t,n,c,a)}else if(c=Bh(e),typeof c=="function")for(e=c.call(e),i=0;!(l=e.next()).done;)l=l.value,c=s+ql(l,i++),o+=Da(l,t,n,c,a);else if(l==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function ca(e,t,n){if(e==null)return e;var s=[],a=0;return Da(e,s,"","",function(l){return t.call(n,l,a++)}),s}function Vh(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ze={current:null},Ta={transition:null},Yh={ReactCurrentDispatcher:Ze,ReactCurrentBatchConfig:Ta,ReactCurrentOwner:Li};function kd(){throw Error("act(...) is not supported in production builds of React.")}se.Children={map:ca,forEach:function(e,t,n){ca(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return ca(e,function(){t++}),t},toArray:function(e){return ca(e,function(t){return t})||[]},only:function(e){if(!Ii(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};se.Component=Wr;se.Fragment=Ah;se.Profiler=Ih;se.PureComponent=Ri;se.StrictMode=Lh;se.Suspense=Oh;se.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Yh;se.act=kd;se.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=vd({},e.props),a=e.key,l=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(l=t.ref,o=Li.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var i=e.type.defaultProps;for(c in t)jd.call(t,c)&&!Nd.hasOwnProperty(c)&&(s[c]=t[c]===void 0&&i!==void 0?i[c]:t[c])}var c=arguments.length-2;if(c===1)s.children=n;else if(1<c){i=Array(c);for(var u=0;u<c;u++)i[u]=arguments[u+2];s.children=i}return{$$typeof:Js,type:e.type,key:a,ref:l,props:s,_owner:o}};se.createContext=function(e){return e={$$typeof:Ph,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Mh,_context:e},e.Consumer=e};se.createElement=Sd;se.createFactory=function(e){var t=Sd.bind(null,e);return t.type=e,t};se.createRef=function(){return{current:null}};se.forwardRef=function(e){return{$$typeof:$h,render:e}};se.isValidElement=Ii;se.lazy=function(e){return{$$typeof:Uh,_payload:{_status:-1,_result:e},_init:Vh}};se.memo=function(e,t){return{$$typeof:zh,type:e,compare:t===void 0?null:t}};se.startTransition=function(e){var t=Ta.transition;Ta.transition={};try{e()}finally{Ta.transition=t}};se.unstable_act=kd;se.useCallback=function(e,t){return Ze.current.useCallback(e,t)};se.useContext=function(e){return Ze.current.useContext(e)};se.useDebugValue=function(){};se.useDeferredValue=function(e){return Ze.current.useDeferredValue(e)};se.useEffect=function(e,t){return Ze.current.useEffect(e,t)};se.useId=function(){return Ze.current.useId()};se.useImperativeHandle=function(e,t,n){return Ze.current.useImperativeHandle(e,t,n)};se.useInsertionEffect=function(e,t){return Ze.current.useInsertionEffect(e,t)};se.useLayoutEffect=function(e,t){return Ze.current.useLayoutEffect(e,t)};se.useMemo=function(e,t){return Ze.current.useMemo(e,t)};se.useReducer=function(e,t,n){return Ze.current.useReducer(e,t,n)};se.useRef=function(e){return Ze.current.useRef(e)};se.useState=function(e){return Ze.current.useState(e)};se.useSyncExternalStore=function(e,t,n){return Ze.current.useSyncExternalStore(e,t,n)};se.useTransition=function(){return Ze.current.useTransition()};se.version="18.3.1";gd.exports=se;var p=gd.exports;const we=Fh(p);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kh=p,Qh=Symbol.for("react.element"),Gh=Symbol.for("react.fragment"),Xh=Object.prototype.hasOwnProperty,qh=Kh.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Jh={key:!0,ref:!0,__self:!0,__source:!0};function Cd(e,t,n){var s,a={},l=null,o=null;n!==void 0&&(l=""+n),t.key!==void 0&&(l=""+t.key),t.ref!==void 0&&(o=t.ref);for(s in t)Xh.call(t,s)&&!Jh.hasOwnProperty(s)&&(a[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)a[s]===void 0&&(a[s]=t[s]);return{$$typeof:Qh,type:e,key:l,ref:o,props:a,_owner:qh.current}}Sl.Fragment=Gh;Sl.jsx=Cd;Sl.jsxs=Cd;pd.exports=Sl;var r=pd.exports,Fo={},_d={exports:{}},vt={},Ed={exports:{}},Dd={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(F,D){var I=F.length;F.push(D);e:for(;0<I;){var P=I-1>>>1,$=F[P];if(0<a($,D))F[P]=D,F[I]=$,I=P;else break e}}function n(F){return F.length===0?null:F[0]}function s(F){if(F.length===0)return null;var D=F[0],I=F.pop();if(I!==D){F[0]=I;e:for(var P=0,$=F.length,A=$>>>1;P<A;){var K=2*(P+1)-1,J=F[K],te=K+1,fe=F[te];if(0>a(J,I))te<$&&0>a(fe,J)?(F[P]=fe,F[te]=I,P=te):(F[P]=J,F[K]=I,P=K);else if(te<$&&0>a(fe,I))F[P]=fe,F[te]=I,P=te;else break e}}return D}function a(F,D){var I=F.sortIndex-D.sortIndex;return I!==0?I:F.id-D.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var o=Date,i=o.now();e.unstable_now=function(){return o.now()-i}}var c=[],u=[],f=1,d=null,y=3,g=!1,b=!1,v=!1,S=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,h=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function m(F){for(var D=n(u);D!==null;){if(D.callback===null)s(u);else if(D.startTime<=F)s(u),D.sortIndex=D.expirationTime,t(c,D);else break;D=n(u)}}function k(F){if(v=!1,m(F),!b)if(n(c)!==null)b=!0,M(j);else{var D=n(u);D!==null&&B(k,D.startTime-F)}}function j(F,D){b=!1,v&&(v=!1,x(C),C=-1),g=!0;var I=y;try{for(m(D),d=n(c);d!==null&&(!(d.expirationTime>D)||F&&!T());){var P=d.callback;if(typeof P=="function"){d.callback=null,y=d.priorityLevel;var $=P(d.expirationTime<=D);D=e.unstable_now(),typeof $=="function"?d.callback=$:d===n(c)&&s(c),m(D)}else s(c);d=n(c)}if(d!==null)var A=!0;else{var K=n(u);K!==null&&B(k,K.startTime-D),A=!1}return A}finally{d=null,y=I,g=!1}}var N=!1,w=null,C=-1,_=5,E=-1;function T(){return!(e.unstable_now()-E<_)}function L(){if(w!==null){var F=e.unstable_now();E=F;var D=!0;try{D=w(!0,F)}finally{D?U():(N=!1,w=null)}}else N=!1}var U;if(typeof h=="function")U=function(){h(L)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,Y=V.port2;V.port1.onmessage=L,U=function(){Y.postMessage(null)}}else U=function(){S(L,0)};function M(F){w=F,N||(N=!0,U())}function B(F,D){C=S(function(){F(e.unstable_now())},D)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(F){F.callback=null},e.unstable_continueExecution=function(){b||g||(b=!0,M(j))},e.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<F?Math.floor(1e3/F):5},e.unstable_getCurrentPriorityLevel=function(){return y},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(F){switch(y){case 1:case 2:case 3:var D=3;break;default:D=y}var I=y;y=D;try{return F()}finally{y=I}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(F,D){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var I=y;y=F;try{return D()}finally{y=I}},e.unstable_scheduleCallback=function(F,D,I){var P=e.unstable_now();switch(typeof I=="object"&&I!==null?(I=I.delay,I=typeof I=="number"&&0<I?P+I:P):I=P,F){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=I+$,F={id:f++,callback:D,priorityLevel:F,startTime:I,expirationTime:$,sortIndex:-1},I>P?(F.sortIndex=I,t(u,F),n(c)===null&&F===n(u)&&(v?(x(C),C=-1):v=!0,B(k,I-P))):(F.sortIndex=$,t(c,F),b||g||(b=!0,M(j))),F},e.unstable_shouldYield=T,e.unstable_wrapCallback=function(F){var D=y;return function(){var I=y;y=D;try{return F.apply(this,arguments)}finally{y=I}}}})(Dd);Ed.exports=Dd;var Zh=Ed.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ex=p,yt=Zh;function O(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Td=new Set,Fs={};function ar(e,t){Lr(e,t),Lr(e+"Capture",t)}function Lr(e,t){for(Fs[e]=t,e=0;e<t.length;e++)Td.add(t[e])}var mn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ro=Object.prototype.hasOwnProperty,tx=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Hc={},Vc={};function nx(e){return Ro.call(Vc,e)?!0:Ro.call(Hc,e)?!1:tx.test(e)?Vc[e]=!0:(Hc[e]=!0,!1)}function rx(e,t,n,s){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function sx(e,t,n,s){if(t===null||typeof t>"u"||rx(e,t,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function et(e,t,n,s,a,l,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=s,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=l,this.removeEmptyString=o}var Be={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Be[e]=new et(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Be[t]=new et(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Be[e]=new et(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Be[e]=new et(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Be[e]=new et(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Be[e]=new et(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Be[e]=new et(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Be[e]=new et(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Be[e]=new et(e,5,!1,e.toLowerCase(),null,!1,!1)});var Mi=/[\-:]([a-z])/g;function Pi(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Mi,Pi);Be[t]=new et(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Mi,Pi);Be[t]=new et(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Mi,Pi);Be[t]=new et(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Be[e]=new et(e,1,!1,e.toLowerCase(),null,!1,!1)});Be.xlinkHref=new et("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Be[e]=new et(e,1,!1,e.toLowerCase(),null,!0,!0)});function $i(e,t,n,s){var a=Be.hasOwnProperty(t)?Be[t]:null;(a!==null?a.type!==0:s||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(sx(t,n,a,s)&&(n=null),s||a===null?nx(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=n===null?a.type===3?!1:"":n:(t=a.attributeName,s=a.attributeNamespace,n===null?e.removeAttribute(t):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,s?e.setAttributeNS(s,t,n):e.setAttribute(t,n))))}var pn=ex.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ua=Symbol.for("react.element"),mr=Symbol.for("react.portal"),fr=Symbol.for("react.fragment"),Oi=Symbol.for("react.strict_mode"),Ao=Symbol.for("react.profiler"),Fd=Symbol.for("react.provider"),Rd=Symbol.for("react.context"),zi=Symbol.for("react.forward_ref"),Lo=Symbol.for("react.suspense"),Io=Symbol.for("react.suspense_list"),Ui=Symbol.for("react.memo"),jn=Symbol.for("react.lazy"),Ad=Symbol.for("react.offscreen"),Yc=Symbol.iterator;function es(e){return e===null||typeof e!="object"?null:(e=Yc&&e[Yc]||e["@@iterator"],typeof e=="function"?e:null)}var Ne=Object.assign,Jl;function us(e){if(Jl===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Jl=t&&t[1]||""}return`
`+Jl+e}var Zl=!1;function eo(e,t){if(!e||Zl)return"";Zl=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var s=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){s=u}e.call(t.prototype)}else{try{throw Error()}catch(u){s=u}e()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),l=s.stack.split(`
`),o=a.length-1,i=l.length-1;1<=o&&0<=i&&a[o]!==l[i];)i--;for(;1<=o&&0<=i;o--,i--)if(a[o]!==l[i]){if(o!==1||i!==1)do if(o--,i--,0>i||a[o]!==l[i]){var c=`
`+a[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=i);break}}}finally{Zl=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?us(e):""}function ax(e){switch(e.tag){case 5:return us(e.type);case 16:return us("Lazy");case 13:return us("Suspense");case 19:return us("SuspenseList");case 0:case 2:case 15:return e=eo(e.type,!1),e;case 11:return e=eo(e.type.render,!1),e;case 1:return e=eo(e.type,!0),e;default:return""}}function Mo(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case fr:return"Fragment";case mr:return"Portal";case Ao:return"Profiler";case Oi:return"StrictMode";case Lo:return"Suspense";case Io:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Rd:return(e.displayName||"Context")+".Consumer";case Fd:return(e._context.displayName||"Context")+".Provider";case zi:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ui:return t=e.displayName||null,t!==null?t:Mo(e.type)||"Memo";case jn:t=e._payload,e=e._init;try{return Mo(e(t))}catch{}}return null}function lx(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Mo(t);case 8:return t===Oi?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Pn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ld(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function ox(e){var t=Ld(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,l=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(o){s=""+o,l.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(o){s=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function da(e){e._valueTracker||(e._valueTracker=ox(e))}function Id(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),s="";return e&&(s=Ld(e)?e.checked?"true":"false":e.value),e=s,e!==n?(t.setValue(e),!0):!1}function Ya(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Po(e,t){var n=t.checked;return Ne({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Kc(e,t){var n=t.defaultValue==null?"":t.defaultValue,s=t.checked!=null?t.checked:t.defaultChecked;n=Pn(t.value!=null?t.value:n),e._wrapperState={initialChecked:s,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Md(e,t){t=t.checked,t!=null&&$i(e,"checked",t,!1)}function $o(e,t){Md(e,t);var n=Pn(t.value),s=t.type;if(n!=null)s==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Oo(e,t.type,n):t.hasOwnProperty("defaultValue")&&Oo(e,t.type,Pn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Qc(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!(s!=="submit"&&s!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Oo(e,t,n){(t!=="number"||Ya(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var ds=Array.isArray;function kr(e,t,n,s){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&s&&(e[n].defaultSelected=!0)}else{for(n=""+Pn(n),t=null,a=0;a<e.length;a++){if(e[a].value===n){e[a].selected=!0,s&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function zo(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(O(91));return Ne({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Gc(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(O(92));if(ds(n)){if(1<n.length)throw Error(O(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Pn(n)}}function Pd(e,t){var n=Pn(t.value),s=Pn(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),s!=null&&(e.defaultValue=""+s)}function Xc(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function $d(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Uo(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?$d(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ma,Od=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,s,a){MSApp.execUnsafeLocalFunction(function(){return e(t,n,s,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ma=ma||document.createElement("div"),ma.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ma.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Rs(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var hs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ix=["Webkit","ms","Moz","O"];Object.keys(hs).forEach(function(e){ix.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),hs[t]=hs[e]})});function zd(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||hs.hasOwnProperty(e)&&hs[e]?(""+t).trim():t+"px"}function Ud(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var s=n.indexOf("--")===0,a=zd(n,t[n],s);n==="float"&&(n="cssFloat"),s?e.setProperty(n,a):e[n]=a}}var cx=Ne({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Bo(e,t){if(t){if(cx[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(O(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(O(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(O(61))}if(t.style!=null&&typeof t.style!="object")throw Error(O(62))}}function Wo(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ho=null;function Bi(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Vo=null,Cr=null,_r=null;function qc(e){if(e=ta(e)){if(typeof Vo!="function")throw Error(O(280));var t=e.stateNode;t&&(t=Dl(t),Vo(e.stateNode,e.type,t))}}function Bd(e){Cr?_r?_r.push(e):_r=[e]:Cr=e}function Wd(){if(Cr){var e=Cr,t=_r;if(_r=Cr=null,qc(e),t)for(e=0;e<t.length;e++)qc(t[e])}}function Hd(e,t){return e(t)}function Vd(){}var to=!1;function Yd(e,t,n){if(to)return e(t,n);to=!0;try{return Hd(e,t,n)}finally{to=!1,(Cr!==null||_r!==null)&&(Vd(),Wd())}}function As(e,t){var n=e.stateNode;if(n===null)return null;var s=Dl(n);if(s===null)return null;n=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(O(231,t,typeof n));return n}var Yo=!1;if(mn)try{var ts={};Object.defineProperty(ts,"passive",{get:function(){Yo=!0}}),window.addEventListener("test",ts,ts),window.removeEventListener("test",ts,ts)}catch{Yo=!1}function ux(e,t,n,s,a,l,o,i,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(f){this.onError(f)}}var xs=!1,Ka=null,Qa=!1,Ko=null,dx={onError:function(e){xs=!0,Ka=e}};function mx(e,t,n,s,a,l,o,i,c){xs=!1,Ka=null,ux.apply(dx,arguments)}function fx(e,t,n,s,a,l,o,i,c){if(mx.apply(this,arguments),xs){if(xs){var u=Ka;xs=!1,Ka=null}else throw Error(O(198));Qa||(Qa=!0,Ko=u)}}function lr(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Kd(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Jc(e){if(lr(e)!==e)throw Error(O(188))}function hx(e){var t=e.alternate;if(!t){if(t=lr(e),t===null)throw Error(O(188));return t!==e?null:e}for(var n=e,s=t;;){var a=n.return;if(a===null)break;var l=a.alternate;if(l===null){if(s=a.return,s!==null){n=s;continue}break}if(a.child===l.child){for(l=a.child;l;){if(l===n)return Jc(a),e;if(l===s)return Jc(a),t;l=l.sibling}throw Error(O(188))}if(n.return!==s.return)n=a,s=l;else{for(var o=!1,i=a.child;i;){if(i===n){o=!0,n=a,s=l;break}if(i===s){o=!0,s=a,n=l;break}i=i.sibling}if(!o){for(i=l.child;i;){if(i===n){o=!0,n=l,s=a;break}if(i===s){o=!0,s=l,n=a;break}i=i.sibling}if(!o)throw Error(O(189))}}if(n.alternate!==s)throw Error(O(190))}if(n.tag!==3)throw Error(O(188));return n.stateNode.current===n?e:t}function Qd(e){return e=hx(e),e!==null?Gd(e):null}function Gd(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Gd(e);if(t!==null)return t;e=e.sibling}return null}var Xd=yt.unstable_scheduleCallback,Zc=yt.unstable_cancelCallback,xx=yt.unstable_shouldYield,px=yt.unstable_requestPaint,_e=yt.unstable_now,gx=yt.unstable_getCurrentPriorityLevel,Wi=yt.unstable_ImmediatePriority,qd=yt.unstable_UserBlockingPriority,Ga=yt.unstable_NormalPriority,yx=yt.unstable_LowPriority,Jd=yt.unstable_IdlePriority,kl=null,Xt=null;function vx(e){if(Xt&&typeof Xt.onCommitFiberRoot=="function")try{Xt.onCommitFiberRoot(kl,e,void 0,(e.current.flags&128)===128)}catch{}}var $t=Math.clz32?Math.clz32:jx,bx=Math.log,wx=Math.LN2;function jx(e){return e>>>=0,e===0?32:31-(bx(e)/wx|0)|0}var fa=64,ha=4194304;function ms(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Xa(e,t){var n=e.pendingLanes;if(n===0)return 0;var s=0,a=e.suspendedLanes,l=e.pingedLanes,o=n&268435455;if(o!==0){var i=o&~a;i!==0?s=ms(i):(l&=o,l!==0&&(s=ms(l)))}else o=n&~a,o!==0?s=ms(o):l!==0&&(s=ms(l));if(s===0)return 0;if(t!==0&&t!==s&&!(t&a)&&(a=s&-s,l=t&-t,a>=l||a===16&&(l&4194240)!==0))return t;if(s&4&&(s|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=s;0<t;)n=31-$t(t),a=1<<n,s|=e[n],t&=~a;return s}function Nx(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Sx(e,t){for(var n=e.suspendedLanes,s=e.pingedLanes,a=e.expirationTimes,l=e.pendingLanes;0<l;){var o=31-$t(l),i=1<<o,c=a[o];c===-1?(!(i&n)||i&s)&&(a[o]=Nx(i,t)):c<=t&&(e.expiredLanes|=i),l&=~i}}function Qo(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Zd(){var e=fa;return fa<<=1,!(fa&4194240)&&(fa=64),e}function no(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Zs(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-$t(t),e[t]=n}function kx(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-$t(n),l=1<<a;t[a]=0,s[a]=-1,e[a]=-1,n&=~l}}function Hi(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var s=31-$t(n),a=1<<s;a&t|e[s]&t&&(e[s]|=t),n&=~a}}var de=0;function em(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var tm,Vi,nm,rm,sm,Go=!1,xa=[],Dn=null,Tn=null,Fn=null,Ls=new Map,Is=new Map,kn=[],Cx="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function eu(e,t){switch(e){case"focusin":case"focusout":Dn=null;break;case"dragenter":case"dragleave":Tn=null;break;case"mouseover":case"mouseout":Fn=null;break;case"pointerover":case"pointerout":Ls.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Is.delete(t.pointerId)}}function ns(e,t,n,s,a,l){return e===null||e.nativeEvent!==l?(e={blockedOn:t,domEventName:n,eventSystemFlags:s,nativeEvent:l,targetContainers:[a]},t!==null&&(t=ta(t),t!==null&&Vi(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function _x(e,t,n,s,a){switch(t){case"focusin":return Dn=ns(Dn,e,t,n,s,a),!0;case"dragenter":return Tn=ns(Tn,e,t,n,s,a),!0;case"mouseover":return Fn=ns(Fn,e,t,n,s,a),!0;case"pointerover":var l=a.pointerId;return Ls.set(l,ns(Ls.get(l)||null,e,t,n,s,a)),!0;case"gotpointercapture":return l=a.pointerId,Is.set(l,ns(Is.get(l)||null,e,t,n,s,a)),!0}return!1}function am(e){var t=Kn(e.target);if(t!==null){var n=lr(t);if(n!==null){if(t=n.tag,t===13){if(t=Kd(n),t!==null){e.blockedOn=t,sm(e.priority,function(){nm(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Fa(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Xo(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var s=new n.constructor(n.type,n);Ho=s,n.target.dispatchEvent(s),Ho=null}else return t=ta(n),t!==null&&Vi(t),e.blockedOn=n,!1;t.shift()}return!0}function tu(e,t,n){Fa(e)&&n.delete(t)}function Ex(){Go=!1,Dn!==null&&Fa(Dn)&&(Dn=null),Tn!==null&&Fa(Tn)&&(Tn=null),Fn!==null&&Fa(Fn)&&(Fn=null),Ls.forEach(tu),Is.forEach(tu)}function rs(e,t){e.blockedOn===t&&(e.blockedOn=null,Go||(Go=!0,yt.unstable_scheduleCallback(yt.unstable_NormalPriority,Ex)))}function Ms(e){function t(a){return rs(a,e)}if(0<xa.length){rs(xa[0],e);for(var n=1;n<xa.length;n++){var s=xa[n];s.blockedOn===e&&(s.blockedOn=null)}}for(Dn!==null&&rs(Dn,e),Tn!==null&&rs(Tn,e),Fn!==null&&rs(Fn,e),Ls.forEach(t),Is.forEach(t),n=0;n<kn.length;n++)s=kn[n],s.blockedOn===e&&(s.blockedOn=null);for(;0<kn.length&&(n=kn[0],n.blockedOn===null);)am(n),n.blockedOn===null&&kn.shift()}var Er=pn.ReactCurrentBatchConfig,qa=!0;function Dx(e,t,n,s){var a=de,l=Er.transition;Er.transition=null;try{de=1,Yi(e,t,n,s)}finally{de=a,Er.transition=l}}function Tx(e,t,n,s){var a=de,l=Er.transition;Er.transition=null;try{de=4,Yi(e,t,n,s)}finally{de=a,Er.transition=l}}function Yi(e,t,n,s){if(qa){var a=Xo(e,t,n,s);if(a===null)fo(e,t,s,Ja,n),eu(e,s);else if(_x(a,e,t,n,s))s.stopPropagation();else if(eu(e,s),t&4&&-1<Cx.indexOf(e)){for(;a!==null;){var l=ta(a);if(l!==null&&tm(l),l=Xo(e,t,n,s),l===null&&fo(e,t,s,Ja,n),l===a)break;a=l}a!==null&&s.stopPropagation()}else fo(e,t,s,null,n)}}var Ja=null;function Xo(e,t,n,s){if(Ja=null,e=Bi(s),e=Kn(e),e!==null)if(t=lr(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Kd(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ja=e,null}function lm(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(gx()){case Wi:return 1;case qd:return 4;case Ga:case yx:return 16;case Jd:return 536870912;default:return 16}default:return 16}}var _n=null,Ki=null,Ra=null;function om(){if(Ra)return Ra;var e,t=Ki,n=t.length,s,a="value"in _n?_n.value:_n.textContent,l=a.length;for(e=0;e<n&&t[e]===a[e];e++);var o=n-e;for(s=1;s<=o&&t[n-s]===a[l-s];s++);return Ra=a.slice(e,1<s?1-s:void 0)}function Aa(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function pa(){return!0}function nu(){return!1}function bt(e){function t(n,s,a,l,o){this._reactName=n,this._targetInst=a,this.type=s,this.nativeEvent=l,this.target=o,this.currentTarget=null;for(var i in e)e.hasOwnProperty(i)&&(n=e[i],this[i]=n?n(l):l[i]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?pa:nu,this.isPropagationStopped=nu,this}return Ne(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=pa)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=pa)},persist:function(){},isPersistent:pa}),t}var Hr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Qi=bt(Hr),ea=Ne({},Hr,{view:0,detail:0}),Fx=bt(ea),ro,so,ss,Cl=Ne({},ea,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Gi,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ss&&(ss&&e.type==="mousemove"?(ro=e.screenX-ss.screenX,so=e.screenY-ss.screenY):so=ro=0,ss=e),ro)},movementY:function(e){return"movementY"in e?e.movementY:so}}),ru=bt(Cl),Rx=Ne({},Cl,{dataTransfer:0}),Ax=bt(Rx),Lx=Ne({},ea,{relatedTarget:0}),ao=bt(Lx),Ix=Ne({},Hr,{animationName:0,elapsedTime:0,pseudoElement:0}),Mx=bt(Ix),Px=Ne({},Hr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),$x=bt(Px),Ox=Ne({},Hr,{data:0}),su=bt(Ox),zx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ux={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Bx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Wx(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Bx[e])?!!t[e]:!1}function Gi(){return Wx}var Hx=Ne({},ea,{key:function(e){if(e.key){var t=zx[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Aa(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Ux[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Gi,charCode:function(e){return e.type==="keypress"?Aa(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Aa(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Vx=bt(Hx),Yx=Ne({},Cl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),au=bt(Yx),Kx=Ne({},ea,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Gi}),Qx=bt(Kx),Gx=Ne({},Hr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xx=bt(Gx),qx=Ne({},Cl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Jx=bt(qx),Zx=[9,13,27,32],Xi=mn&&"CompositionEvent"in window,ps=null;mn&&"documentMode"in document&&(ps=document.documentMode);var ep=mn&&"TextEvent"in window&&!ps,im=mn&&(!Xi||ps&&8<ps&&11>=ps),lu=" ",ou=!1;function cm(e,t){switch(e){case"keyup":return Zx.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function um(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var hr=!1;function tp(e,t){switch(e){case"compositionend":return um(t);case"keypress":return t.which!==32?null:(ou=!0,lu);case"textInput":return e=t.data,e===lu&&ou?null:e;default:return null}}function np(e,t){if(hr)return e==="compositionend"||!Xi&&cm(e,t)?(e=om(),Ra=Ki=_n=null,hr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return im&&t.locale!=="ko"?null:t.data;default:return null}}var rp={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function iu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!rp[e.type]:t==="textarea"}function dm(e,t,n,s){Bd(s),t=Za(t,"onChange"),0<t.length&&(n=new Qi("onChange","change",null,n,s),e.push({event:n,listeners:t}))}var gs=null,Ps=null;function sp(e){jm(e,0)}function _l(e){var t=gr(e);if(Id(t))return e}function ap(e,t){if(e==="change")return t}var mm=!1;if(mn){var lo;if(mn){var oo="oninput"in document;if(!oo){var cu=document.createElement("div");cu.setAttribute("oninput","return;"),oo=typeof cu.oninput=="function"}lo=oo}else lo=!1;mm=lo&&(!document.documentMode||9<document.documentMode)}function uu(){gs&&(gs.detachEvent("onpropertychange",fm),Ps=gs=null)}function fm(e){if(e.propertyName==="value"&&_l(Ps)){var t=[];dm(t,Ps,e,Bi(e)),Yd(sp,t)}}function lp(e,t,n){e==="focusin"?(uu(),gs=t,Ps=n,gs.attachEvent("onpropertychange",fm)):e==="focusout"&&uu()}function op(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return _l(Ps)}function ip(e,t){if(e==="click")return _l(t)}function cp(e,t){if(e==="input"||e==="change")return _l(t)}function up(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var zt=typeof Object.is=="function"?Object.is:up;function $s(e,t){if(zt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var a=n[s];if(!Ro.call(t,a)||!zt(e[a],t[a]))return!1}return!0}function du(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function mu(e,t){var n=du(e);e=0;for(var s;n;){if(n.nodeType===3){if(s=e+n.textContent.length,e<=t&&s>=t)return{node:n,offset:t-e};e=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=du(n)}}function hm(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?hm(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function xm(){for(var e=window,t=Ya();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Ya(e.document)}return t}function qi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function dp(e){var t=xm(),n=e.focusedElem,s=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hm(n.ownerDocument.documentElement,n)){if(s!==null&&qi(n)){if(t=s.start,e=s.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=n.textContent.length,l=Math.min(s.start,a);s=s.end===void 0?l:Math.min(s.end,a),!e.extend&&l>s&&(a=s,s=l,l=a),a=mu(n,l);var o=mu(n,s);a&&o&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),l>s?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mp=mn&&"documentMode"in document&&11>=document.documentMode,xr=null,qo=null,ys=null,Jo=!1;function fu(e,t,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Jo||xr==null||xr!==Ya(s)||(s=xr,"selectionStart"in s&&qi(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),ys&&$s(ys,s)||(ys=s,s=Za(qo,"onSelect"),0<s.length&&(t=new Qi("onSelect","select",null,t,n),e.push({event:t,listeners:s}),t.target=xr)))}function ga(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var pr={animationend:ga("Animation","AnimationEnd"),animationiteration:ga("Animation","AnimationIteration"),animationstart:ga("Animation","AnimationStart"),transitionend:ga("Transition","TransitionEnd")},io={},pm={};mn&&(pm=document.createElement("div").style,"AnimationEvent"in window||(delete pr.animationend.animation,delete pr.animationiteration.animation,delete pr.animationstart.animation),"TransitionEvent"in window||delete pr.transitionend.transition);function El(e){if(io[e])return io[e];if(!pr[e])return e;var t=pr[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in pm)return io[e]=t[n];return e}var gm=El("animationend"),ym=El("animationiteration"),vm=El("animationstart"),bm=El("transitionend"),wm=new Map,hu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Bn(e,t){wm.set(e,t),ar(t,[e])}for(var co=0;co<hu.length;co++){var uo=hu[co],fp=uo.toLowerCase(),hp=uo[0].toUpperCase()+uo.slice(1);Bn(fp,"on"+hp)}Bn(gm,"onAnimationEnd");Bn(ym,"onAnimationIteration");Bn(vm,"onAnimationStart");Bn("dblclick","onDoubleClick");Bn("focusin","onFocus");Bn("focusout","onBlur");Bn(bm,"onTransitionEnd");Lr("onMouseEnter",["mouseout","mouseover"]);Lr("onMouseLeave",["mouseout","mouseover"]);Lr("onPointerEnter",["pointerout","pointerover"]);Lr("onPointerLeave",["pointerout","pointerover"]);ar("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ar("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ar("onBeforeInput",["compositionend","keypress","textInput","paste"]);ar("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ar("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ar("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),xp=new Set("cancel close invalid load scroll toggle".split(" ").concat(fs));function xu(e,t,n){var s=e.type||"unknown-event";e.currentTarget=n,fx(s,t,void 0,e),e.currentTarget=null}function jm(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var s=e[n],a=s.event;s=s.listeners;e:{var l=void 0;if(t)for(var o=s.length-1;0<=o;o--){var i=s[o],c=i.instance,u=i.currentTarget;if(i=i.listener,c!==l&&a.isPropagationStopped())break e;xu(a,i,u),l=c}else for(o=0;o<s.length;o++){if(i=s[o],c=i.instance,u=i.currentTarget,i=i.listener,c!==l&&a.isPropagationStopped())break e;xu(a,i,u),l=c}}}if(Qa)throw e=Ko,Qa=!1,Ko=null,e}function xe(e,t){var n=t[ri];n===void 0&&(n=t[ri]=new Set);var s=e+"__bubble";n.has(s)||(Nm(t,e,2,!1),n.add(s))}function mo(e,t,n){var s=0;t&&(s|=4),Nm(n,e,s,t)}var ya="_reactListening"+Math.random().toString(36).slice(2);function Os(e){if(!e[ya]){e[ya]=!0,Td.forEach(function(n){n!=="selectionchange"&&(xp.has(n)||mo(n,!1,e),mo(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ya]||(t[ya]=!0,mo("selectionchange",!1,t))}}function Nm(e,t,n,s){switch(lm(t)){case 1:var a=Dx;break;case 4:a=Tx;break;default:a=Yi}n=a.bind(null,t,n,e),a=void 0,!Yo||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),s?a!==void 0?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):a!==void 0?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function fo(e,t,n,s,a){var l=s;if(!(t&1)&&!(t&2)&&s!==null)e:for(;;){if(s===null)return;var o=s.tag;if(o===3||o===4){var i=s.stateNode.containerInfo;if(i===a||i.nodeType===8&&i.parentNode===a)break;if(o===4)for(o=s.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;o=o.return}for(;i!==null;){if(o=Kn(i),o===null)return;if(c=o.tag,c===5||c===6){s=l=o;continue e}i=i.parentNode}}s=s.return}Yd(function(){var u=l,f=Bi(n),d=[];e:{var y=wm.get(e);if(y!==void 0){var g=Qi,b=e;switch(e){case"keypress":if(Aa(n)===0)break e;case"keydown":case"keyup":g=Vx;break;case"focusin":b="focus",g=ao;break;case"focusout":b="blur",g=ao;break;case"beforeblur":case"afterblur":g=ao;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=ru;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=Ax;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=Qx;break;case gm:case ym:case vm:g=Mx;break;case bm:g=Xx;break;case"scroll":g=Fx;break;case"wheel":g=Jx;break;case"copy":case"cut":case"paste":g=$x;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=au}var v=(t&4)!==0,S=!v&&e==="scroll",x=v?y!==null?y+"Capture":null:y;v=[];for(var h=u,m;h!==null;){m=h;var k=m.stateNode;if(m.tag===5&&k!==null&&(m=k,x!==null&&(k=As(h,x),k!=null&&v.push(zs(h,k,m)))),S)break;h=h.return}0<v.length&&(y=new g(y,b,null,n,f),d.push({event:y,listeners:v}))}}if(!(t&7)){e:{if(y=e==="mouseover"||e==="pointerover",g=e==="mouseout"||e==="pointerout",y&&n!==Ho&&(b=n.relatedTarget||n.fromElement)&&(Kn(b)||b[fn]))break e;if((g||y)&&(y=f.window===f?f:(y=f.ownerDocument)?y.defaultView||y.parentWindow:window,g?(b=n.relatedTarget||n.toElement,g=u,b=b?Kn(b):null,b!==null&&(S=lr(b),b!==S||b.tag!==5&&b.tag!==6)&&(b=null)):(g=null,b=u),g!==b)){if(v=ru,k="onMouseLeave",x="onMouseEnter",h="mouse",(e==="pointerout"||e==="pointerover")&&(v=au,k="onPointerLeave",x="onPointerEnter",h="pointer"),S=g==null?y:gr(g),m=b==null?y:gr(b),y=new v(k,h+"leave",g,n,f),y.target=S,y.relatedTarget=m,k=null,Kn(f)===u&&(v=new v(x,h+"enter",b,n,f),v.target=m,v.relatedTarget=S,k=v),S=k,g&&b)t:{for(v=g,x=b,h=0,m=v;m;m=dr(m))h++;for(m=0,k=x;k;k=dr(k))m++;for(;0<h-m;)v=dr(v),h--;for(;0<m-h;)x=dr(x),m--;for(;h--;){if(v===x||x!==null&&v===x.alternate)break t;v=dr(v),x=dr(x)}v=null}else v=null;g!==null&&pu(d,y,g,v,!1),b!==null&&S!==null&&pu(d,S,b,v,!0)}}e:{if(y=u?gr(u):window,g=y.nodeName&&y.nodeName.toLowerCase(),g==="select"||g==="input"&&y.type==="file")var j=ap;else if(iu(y))if(mm)j=cp;else{j=op;var N=lp}else(g=y.nodeName)&&g.toLowerCase()==="input"&&(y.type==="checkbox"||y.type==="radio")&&(j=ip);if(j&&(j=j(e,u))){dm(d,j,n,f);break e}N&&N(e,y,u),e==="focusout"&&(N=y._wrapperState)&&N.controlled&&y.type==="number"&&Oo(y,"number",y.value)}switch(N=u?gr(u):window,e){case"focusin":(iu(N)||N.contentEditable==="true")&&(xr=N,qo=u,ys=null);break;case"focusout":ys=qo=xr=null;break;case"mousedown":Jo=!0;break;case"contextmenu":case"mouseup":case"dragend":Jo=!1,fu(d,n,f);break;case"selectionchange":if(mp)break;case"keydown":case"keyup":fu(d,n,f)}var w;if(Xi)e:{switch(e){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else hr?cm(e,n)&&(C="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(C="onCompositionStart");C&&(im&&n.locale!=="ko"&&(hr||C!=="onCompositionStart"?C==="onCompositionEnd"&&hr&&(w=om()):(_n=f,Ki="value"in _n?_n.value:_n.textContent,hr=!0)),N=Za(u,C),0<N.length&&(C=new su(C,e,null,n,f),d.push({event:C,listeners:N}),w?C.data=w:(w=um(n),w!==null&&(C.data=w)))),(w=ep?tp(e,n):np(e,n))&&(u=Za(u,"onBeforeInput"),0<u.length&&(f=new su("onBeforeInput","beforeinput",null,n,f),d.push({event:f,listeners:u}),f.data=w))}jm(d,t)})}function zs(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Za(e,t){for(var n=t+"Capture",s=[];e!==null;){var a=e,l=a.stateNode;a.tag===5&&l!==null&&(a=l,l=As(e,n),l!=null&&s.unshift(zs(e,l,a)),l=As(e,t),l!=null&&s.push(zs(e,l,a))),e=e.return}return s}function dr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function pu(e,t,n,s,a){for(var l=t._reactName,o=[];n!==null&&n!==s;){var i=n,c=i.alternate,u=i.stateNode;if(c!==null&&c===s)break;i.tag===5&&u!==null&&(i=u,a?(c=As(n,l),c!=null&&o.unshift(zs(n,c,i))):a||(c=As(n,l),c!=null&&o.push(zs(n,c,i)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var pp=/\r\n?/g,gp=/\u0000|\uFFFD/g;function gu(e){return(typeof e=="string"?e:""+e).replace(pp,`
`).replace(gp,"")}function va(e,t,n){if(t=gu(t),gu(e)!==t&&n)throw Error(O(425))}function el(){}var Zo=null,ei=null;function ti(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var ni=typeof setTimeout=="function"?setTimeout:void 0,yp=typeof clearTimeout=="function"?clearTimeout:void 0,yu=typeof Promise=="function"?Promise:void 0,vp=typeof queueMicrotask=="function"?queueMicrotask:typeof yu<"u"?function(e){return yu.resolve(null).then(e).catch(bp)}:ni;function bp(e){setTimeout(function(){throw e})}function ho(e,t){var n=t,s=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(s===0){e.removeChild(a),Ms(t);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=a}while(n);Ms(t)}function Rn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function vu(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Vr=Math.random().toString(36).slice(2),Qt="__reactFiber$"+Vr,Us="__reactProps$"+Vr,fn="__reactContainer$"+Vr,ri="__reactEvents$"+Vr,wp="__reactListeners$"+Vr,jp="__reactHandles$"+Vr;function Kn(e){var t=e[Qt];if(t)return t;for(var n=e.parentNode;n;){if(t=n[fn]||n[Qt]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=vu(e);e!==null;){if(n=e[Qt])return n;e=vu(e)}return t}e=n,n=e.parentNode}return null}function ta(e){return e=e[Qt]||e[fn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function gr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(O(33))}function Dl(e){return e[Us]||null}var si=[],yr=-1;function Wn(e){return{current:e}}function pe(e){0>yr||(e.current=si[yr],si[yr]=null,yr--)}function he(e,t){yr++,si[yr]=e.current,e.current=t}var $n={},Ke=Wn($n),at=Wn(!1),Zn=$n;function Ir(e,t){var n=e.type.contextTypes;if(!n)return $n;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var a={},l;for(l in n)a[l]=t[l];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function lt(e){return e=e.childContextTypes,e!=null}function tl(){pe(at),pe(Ke)}function bu(e,t,n){if(Ke.current!==$n)throw Error(O(168));he(Ke,t),he(at,n)}function Sm(e,t,n){var s=e.stateNode;if(t=t.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var a in s)if(!(a in t))throw Error(O(108,lx(e)||"Unknown",a));return Ne({},n,s)}function nl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||$n,Zn=Ke.current,he(Ke,e),he(at,at.current),!0}function wu(e,t,n){var s=e.stateNode;if(!s)throw Error(O(169));n?(e=Sm(e,t,Zn),s.__reactInternalMemoizedMergedChildContext=e,pe(at),pe(Ke),he(Ke,e)):pe(at),he(at,n)}var rn=null,Tl=!1,xo=!1;function km(e){rn===null?rn=[e]:rn.push(e)}function Np(e){Tl=!0,km(e)}function Hn(){if(!xo&&rn!==null){xo=!0;var e=0,t=de;try{var n=rn;for(de=1;e<n.length;e++){var s=n[e];do s=s(!0);while(s!==null)}rn=null,Tl=!1}catch(a){throw rn!==null&&(rn=rn.slice(e+1)),Xd(Wi,Hn),a}finally{de=t,xo=!1}}return null}var vr=[],br=0,rl=null,sl=0,St=[],kt=0,er=null,an=1,ln="";function Vn(e,t){vr[br++]=sl,vr[br++]=rl,rl=e,sl=t}function Cm(e,t,n){St[kt++]=an,St[kt++]=ln,St[kt++]=er,er=e;var s=an;e=ln;var a=32-$t(s)-1;s&=~(1<<a),n+=1;var l=32-$t(t)+a;if(30<l){var o=a-a%5;l=(s&(1<<o)-1).toString(32),s>>=o,a-=o,an=1<<32-$t(t)+a|n<<a|s,ln=l+e}else an=1<<l|n<<a|s,ln=e}function Ji(e){e.return!==null&&(Vn(e,1),Cm(e,1,0))}function Zi(e){for(;e===rl;)rl=vr[--br],vr[br]=null,sl=vr[--br],vr[br]=null;for(;e===er;)er=St[--kt],St[kt]=null,ln=St[--kt],St[kt]=null,an=St[--kt],St[kt]=null}var gt=null,pt=null,ge=!1,Mt=null;function _m(e,t){var n=Et(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function ju(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,gt=e,pt=Rn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,gt=e,pt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=er!==null?{id:an,overflow:ln}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Et(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,gt=e,pt=null,!0):!1;default:return!1}}function ai(e){return(e.mode&1)!==0&&(e.flags&128)===0}function li(e){if(ge){var t=pt;if(t){var n=t;if(!ju(e,t)){if(ai(e))throw Error(O(418));t=Rn(n.nextSibling);var s=gt;t&&ju(e,t)?_m(s,n):(e.flags=e.flags&-4097|2,ge=!1,gt=e)}}else{if(ai(e))throw Error(O(418));e.flags=e.flags&-4097|2,ge=!1,gt=e}}}function Nu(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;gt=e}function ba(e){if(e!==gt)return!1;if(!ge)return Nu(e),ge=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!ti(e.type,e.memoizedProps)),t&&(t=pt)){if(ai(e))throw Em(),Error(O(418));for(;t;)_m(e,t),t=Rn(t.nextSibling)}if(Nu(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(O(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){pt=Rn(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}pt=null}}else pt=gt?Rn(e.stateNode.nextSibling):null;return!0}function Em(){for(var e=pt;e;)e=Rn(e.nextSibling)}function Mr(){pt=gt=null,ge=!1}function ec(e){Mt===null?Mt=[e]:Mt.push(e)}var Sp=pn.ReactCurrentBatchConfig;function as(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(O(309));var s=n.stateNode}if(!s)throw Error(O(147,e));var a=s,l=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===l?t.ref:(t=function(o){var i=a.refs;o===null?delete i[l]:i[l]=o},t._stringRef=l,t)}if(typeof e!="string")throw Error(O(284));if(!n._owner)throw Error(O(290,e))}return e}function wa(e,t){throw e=Object.prototype.toString.call(t),Error(O(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Su(e){var t=e._init;return t(e._payload)}function Dm(e){function t(x,h){if(e){var m=x.deletions;m===null?(x.deletions=[h],x.flags|=16):m.push(h)}}function n(x,h){if(!e)return null;for(;h!==null;)t(x,h),h=h.sibling;return null}function s(x,h){for(x=new Map;h!==null;)h.key!==null?x.set(h.key,h):x.set(h.index,h),h=h.sibling;return x}function a(x,h){return x=Mn(x,h),x.index=0,x.sibling=null,x}function l(x,h,m){return x.index=m,e?(m=x.alternate,m!==null?(m=m.index,m<h?(x.flags|=2,h):m):(x.flags|=2,h)):(x.flags|=1048576,h)}function o(x){return e&&x.alternate===null&&(x.flags|=2),x}function i(x,h,m,k){return h===null||h.tag!==6?(h=jo(m,x.mode,k),h.return=x,h):(h=a(h,m),h.return=x,h)}function c(x,h,m,k){var j=m.type;return j===fr?f(x,h,m.props.children,k,m.key):h!==null&&(h.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===jn&&Su(j)===h.type)?(k=a(h,m.props),k.ref=as(x,h,m),k.return=x,k):(k=za(m.type,m.key,m.props,null,x.mode,k),k.ref=as(x,h,m),k.return=x,k)}function u(x,h,m,k){return h===null||h.tag!==4||h.stateNode.containerInfo!==m.containerInfo||h.stateNode.implementation!==m.implementation?(h=No(m,x.mode,k),h.return=x,h):(h=a(h,m.children||[]),h.return=x,h)}function f(x,h,m,k,j){return h===null||h.tag!==7?(h=qn(m,x.mode,k,j),h.return=x,h):(h=a(h,m),h.return=x,h)}function d(x,h,m){if(typeof h=="string"&&h!==""||typeof h=="number")return h=jo(""+h,x.mode,m),h.return=x,h;if(typeof h=="object"&&h!==null){switch(h.$$typeof){case ua:return m=za(h.type,h.key,h.props,null,x.mode,m),m.ref=as(x,null,h),m.return=x,m;case mr:return h=No(h,x.mode,m),h.return=x,h;case jn:var k=h._init;return d(x,k(h._payload),m)}if(ds(h)||es(h))return h=qn(h,x.mode,m,null),h.return=x,h;wa(x,h)}return null}function y(x,h,m,k){var j=h!==null?h.key:null;if(typeof m=="string"&&m!==""||typeof m=="number")return j!==null?null:i(x,h,""+m,k);if(typeof m=="object"&&m!==null){switch(m.$$typeof){case ua:return m.key===j?c(x,h,m,k):null;case mr:return m.key===j?u(x,h,m,k):null;case jn:return j=m._init,y(x,h,j(m._payload),k)}if(ds(m)||es(m))return j!==null?null:f(x,h,m,k,null);wa(x,m)}return null}function g(x,h,m,k,j){if(typeof k=="string"&&k!==""||typeof k=="number")return x=x.get(m)||null,i(h,x,""+k,j);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case ua:return x=x.get(k.key===null?m:k.key)||null,c(h,x,k,j);case mr:return x=x.get(k.key===null?m:k.key)||null,u(h,x,k,j);case jn:var N=k._init;return g(x,h,m,N(k._payload),j)}if(ds(k)||es(k))return x=x.get(m)||null,f(h,x,k,j,null);wa(h,k)}return null}function b(x,h,m,k){for(var j=null,N=null,w=h,C=h=0,_=null;w!==null&&C<m.length;C++){w.index>C?(_=w,w=null):_=w.sibling;var E=y(x,w,m[C],k);if(E===null){w===null&&(w=_);break}e&&w&&E.alternate===null&&t(x,w),h=l(E,h,C),N===null?j=E:N.sibling=E,N=E,w=_}if(C===m.length)return n(x,w),ge&&Vn(x,C),j;if(w===null){for(;C<m.length;C++)w=d(x,m[C],k),w!==null&&(h=l(w,h,C),N===null?j=w:N.sibling=w,N=w);return ge&&Vn(x,C),j}for(w=s(x,w);C<m.length;C++)_=g(w,x,C,m[C],k),_!==null&&(e&&_.alternate!==null&&w.delete(_.key===null?C:_.key),h=l(_,h,C),N===null?j=_:N.sibling=_,N=_);return e&&w.forEach(function(T){return t(x,T)}),ge&&Vn(x,C),j}function v(x,h,m,k){var j=es(m);if(typeof j!="function")throw Error(O(150));if(m=j.call(m),m==null)throw Error(O(151));for(var N=j=null,w=h,C=h=0,_=null,E=m.next();w!==null&&!E.done;C++,E=m.next()){w.index>C?(_=w,w=null):_=w.sibling;var T=y(x,w,E.value,k);if(T===null){w===null&&(w=_);break}e&&w&&T.alternate===null&&t(x,w),h=l(T,h,C),N===null?j=T:N.sibling=T,N=T,w=_}if(E.done)return n(x,w),ge&&Vn(x,C),j;if(w===null){for(;!E.done;C++,E=m.next())E=d(x,E.value,k),E!==null&&(h=l(E,h,C),N===null?j=E:N.sibling=E,N=E);return ge&&Vn(x,C),j}for(w=s(x,w);!E.done;C++,E=m.next())E=g(w,x,C,E.value,k),E!==null&&(e&&E.alternate!==null&&w.delete(E.key===null?C:E.key),h=l(E,h,C),N===null?j=E:N.sibling=E,N=E);return e&&w.forEach(function(L){return t(x,L)}),ge&&Vn(x,C),j}function S(x,h,m,k){if(typeof m=="object"&&m!==null&&m.type===fr&&m.key===null&&(m=m.props.children),typeof m=="object"&&m!==null){switch(m.$$typeof){case ua:e:{for(var j=m.key,N=h;N!==null;){if(N.key===j){if(j=m.type,j===fr){if(N.tag===7){n(x,N.sibling),h=a(N,m.props.children),h.return=x,x=h;break e}}else if(N.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===jn&&Su(j)===N.type){n(x,N.sibling),h=a(N,m.props),h.ref=as(x,N,m),h.return=x,x=h;break e}n(x,N);break}else t(x,N);N=N.sibling}m.type===fr?(h=qn(m.props.children,x.mode,k,m.key),h.return=x,x=h):(k=za(m.type,m.key,m.props,null,x.mode,k),k.ref=as(x,h,m),k.return=x,x=k)}return o(x);case mr:e:{for(N=m.key;h!==null;){if(h.key===N)if(h.tag===4&&h.stateNode.containerInfo===m.containerInfo&&h.stateNode.implementation===m.implementation){n(x,h.sibling),h=a(h,m.children||[]),h.return=x,x=h;break e}else{n(x,h);break}else t(x,h);h=h.sibling}h=No(m,x.mode,k),h.return=x,x=h}return o(x);case jn:return N=m._init,S(x,h,N(m._payload),k)}if(ds(m))return b(x,h,m,k);if(es(m))return v(x,h,m,k);wa(x,m)}return typeof m=="string"&&m!==""||typeof m=="number"?(m=""+m,h!==null&&h.tag===6?(n(x,h.sibling),h=a(h,m),h.return=x,x=h):(n(x,h),h=jo(m,x.mode,k),h.return=x,x=h),o(x)):n(x,h)}return S}var Pr=Dm(!0),Tm=Dm(!1),al=Wn(null),ll=null,wr=null,tc=null;function nc(){tc=wr=ll=null}function rc(e){var t=al.current;pe(al),e._currentValue=t}function oi(e,t,n){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===n)break;e=e.return}}function Dr(e,t){ll=e,tc=wr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(st=!0),e.firstContext=null)}function Tt(e){var t=e._currentValue;if(tc!==e)if(e={context:e,memoizedValue:t,next:null},wr===null){if(ll===null)throw Error(O(308));wr=e,ll.dependencies={lanes:0,firstContext:e}}else wr=wr.next=e;return t}var Qn=null;function sc(e){Qn===null?Qn=[e]:Qn.push(e)}function Fm(e,t,n,s){var a=t.interleaved;return a===null?(n.next=n,sc(t)):(n.next=a.next,a.next=n),t.interleaved=n,hn(e,s)}function hn(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Nn=!1;function ac(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Rm(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function on(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function An(e,t,n){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,oe&2){var a=s.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),s.pending=t,hn(e,n)}return a=s.interleaved,a===null?(t.next=t,sc(s)):(t.next=a.next,a.next=t),s.interleaved=t,hn(e,n)}function La(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,Hi(e,n)}}function ku(e,t){var n=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var a=null,l=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};l===null?a=l=o:l=l.next=o,n=n.next}while(n!==null);l===null?a=l=t:l=l.next=t}else a=l=t;n={baseState:s.baseState,firstBaseUpdate:a,lastBaseUpdate:l,shared:s.shared,effects:s.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function ol(e,t,n,s){var a=e.updateQueue;Nn=!1;var l=a.firstBaseUpdate,o=a.lastBaseUpdate,i=a.shared.pending;if(i!==null){a.shared.pending=null;var c=i,u=c.next;c.next=null,o===null?l=u:o.next=u,o=c;var f=e.alternate;f!==null&&(f=f.updateQueue,i=f.lastBaseUpdate,i!==o&&(i===null?f.firstBaseUpdate=u:i.next=u,f.lastBaseUpdate=c))}if(l!==null){var d=a.baseState;o=0,f=u=c=null,i=l;do{var y=i.lane,g=i.eventTime;if((s&y)===y){f!==null&&(f=f.next={eventTime:g,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var b=e,v=i;switch(y=t,g=n,v.tag){case 1:if(b=v.payload,typeof b=="function"){d=b.call(g,d,y);break e}d=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=v.payload,y=typeof b=="function"?b.call(g,d,y):b,y==null)break e;d=Ne({},d,y);break e;case 2:Nn=!0}}i.callback!==null&&i.lane!==0&&(e.flags|=64,y=a.effects,y===null?a.effects=[i]:y.push(i))}else g={eventTime:g,lane:y,tag:i.tag,payload:i.payload,callback:i.callback,next:null},f===null?(u=f=g,c=d):f=f.next=g,o|=y;if(i=i.next,i===null){if(i=a.shared.pending,i===null)break;y=i,i=y.next,y.next=null,a.lastBaseUpdate=y,a.shared.pending=null}}while(!0);if(f===null&&(c=d),a.baseState=c,a.firstBaseUpdate=u,a.lastBaseUpdate=f,t=a.shared.interleaved,t!==null){a=t;do o|=a.lane,a=a.next;while(a!==t)}else l===null&&(a.shared.lanes=0);nr|=o,e.lanes=o,e.memoizedState=d}}function Cu(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var s=e[t],a=s.callback;if(a!==null){if(s.callback=null,s=n,typeof a!="function")throw Error(O(191,a));a.call(s)}}}var na={},qt=Wn(na),Bs=Wn(na),Ws=Wn(na);function Gn(e){if(e===na)throw Error(O(174));return e}function lc(e,t){switch(he(Ws,t),he(Bs,e),he(qt,na),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Uo(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Uo(t,e)}pe(qt),he(qt,t)}function $r(){pe(qt),pe(Bs),pe(Ws)}function Am(e){Gn(Ws.current);var t=Gn(qt.current),n=Uo(t,e.type);t!==n&&(he(Bs,e),he(qt,n))}function oc(e){Bs.current===e&&(pe(qt),pe(Bs))}var be=Wn(0);function il(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var po=[];function ic(){for(var e=0;e<po.length;e++)po[e]._workInProgressVersionPrimary=null;po.length=0}var Ia=pn.ReactCurrentDispatcher,go=pn.ReactCurrentBatchConfig,tr=0,je=null,Re=null,Ie=null,cl=!1,vs=!1,Hs=0,kp=0;function He(){throw Error(O(321))}function cc(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!zt(e[n],t[n]))return!1;return!0}function uc(e,t,n,s,a,l){if(tr=l,je=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ia.current=e===null||e.memoizedState===null?Dp:Tp,e=n(s,a),vs){l=0;do{if(vs=!1,Hs=0,25<=l)throw Error(O(301));l+=1,Ie=Re=null,t.updateQueue=null,Ia.current=Fp,e=n(s,a)}while(vs)}if(Ia.current=ul,t=Re!==null&&Re.next!==null,tr=0,Ie=Re=je=null,cl=!1,t)throw Error(O(300));return e}function dc(){var e=Hs!==0;return Hs=0,e}function Kt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ie===null?je.memoizedState=Ie=e:Ie=Ie.next=e,Ie}function Ft(){if(Re===null){var e=je.alternate;e=e!==null?e.memoizedState:null}else e=Re.next;var t=Ie===null?je.memoizedState:Ie.next;if(t!==null)Ie=t,Re=e;else{if(e===null)throw Error(O(310));Re=e,e={memoizedState:Re.memoizedState,baseState:Re.baseState,baseQueue:Re.baseQueue,queue:Re.queue,next:null},Ie===null?je.memoizedState=Ie=e:Ie=Ie.next=e}return Ie}function Vs(e,t){return typeof t=="function"?t(e):t}function yo(e){var t=Ft(),n=t.queue;if(n===null)throw Error(O(311));n.lastRenderedReducer=e;var s=Re,a=s.baseQueue,l=n.pending;if(l!==null){if(a!==null){var o=a.next;a.next=l.next,l.next=o}s.baseQueue=a=l,n.pending=null}if(a!==null){l=a.next,s=s.baseState;var i=o=null,c=null,u=l;do{var f=u.lane;if((tr&f)===f)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:e(s,u.action);else{var d={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(i=c=d,o=s):c=c.next=d,je.lanes|=f,nr|=f}u=u.next}while(u!==null&&u!==l);c===null?o=s:c.next=i,zt(s,t.memoizedState)||(st=!0),t.memoizedState=s,t.baseState=o,t.baseQueue=c,n.lastRenderedState=s}if(e=n.interleaved,e!==null){a=e;do l=a.lane,je.lanes|=l,nr|=l,a=a.next;while(a!==e)}else a===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function vo(e){var t=Ft(),n=t.queue;if(n===null)throw Error(O(311));n.lastRenderedReducer=e;var s=n.dispatch,a=n.pending,l=t.memoizedState;if(a!==null){n.pending=null;var o=a=a.next;do l=e(l,o.action),o=o.next;while(o!==a);zt(l,t.memoizedState)||(st=!0),t.memoizedState=l,t.baseQueue===null&&(t.baseState=l),n.lastRenderedState=l}return[l,s]}function Lm(){}function Im(e,t){var n=je,s=Ft(),a=t(),l=!zt(s.memoizedState,a);if(l&&(s.memoizedState=a,st=!0),s=s.queue,mc($m.bind(null,n,s,e),[e]),s.getSnapshot!==t||l||Ie!==null&&Ie.memoizedState.tag&1){if(n.flags|=2048,Ys(9,Pm.bind(null,n,s,a,t),void 0,null),$e===null)throw Error(O(349));tr&30||Mm(n,t,a)}return a}function Mm(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=je.updateQueue,t===null?(t={lastEffect:null,stores:null},je.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Pm(e,t,n,s){t.value=n,t.getSnapshot=s,Om(t)&&zm(e)}function $m(e,t,n){return n(function(){Om(t)&&zm(e)})}function Om(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!zt(e,n)}catch{return!0}}function zm(e){var t=hn(e,1);t!==null&&Ot(t,e,1,-1)}function _u(e){var t=Kt();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vs,lastRenderedState:e},t.queue=e,e=e.dispatch=Ep.bind(null,je,e),[t.memoizedState,e]}function Ys(e,t,n,s){return e={tag:e,create:t,destroy:n,deps:s,next:null},t=je.updateQueue,t===null?(t={lastEffect:null,stores:null},je.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(s=n.next,n.next=e,e.next=s,t.lastEffect=e)),e}function Um(){return Ft().memoizedState}function Ma(e,t,n,s){var a=Kt();je.flags|=e,a.memoizedState=Ys(1|t,n,void 0,s===void 0?null:s)}function Fl(e,t,n,s){var a=Ft();s=s===void 0?null:s;var l=void 0;if(Re!==null){var o=Re.memoizedState;if(l=o.destroy,s!==null&&cc(s,o.deps)){a.memoizedState=Ys(t,n,l,s);return}}je.flags|=e,a.memoizedState=Ys(1|t,n,l,s)}function Eu(e,t){return Ma(8390656,8,e,t)}function mc(e,t){return Fl(2048,8,e,t)}function Bm(e,t){return Fl(4,2,e,t)}function Wm(e,t){return Fl(4,4,e,t)}function Hm(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Vm(e,t,n){return n=n!=null?n.concat([e]):null,Fl(4,4,Hm.bind(null,t,e),n)}function fc(){}function Ym(e,t){var n=Ft();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&cc(t,s[1])?s[0]:(n.memoizedState=[e,t],e)}function Km(e,t){var n=Ft();t=t===void 0?null:t;var s=n.memoizedState;return s!==null&&t!==null&&cc(t,s[1])?s[0]:(e=e(),n.memoizedState=[e,t],e)}function Qm(e,t,n){return tr&21?(zt(n,t)||(n=Zd(),je.lanes|=n,nr|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,st=!0),e.memoizedState=n)}function Cp(e,t){var n=de;de=n!==0&&4>n?n:4,e(!0);var s=go.transition;go.transition={};try{e(!1),t()}finally{de=n,go.transition=s}}function Gm(){return Ft().memoizedState}function _p(e,t,n){var s=In(e);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},Xm(e))qm(t,n);else if(n=Fm(e,t,n,s),n!==null){var a=Je();Ot(n,e,s,a),Jm(n,t,s)}}function Ep(e,t,n){var s=In(e),a={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(Xm(e))qm(t,a);else{var l=e.alternate;if(e.lanes===0&&(l===null||l.lanes===0)&&(l=t.lastRenderedReducer,l!==null))try{var o=t.lastRenderedState,i=l(o,n);if(a.hasEagerState=!0,a.eagerState=i,zt(i,o)){var c=t.interleaved;c===null?(a.next=a,sc(t)):(a.next=c.next,c.next=a),t.interleaved=a;return}}catch{}finally{}n=Fm(e,t,a,s),n!==null&&(a=Je(),Ot(n,e,s,a),Jm(n,t,s))}}function Xm(e){var t=e.alternate;return e===je||t!==null&&t===je}function qm(e,t){vs=cl=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Jm(e,t,n){if(n&4194240){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,Hi(e,n)}}var ul={readContext:Tt,useCallback:He,useContext:He,useEffect:He,useImperativeHandle:He,useInsertionEffect:He,useLayoutEffect:He,useMemo:He,useReducer:He,useRef:He,useState:He,useDebugValue:He,useDeferredValue:He,useTransition:He,useMutableSource:He,useSyncExternalStore:He,useId:He,unstable_isNewReconciler:!1},Dp={readContext:Tt,useCallback:function(e,t){return Kt().memoizedState=[e,t===void 0?null:t],e},useContext:Tt,useEffect:Eu,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Ma(4194308,4,Hm.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ma(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ma(4,2,e,t)},useMemo:function(e,t){var n=Kt();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var s=Kt();return t=n!==void 0?n(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=_p.bind(null,je,e),[s.memoizedState,e]},useRef:function(e){var t=Kt();return e={current:e},t.memoizedState=e},useState:_u,useDebugValue:fc,useDeferredValue:function(e){return Kt().memoizedState=e},useTransition:function(){var e=_u(!1),t=e[0];return e=Cp.bind(null,e[1]),Kt().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var s=je,a=Kt();if(ge){if(n===void 0)throw Error(O(407));n=n()}else{if(n=t(),$e===null)throw Error(O(349));tr&30||Mm(s,t,n)}a.memoizedState=n;var l={value:n,getSnapshot:t};return a.queue=l,Eu($m.bind(null,s,l,e),[e]),s.flags|=2048,Ys(9,Pm.bind(null,s,l,n,t),void 0,null),n},useId:function(){var e=Kt(),t=$e.identifierPrefix;if(ge){var n=ln,s=an;n=(s&~(1<<32-$t(s)-1)).toString(32)+n,t=":"+t+"R"+n,n=Hs++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=kp++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Tp={readContext:Tt,useCallback:Ym,useContext:Tt,useEffect:mc,useImperativeHandle:Vm,useInsertionEffect:Bm,useLayoutEffect:Wm,useMemo:Km,useReducer:yo,useRef:Um,useState:function(){return yo(Vs)},useDebugValue:fc,useDeferredValue:function(e){var t=Ft();return Qm(t,Re.memoizedState,e)},useTransition:function(){var e=yo(Vs)[0],t=Ft().memoizedState;return[e,t]},useMutableSource:Lm,useSyncExternalStore:Im,useId:Gm,unstable_isNewReconciler:!1},Fp={readContext:Tt,useCallback:Ym,useContext:Tt,useEffect:mc,useImperativeHandle:Vm,useInsertionEffect:Bm,useLayoutEffect:Wm,useMemo:Km,useReducer:vo,useRef:Um,useState:function(){return vo(Vs)},useDebugValue:fc,useDeferredValue:function(e){var t=Ft();return Re===null?t.memoizedState=e:Qm(t,Re.memoizedState,e)},useTransition:function(){var e=vo(Vs)[0],t=Ft().memoizedState;return[e,t]},useMutableSource:Lm,useSyncExternalStore:Im,useId:Gm,unstable_isNewReconciler:!1};function Lt(e,t){if(e&&e.defaultProps){t=Ne({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function ii(e,t,n,s){t=e.memoizedState,n=n(s,t),n=n==null?t:Ne({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Rl={isMounted:function(e){return(e=e._reactInternals)?lr(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var s=Je(),a=In(e),l=on(s,a);l.payload=t,n!=null&&(l.callback=n),t=An(e,l,a),t!==null&&(Ot(t,e,a,s),La(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var s=Je(),a=In(e),l=on(s,a);l.tag=1,l.payload=t,n!=null&&(l.callback=n),t=An(e,l,a),t!==null&&(Ot(t,e,a,s),La(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Je(),s=In(e),a=on(n,s);a.tag=2,t!=null&&(a.callback=t),t=An(e,a,s),t!==null&&(Ot(t,e,s,n),La(t,e,s))}};function Du(e,t,n,s,a,l,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,l,o):t.prototype&&t.prototype.isPureReactComponent?!$s(n,s)||!$s(a,l):!0}function Zm(e,t,n){var s=!1,a=$n,l=t.contextType;return typeof l=="object"&&l!==null?l=Tt(l):(a=lt(t)?Zn:Ke.current,s=t.contextTypes,l=(s=s!=null)?Ir(e,a):$n),t=new t(n,l),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Rl,e.stateNode=t,t._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=l),t}function Tu(e,t,n,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,s),t.state!==e&&Rl.enqueueReplaceState(t,t.state,null)}function ci(e,t,n,s){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},ac(e);var l=t.contextType;typeof l=="object"&&l!==null?a.context=Tt(l):(l=lt(t)?Zn:Ke.current,a.context=Ir(e,l)),a.state=e.memoizedState,l=t.getDerivedStateFromProps,typeof l=="function"&&(ii(e,t,l,n),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Rl.enqueueReplaceState(a,a.state,null),ol(e,n,a,s),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Or(e,t){try{var n="",s=t;do n+=ax(s),s=s.return;while(s);var a=n}catch(l){a=`
Error generating stack: `+l.message+`
`+l.stack}return{value:e,source:t,stack:a,digest:null}}function bo(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function ui(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var Rp=typeof WeakMap=="function"?WeakMap:Map;function ef(e,t,n){n=on(-1,n),n.tag=3,n.payload={element:null};var s=t.value;return n.callback=function(){ml||(ml=!0,bi=s),ui(e,t)},n}function tf(e,t,n){n=on(-1,n),n.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var a=t.value;n.payload=function(){return s(a)},n.callback=function(){ui(e,t)}}var l=e.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(n.callback=function(){ui(e,t),typeof s!="function"&&(Ln===null?Ln=new Set([this]):Ln.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function Fu(e,t,n){var s=e.pingCache;if(s===null){s=e.pingCache=new Rp;var a=new Set;s.set(t,a)}else a=s.get(t),a===void 0&&(a=new Set,s.set(t,a));a.has(n)||(a.add(n),e=Yp.bind(null,e,t,n),t.then(e,e))}function Ru(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Au(e,t,n,s,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=on(-1,1),t.tag=2,An(n,t,1))),n.lanes|=1),e)}var Ap=pn.ReactCurrentOwner,st=!1;function Ge(e,t,n,s){t.child=e===null?Tm(t,null,n,s):Pr(t,e.child,n,s)}function Lu(e,t,n,s,a){n=n.render;var l=t.ref;return Dr(t,a),s=uc(e,t,n,s,l,a),n=dc(),e!==null&&!st?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,xn(e,t,a)):(ge&&n&&Ji(t),t.flags|=1,Ge(e,t,s,a),t.child)}function Iu(e,t,n,s,a){if(e===null){var l=n.type;return typeof l=="function"&&!wc(l)&&l.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=l,nf(e,t,l,s,a)):(e=za(n.type,null,s,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(l=e.child,!(e.lanes&a)){var o=l.memoizedProps;if(n=n.compare,n=n!==null?n:$s,n(o,s)&&e.ref===t.ref)return xn(e,t,a)}return t.flags|=1,e=Mn(l,s),e.ref=t.ref,e.return=t,t.child=e}function nf(e,t,n,s,a){if(e!==null){var l=e.memoizedProps;if($s(l,s)&&e.ref===t.ref)if(st=!1,t.pendingProps=s=l,(e.lanes&a)!==0)e.flags&131072&&(st=!0);else return t.lanes=e.lanes,xn(e,t,a)}return di(e,t,n,s,a)}function rf(e,t,n){var s=t.pendingProps,a=s.children,l=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},he(Nr,ht),ht|=n;else{if(!(n&1073741824))return e=l!==null?l.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,he(Nr,ht),ht|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=l!==null?l.baseLanes:n,he(Nr,ht),ht|=s}else l!==null?(s=l.baseLanes|n,t.memoizedState=null):s=n,he(Nr,ht),ht|=s;return Ge(e,t,a,n),t.child}function sf(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function di(e,t,n,s,a){var l=lt(n)?Zn:Ke.current;return l=Ir(t,l),Dr(t,a),n=uc(e,t,n,s,l,a),s=dc(),e!==null&&!st?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,xn(e,t,a)):(ge&&s&&Ji(t),t.flags|=1,Ge(e,t,n,a),t.child)}function Mu(e,t,n,s,a){if(lt(n)){var l=!0;nl(t)}else l=!1;if(Dr(t,a),t.stateNode===null)Pa(e,t),Zm(t,n,s),ci(t,n,s,a),s=!0;else if(e===null){var o=t.stateNode,i=t.memoizedProps;o.props=i;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Tt(u):(u=lt(n)?Zn:Ke.current,u=Ir(t,u));var f=n.getDerivedStateFromProps,d=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(i!==s||c!==u)&&Tu(t,o,s,u),Nn=!1;var y=t.memoizedState;o.state=y,ol(t,s,o,a),c=t.memoizedState,i!==s||y!==c||at.current||Nn?(typeof f=="function"&&(ii(t,n,f,s),c=t.memoizedState),(i=Nn||Du(t,n,i,s,y,c,u))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=c),o.props=s,o.state=c,o.context=u,s=i):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{o=t.stateNode,Rm(e,t),i=t.memoizedProps,u=t.type===t.elementType?i:Lt(t.type,i),o.props=u,d=t.pendingProps,y=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=Tt(c):(c=lt(n)?Zn:Ke.current,c=Ir(t,c));var g=n.getDerivedStateFromProps;(f=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(i!==d||y!==c)&&Tu(t,o,s,c),Nn=!1,y=t.memoizedState,o.state=y,ol(t,s,o,a);var b=t.memoizedState;i!==d||y!==b||at.current||Nn?(typeof g=="function"&&(ii(t,n,g,s),b=t.memoizedState),(u=Nn||Du(t,n,u,s,y,b,c)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,b,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,b,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||i===e.memoizedProps&&y===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||i===e.memoizedProps&&y===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=b),o.props=s,o.state=b,o.context=c,s=u):(typeof o.componentDidUpdate!="function"||i===e.memoizedProps&&y===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||i===e.memoizedProps&&y===e.memoizedState||(t.flags|=1024),s=!1)}return mi(e,t,n,s,l,a)}function mi(e,t,n,s,a,l){sf(e,t);var o=(t.flags&128)!==0;if(!s&&!o)return a&&wu(t,n,!1),xn(e,t,l);s=t.stateNode,Ap.current=t;var i=o&&typeof n.getDerivedStateFromError!="function"?null:s.render();return t.flags|=1,e!==null&&o?(t.child=Pr(t,e.child,null,l),t.child=Pr(t,null,i,l)):Ge(e,t,i,l),t.memoizedState=s.state,a&&wu(t,n,!0),t.child}function af(e){var t=e.stateNode;t.pendingContext?bu(e,t.pendingContext,t.pendingContext!==t.context):t.context&&bu(e,t.context,!1),lc(e,t.containerInfo)}function Pu(e,t,n,s,a){return Mr(),ec(a),t.flags|=256,Ge(e,t,n,s),t.child}var fi={dehydrated:null,treeContext:null,retryLane:0};function hi(e){return{baseLanes:e,cachePool:null,transitions:null}}function lf(e,t,n){var s=t.pendingProps,a=be.current,l=!1,o=(t.flags&128)!==0,i;if((i=o)||(i=e!==null&&e.memoizedState===null?!1:(a&2)!==0),i?(l=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),he(be,a&1),e===null)return li(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=s.children,e=s.fallback,l?(s=t.mode,l=t.child,o={mode:"hidden",children:o},!(s&1)&&l!==null?(l.childLanes=0,l.pendingProps=o):l=Il(o,s,0,null),e=qn(e,s,n,null),l.return=t,e.return=t,l.sibling=e,t.child=l,t.child.memoizedState=hi(n),t.memoizedState=fi,e):hc(t,o));if(a=e.memoizedState,a!==null&&(i=a.dehydrated,i!==null))return Lp(e,t,o,s,i,a,n);if(l){l=s.fallback,o=t.mode,a=e.child,i=a.sibling;var c={mode:"hidden",children:s.children};return!(o&1)&&t.child!==a?(s=t.child,s.childLanes=0,s.pendingProps=c,t.deletions=null):(s=Mn(a,c),s.subtreeFlags=a.subtreeFlags&14680064),i!==null?l=Mn(i,l):(l=qn(l,o,n,null),l.flags|=2),l.return=t,s.return=t,s.sibling=l,t.child=s,s=l,l=t.child,o=e.child.memoizedState,o=o===null?hi(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},l.memoizedState=o,l.childLanes=e.childLanes&~n,t.memoizedState=fi,s}return l=e.child,e=l.sibling,s=Mn(l,{mode:"visible",children:s.children}),!(t.mode&1)&&(s.lanes=n),s.return=t,s.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=s,t.memoizedState=null,s}function hc(e,t){return t=Il({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function ja(e,t,n,s){return s!==null&&ec(s),Pr(t,e.child,null,n),e=hc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Lp(e,t,n,s,a,l,o){if(n)return t.flags&256?(t.flags&=-257,s=bo(Error(O(422))),ja(e,t,o,s)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(l=s.fallback,a=t.mode,s=Il({mode:"visible",children:s.children},a,0,null),l=qn(l,a,o,null),l.flags|=2,s.return=t,l.return=t,s.sibling=l,t.child=s,t.mode&1&&Pr(t,e.child,null,o),t.child.memoizedState=hi(o),t.memoizedState=fi,l);if(!(t.mode&1))return ja(e,t,o,null);if(a.data==="$!"){if(s=a.nextSibling&&a.nextSibling.dataset,s)var i=s.dgst;return s=i,l=Error(O(419)),s=bo(l,s,void 0),ja(e,t,o,s)}if(i=(o&e.childLanes)!==0,st||i){if(s=$e,s!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(s.suspendedLanes|o)?0:a,a!==0&&a!==l.retryLane&&(l.retryLane=a,hn(e,a),Ot(s,e,a,-1))}return bc(),s=bo(Error(O(421))),ja(e,t,o,s)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=Kp.bind(null,e),a._reactRetry=t,null):(e=l.treeContext,pt=Rn(a.nextSibling),gt=t,ge=!0,Mt=null,e!==null&&(St[kt++]=an,St[kt++]=ln,St[kt++]=er,an=e.id,ln=e.overflow,er=t),t=hc(t,s.children),t.flags|=4096,t)}function $u(e,t,n){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),oi(e.return,t,n)}function wo(e,t,n,s,a){var l=e.memoizedState;l===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:a}:(l.isBackwards=t,l.rendering=null,l.renderingStartTime=0,l.last=s,l.tail=n,l.tailMode=a)}function of(e,t,n){var s=t.pendingProps,a=s.revealOrder,l=s.tail;if(Ge(e,t,s.children,n),s=be.current,s&2)s=s&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&$u(e,n,t);else if(e.tag===19)$u(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(he(be,s),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;n!==null;)e=n.alternate,e!==null&&il(e)===null&&(a=n),n=n.sibling;n=a,n===null?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),wo(t,!1,a,n,l);break;case"backwards":for(n=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&il(e)===null){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}wo(t,!0,n,null,l);break;case"together":wo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Pa(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function xn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),nr|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(O(153));if(t.child!==null){for(e=t.child,n=Mn(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Mn(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Ip(e,t,n){switch(t.tag){case 3:af(t),Mr();break;case 5:Am(t);break;case 1:lt(t.type)&&nl(t);break;case 4:lc(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,a=t.memoizedProps.value;he(al,s._currentValue),s._currentValue=a;break;case 13:if(s=t.memoizedState,s!==null)return s.dehydrated!==null?(he(be,be.current&1),t.flags|=128,null):n&t.child.childLanes?lf(e,t,n):(he(be,be.current&1),e=xn(e,t,n),e!==null?e.sibling:null);he(be,be.current&1);break;case 19:if(s=(n&t.childLanes)!==0,e.flags&128){if(s)return of(e,t,n);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),he(be,be.current),s)break;return null;case 22:case 23:return t.lanes=0,rf(e,t,n)}return xn(e,t,n)}var cf,xi,uf,df;cf=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};xi=function(){};uf=function(e,t,n,s){var a=e.memoizedProps;if(a!==s){e=t.stateNode,Gn(qt.current);var l=null;switch(n){case"input":a=Po(e,a),s=Po(e,s),l=[];break;case"select":a=Ne({},a,{value:void 0}),s=Ne({},s,{value:void 0}),l=[];break;case"textarea":a=zo(e,a),s=zo(e,s),l=[];break;default:typeof a.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=el)}Bo(n,s);var o;n=null;for(u in a)if(!s.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var i=a[u];for(o in i)i.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Fs.hasOwnProperty(u)?l||(l=[]):(l=l||[]).push(u,null));for(u in s){var c=s[u];if(i=a!=null?a[u]:void 0,s.hasOwnProperty(u)&&c!==i&&(c!=null||i!=null))if(u==="style")if(i){for(o in i)!i.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&i[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(l||(l=[]),l.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,i=i?i.__html:void 0,c!=null&&i!==c&&(l=l||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(l=l||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Fs.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&xe("scroll",e),l||i===c||(l=[])):(l=l||[]).push(u,c))}n&&(l=l||[]).push("style",n);var u=l;(t.updateQueue=u)&&(t.flags|=4)}};df=function(e,t,n,s){n!==s&&(t.flags|=4)};function ls(e,t){if(!ge)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function Ve(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,s=0;if(t)for(var a=e.child;a!==null;)n|=a.lanes|a.childLanes,s|=a.subtreeFlags&14680064,s|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)n|=a.lanes|a.childLanes,s|=a.subtreeFlags,s|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=s,e.childLanes=n,t}function Mp(e,t,n){var s=t.pendingProps;switch(Zi(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ve(t),null;case 1:return lt(t.type)&&tl(),Ve(t),null;case 3:return s=t.stateNode,$r(),pe(at),pe(Ke),ic(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(ba(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Mt!==null&&(Ni(Mt),Mt=null))),xi(e,t),Ve(t),null;case 5:oc(t);var a=Gn(Ws.current);if(n=t.type,e!==null&&t.stateNode!=null)uf(e,t,n,s,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(t.stateNode===null)throw Error(O(166));return Ve(t),null}if(e=Gn(qt.current),ba(t)){s=t.stateNode,n=t.type;var l=t.memoizedProps;switch(s[Qt]=t,s[Us]=l,e=(t.mode&1)!==0,n){case"dialog":xe("cancel",s),xe("close",s);break;case"iframe":case"object":case"embed":xe("load",s);break;case"video":case"audio":for(a=0;a<fs.length;a++)xe(fs[a],s);break;case"source":xe("error",s);break;case"img":case"image":case"link":xe("error",s),xe("load",s);break;case"details":xe("toggle",s);break;case"input":Kc(s,l),xe("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!l.multiple},xe("invalid",s);break;case"textarea":Gc(s,l),xe("invalid",s)}Bo(n,l),a=null;for(var o in l)if(l.hasOwnProperty(o)){var i=l[o];o==="children"?typeof i=="string"?s.textContent!==i&&(l.suppressHydrationWarning!==!0&&va(s.textContent,i,e),a=["children",i]):typeof i=="number"&&s.textContent!==""+i&&(l.suppressHydrationWarning!==!0&&va(s.textContent,i,e),a=["children",""+i]):Fs.hasOwnProperty(o)&&i!=null&&o==="onScroll"&&xe("scroll",s)}switch(n){case"input":da(s),Qc(s,l,!0);break;case"textarea":da(s),Xc(s);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(s.onclick=el)}s=a,t.updateQueue=s,s!==null&&(t.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=$d(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=o.createElement(n,{is:s.is}):(e=o.createElement(n),n==="select"&&(o=e,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):e=o.createElementNS(e,n),e[Qt]=t,e[Us]=s,cf(e,t,!1,!1),t.stateNode=e;e:{switch(o=Wo(n,s),n){case"dialog":xe("cancel",e),xe("close",e),a=s;break;case"iframe":case"object":case"embed":xe("load",e),a=s;break;case"video":case"audio":for(a=0;a<fs.length;a++)xe(fs[a],e);a=s;break;case"source":xe("error",e),a=s;break;case"img":case"image":case"link":xe("error",e),xe("load",e),a=s;break;case"details":xe("toggle",e),a=s;break;case"input":Kc(e,s),a=Po(e,s),xe("invalid",e);break;case"option":a=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},a=Ne({},s,{value:void 0}),xe("invalid",e);break;case"textarea":Gc(e,s),a=zo(e,s),xe("invalid",e);break;default:a=s}Bo(n,a),i=a;for(l in i)if(i.hasOwnProperty(l)){var c=i[l];l==="style"?Ud(e,c):l==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Od(e,c)):l==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Rs(e,c):typeof c=="number"&&Rs(e,""+c):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(Fs.hasOwnProperty(l)?c!=null&&l==="onScroll"&&xe("scroll",e):c!=null&&$i(e,l,c,o))}switch(n){case"input":da(e),Qc(e,s,!1);break;case"textarea":da(e),Xc(e);break;case"option":s.value!=null&&e.setAttribute("value",""+Pn(s.value));break;case"select":e.multiple=!!s.multiple,l=s.value,l!=null?kr(e,!!s.multiple,l,!1):s.defaultValue!=null&&kr(e,!!s.multiple,s.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=el)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ve(t),null;case 6:if(e&&t.stateNode!=null)df(e,t,e.memoizedProps,s);else{if(typeof s!="string"&&t.stateNode===null)throw Error(O(166));if(n=Gn(Ws.current),Gn(qt.current),ba(t)){if(s=t.stateNode,n=t.memoizedProps,s[Qt]=t,(l=s.nodeValue!==n)&&(e=gt,e!==null))switch(e.tag){case 3:va(s.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&va(s.nodeValue,n,(e.mode&1)!==0)}l&&(t.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[Qt]=t,t.stateNode=s}return Ve(t),null;case 13:if(pe(be),s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ge&&pt!==null&&t.mode&1&&!(t.flags&128))Em(),Mr(),t.flags|=98560,l=!1;else if(l=ba(t),s!==null&&s.dehydrated!==null){if(e===null){if(!l)throw Error(O(318));if(l=t.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(O(317));l[Qt]=t}else Mr(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ve(t),l=!1}else Mt!==null&&(Ni(Mt),Mt=null),l=!0;if(!l)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(t.child.flags|=8192,t.mode&1&&(e===null||be.current&1?Le===0&&(Le=3):bc())),t.updateQueue!==null&&(t.flags|=4),Ve(t),null);case 4:return $r(),xi(e,t),e===null&&Os(t.stateNode.containerInfo),Ve(t),null;case 10:return rc(t.type._context),Ve(t),null;case 17:return lt(t.type)&&tl(),Ve(t),null;case 19:if(pe(be),l=t.memoizedState,l===null)return Ve(t),null;if(s=(t.flags&128)!==0,o=l.rendering,o===null)if(s)ls(l,!1);else{if(Le!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=il(e),o!==null){for(t.flags|=128,ls(l,!1),s=o.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=n,n=t.child;n!==null;)l=n,e=s,l.flags&=14680066,o=l.alternate,o===null?(l.childLanes=0,l.lanes=e,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=o.childLanes,l.lanes=o.lanes,l.child=o.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=o.memoizedProps,l.memoizedState=o.memoizedState,l.updateQueue=o.updateQueue,l.type=o.type,e=o.dependencies,l.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return he(be,be.current&1|2),t.child}e=e.sibling}l.tail!==null&&_e()>zr&&(t.flags|=128,s=!0,ls(l,!1),t.lanes=4194304)}else{if(!s)if(e=il(o),e!==null){if(t.flags|=128,s=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),ls(l,!0),l.tail===null&&l.tailMode==="hidden"&&!o.alternate&&!ge)return Ve(t),null}else 2*_e()-l.renderingStartTime>zr&&n!==1073741824&&(t.flags|=128,s=!0,ls(l,!1),t.lanes=4194304);l.isBackwards?(o.sibling=t.child,t.child=o):(n=l.last,n!==null?n.sibling=o:t.child=o,l.last=o)}return l.tail!==null?(t=l.tail,l.rendering=t,l.tail=t.sibling,l.renderingStartTime=_e(),t.sibling=null,n=be.current,he(be,s?n&1|2:n&1),t):(Ve(t),null);case 22:case 23:return vc(),s=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(t.flags|=8192),s&&t.mode&1?ht&1073741824&&(Ve(t),t.subtreeFlags&6&&(t.flags|=8192)):Ve(t),null;case 24:return null;case 25:return null}throw Error(O(156,t.tag))}function Pp(e,t){switch(Zi(t),t.tag){case 1:return lt(t.type)&&tl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return $r(),pe(at),pe(Ke),ic(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return oc(t),null;case 13:if(pe(be),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(O(340));Mr()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return pe(be),null;case 4:return $r(),null;case 10:return rc(t.type._context),null;case 22:case 23:return vc(),null;case 24:return null;default:return null}}var Na=!1,Ye=!1,$p=typeof WeakSet=="function"?WeakSet:Set,H=null;function jr(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){ke(e,t,s)}else n.current=null}function pi(e,t,n){try{n()}catch(s){ke(e,t,s)}}var Ou=!1;function Op(e,t){if(Zo=qa,e=xm(),qi(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var a=s.anchorOffset,l=s.focusNode;s=s.focusOffset;try{n.nodeType,l.nodeType}catch{n=null;break e}var o=0,i=-1,c=-1,u=0,f=0,d=e,y=null;t:for(;;){for(var g;d!==n||a!==0&&d.nodeType!==3||(i=o+a),d!==l||s!==0&&d.nodeType!==3||(c=o+s),d.nodeType===3&&(o+=d.nodeValue.length),(g=d.firstChild)!==null;)y=d,d=g;for(;;){if(d===e)break t;if(y===n&&++u===a&&(i=o),y===l&&++f===s&&(c=o),(g=d.nextSibling)!==null)break;d=y,y=d.parentNode}d=g}n=i===-1||c===-1?null:{start:i,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ei={focusedElem:e,selectionRange:n},qa=!1,H=t;H!==null;)if(t=H,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,H=e;else for(;H!==null;){t=H;try{var b=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var v=b.memoizedProps,S=b.memoizedState,x=t.stateNode,h=x.getSnapshotBeforeUpdate(t.elementType===t.type?v:Lt(t.type,v),S);x.__reactInternalSnapshotBeforeUpdate=h}break;case 3:var m=t.stateNode.containerInfo;m.nodeType===1?m.textContent="":m.nodeType===9&&m.documentElement&&m.removeChild(m.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(O(163))}}catch(k){ke(t,t.return,k)}if(e=t.sibling,e!==null){e.return=t.return,H=e;break}H=t.return}return b=Ou,Ou=!1,b}function bs(e,t,n){var s=t.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var a=s=s.next;do{if((a.tag&e)===e){var l=a.destroy;a.destroy=void 0,l!==void 0&&pi(t,n,l)}a=a.next}while(a!==s)}}function Al(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var s=n.create;n.destroy=s()}n=n.next}while(n!==t)}}function gi(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function mf(e){var t=e.alternate;t!==null&&(e.alternate=null,mf(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Qt],delete t[Us],delete t[ri],delete t[wp],delete t[jp])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ff(e){return e.tag===5||e.tag===3||e.tag===4}function zu(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||ff(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function yi(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=el));else if(s!==4&&(e=e.child,e!==null))for(yi(e,t,n),e=e.sibling;e!==null;)yi(e,t,n),e=e.sibling}function vi(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(vi(e,t,n),e=e.sibling;e!==null;)vi(e,t,n),e=e.sibling}var ze=null,It=!1;function wn(e,t,n){for(n=n.child;n!==null;)hf(e,t,n),n=n.sibling}function hf(e,t,n){if(Xt&&typeof Xt.onCommitFiberUnmount=="function")try{Xt.onCommitFiberUnmount(kl,n)}catch{}switch(n.tag){case 5:Ye||jr(n,t);case 6:var s=ze,a=It;ze=null,wn(e,t,n),ze=s,It=a,ze!==null&&(It?(e=ze,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):ze.removeChild(n.stateNode));break;case 18:ze!==null&&(It?(e=ze,n=n.stateNode,e.nodeType===8?ho(e.parentNode,n):e.nodeType===1&&ho(e,n),Ms(e)):ho(ze,n.stateNode));break;case 4:s=ze,a=It,ze=n.stateNode.containerInfo,It=!0,wn(e,t,n),ze=s,It=a;break;case 0:case 11:case 14:case 15:if(!Ye&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){a=s=s.next;do{var l=a,o=l.destroy;l=l.tag,o!==void 0&&(l&2||l&4)&&pi(n,t,o),a=a.next}while(a!==s)}wn(e,t,n);break;case 1:if(!Ye&&(jr(n,t),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(i){ke(n,t,i)}wn(e,t,n);break;case 21:wn(e,t,n);break;case 22:n.mode&1?(Ye=(s=Ye)||n.memoizedState!==null,wn(e,t,n),Ye=s):wn(e,t,n);break;default:wn(e,t,n)}}function Uu(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new $p),t.forEach(function(s){var a=Qp.bind(null,e,s);n.has(s)||(n.add(s),s.then(a,a))})}}function At(e,t){var n=t.deletions;if(n!==null)for(var s=0;s<n.length;s++){var a=n[s];try{var l=e,o=t,i=o;e:for(;i!==null;){switch(i.tag){case 5:ze=i.stateNode,It=!1;break e;case 3:ze=i.stateNode.containerInfo,It=!0;break e;case 4:ze=i.stateNode.containerInfo,It=!0;break e}i=i.return}if(ze===null)throw Error(O(160));hf(l,o,a),ze=null,It=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(u){ke(a,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)xf(t,e),t=t.sibling}function xf(e,t){var n=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(At(t,e),Yt(e),s&4){try{bs(3,e,e.return),Al(3,e)}catch(v){ke(e,e.return,v)}try{bs(5,e,e.return)}catch(v){ke(e,e.return,v)}}break;case 1:At(t,e),Yt(e),s&512&&n!==null&&jr(n,n.return);break;case 5:if(At(t,e),Yt(e),s&512&&n!==null&&jr(n,n.return),e.flags&32){var a=e.stateNode;try{Rs(a,"")}catch(v){ke(e,e.return,v)}}if(s&4&&(a=e.stateNode,a!=null)){var l=e.memoizedProps,o=n!==null?n.memoizedProps:l,i=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{i==="input"&&l.type==="radio"&&l.name!=null&&Md(a,l),Wo(i,o);var u=Wo(i,l);for(o=0;o<c.length;o+=2){var f=c[o],d=c[o+1];f==="style"?Ud(a,d):f==="dangerouslySetInnerHTML"?Od(a,d):f==="children"?Rs(a,d):$i(a,f,d,u)}switch(i){case"input":$o(a,l);break;case"textarea":Pd(a,l);break;case"select":var y=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!l.multiple;var g=l.value;g!=null?kr(a,!!l.multiple,g,!1):y!==!!l.multiple&&(l.defaultValue!=null?kr(a,!!l.multiple,l.defaultValue,!0):kr(a,!!l.multiple,l.multiple?[]:"",!1))}a[Us]=l}catch(v){ke(e,e.return,v)}}break;case 6:if(At(t,e),Yt(e),s&4){if(e.stateNode===null)throw Error(O(162));a=e.stateNode,l=e.memoizedProps;try{a.nodeValue=l}catch(v){ke(e,e.return,v)}}break;case 3:if(At(t,e),Yt(e),s&4&&n!==null&&n.memoizedState.isDehydrated)try{Ms(t.containerInfo)}catch(v){ke(e,e.return,v)}break;case 4:At(t,e),Yt(e);break;case 13:At(t,e),Yt(e),a=e.child,a.flags&8192&&(l=a.memoizedState!==null,a.stateNode.isHidden=l,!l||a.alternate!==null&&a.alternate.memoizedState!==null||(gc=_e())),s&4&&Uu(e);break;case 22:if(f=n!==null&&n.memoizedState!==null,e.mode&1?(Ye=(u=Ye)||f,At(t,e),Ye=u):At(t,e),Yt(e),s&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!f&&e.mode&1)for(H=e,f=e.child;f!==null;){for(d=H=f;H!==null;){switch(y=H,g=y.child,y.tag){case 0:case 11:case 14:case 15:bs(4,y,y.return);break;case 1:jr(y,y.return);var b=y.stateNode;if(typeof b.componentWillUnmount=="function"){s=y,n=y.return;try{t=s,b.props=t.memoizedProps,b.state=t.memoizedState,b.componentWillUnmount()}catch(v){ke(s,n,v)}}break;case 5:jr(y,y.return);break;case 22:if(y.memoizedState!==null){Wu(d);continue}}g!==null?(g.return=y,H=g):Wu(d)}f=f.sibling}e:for(f=null,d=e;;){if(d.tag===5){if(f===null){f=d;try{a=d.stateNode,u?(l=a.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(i=d.stateNode,c=d.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,i.style.display=zd("display",o))}catch(v){ke(e,e.return,v)}}}else if(d.tag===6){if(f===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(v){ke(e,e.return,v)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;f===d&&(f=null),d=d.return}f===d&&(f=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:At(t,e),Yt(e),s&4&&Uu(e);break;case 21:break;default:At(t,e),Yt(e)}}function Yt(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(ff(n)){var s=n;break e}n=n.return}throw Error(O(160))}switch(s.tag){case 5:var a=s.stateNode;s.flags&32&&(Rs(a,""),s.flags&=-33);var l=zu(e);vi(e,l,a);break;case 3:case 4:var o=s.stateNode.containerInfo,i=zu(e);yi(e,i,o);break;default:throw Error(O(161))}}catch(c){ke(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function zp(e,t,n){H=e,pf(e)}function pf(e,t,n){for(var s=(e.mode&1)!==0;H!==null;){var a=H,l=a.child;if(a.tag===22&&s){var o=a.memoizedState!==null||Na;if(!o){var i=a.alternate,c=i!==null&&i.memoizedState!==null||Ye;i=Na;var u=Ye;if(Na=o,(Ye=c)&&!u)for(H=a;H!==null;)o=H,c=o.child,o.tag===22&&o.memoizedState!==null?Hu(a):c!==null?(c.return=o,H=c):Hu(a);for(;l!==null;)H=l,pf(l),l=l.sibling;H=a,Na=i,Ye=u}Bu(e)}else a.subtreeFlags&8772&&l!==null?(l.return=a,H=l):Bu(e)}}function Bu(e){for(;H!==null;){var t=H;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ye||Al(5,t);break;case 1:var s=t.stateNode;if(t.flags&4&&!Ye)if(n===null)s.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:Lt(t.type,n.memoizedProps);s.componentDidUpdate(a,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var l=t.updateQueue;l!==null&&Cu(t,l,s);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Cu(t,o,n)}break;case 5:var i=t.stateNode;if(n===null&&t.flags&4){n=i;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var d=f.dehydrated;d!==null&&Ms(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(O(163))}Ye||t.flags&512&&gi(t)}catch(y){ke(t,t.return,y)}}if(t===e){H=null;break}if(n=t.sibling,n!==null){n.return=t.return,H=n;break}H=t.return}}function Wu(e){for(;H!==null;){var t=H;if(t===e){H=null;break}var n=t.sibling;if(n!==null){n.return=t.return,H=n;break}H=t.return}}function Hu(e){for(;H!==null;){var t=H;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Al(4,t)}catch(c){ke(t,n,c)}break;case 1:var s=t.stateNode;if(typeof s.componentDidMount=="function"){var a=t.return;try{s.componentDidMount()}catch(c){ke(t,a,c)}}var l=t.return;try{gi(t)}catch(c){ke(t,l,c)}break;case 5:var o=t.return;try{gi(t)}catch(c){ke(t,o,c)}}}catch(c){ke(t,t.return,c)}if(t===e){H=null;break}var i=t.sibling;if(i!==null){i.return=t.return,H=i;break}H=t.return}}var Up=Math.ceil,dl=pn.ReactCurrentDispatcher,xc=pn.ReactCurrentOwner,Dt=pn.ReactCurrentBatchConfig,oe=0,$e=null,Te=null,Ue=0,ht=0,Nr=Wn(0),Le=0,Ks=null,nr=0,Ll=0,pc=0,ws=null,rt=null,gc=0,zr=1/0,nn=null,ml=!1,bi=null,Ln=null,Sa=!1,En=null,fl=0,js=0,wi=null,$a=-1,Oa=0;function Je(){return oe&6?_e():$a!==-1?$a:$a=_e()}function In(e){return e.mode&1?oe&2&&Ue!==0?Ue&-Ue:Sp.transition!==null?(Oa===0&&(Oa=Zd()),Oa):(e=de,e!==0||(e=window.event,e=e===void 0?16:lm(e.type)),e):1}function Ot(e,t,n,s){if(50<js)throw js=0,wi=null,Error(O(185));Zs(e,n,s),(!(oe&2)||e!==$e)&&(e===$e&&(!(oe&2)&&(Ll|=n),Le===4&&Cn(e,Ue)),ot(e,s),n===1&&oe===0&&!(t.mode&1)&&(zr=_e()+500,Tl&&Hn()))}function ot(e,t){var n=e.callbackNode;Sx(e,t);var s=Xa(e,e===$e?Ue:0);if(s===0)n!==null&&Zc(n),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(n!=null&&Zc(n),t===1)e.tag===0?Np(Vu.bind(null,e)):km(Vu.bind(null,e)),vp(function(){!(oe&6)&&Hn()}),n=null;else{switch(em(s)){case 1:n=Wi;break;case 4:n=qd;break;case 16:n=Ga;break;case 536870912:n=Jd;break;default:n=Ga}n=Sf(n,gf.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function gf(e,t){if($a=-1,Oa=0,oe&6)throw Error(O(327));var n=e.callbackNode;if(Tr()&&e.callbackNode!==n)return null;var s=Xa(e,e===$e?Ue:0);if(s===0)return null;if(s&30||s&e.expiredLanes||t)t=hl(e,s);else{t=s;var a=oe;oe|=2;var l=vf();($e!==e||Ue!==t)&&(nn=null,zr=_e()+500,Xn(e,t));do try{Hp();break}catch(i){yf(e,i)}while(!0);nc(),dl.current=l,oe=a,Te!==null?t=0:($e=null,Ue=0,t=Le)}if(t!==0){if(t===2&&(a=Qo(e),a!==0&&(s=a,t=ji(e,a))),t===1)throw n=Ks,Xn(e,0),Cn(e,s),ot(e,_e()),n;if(t===6)Cn(e,s);else{if(a=e.current.alternate,!(s&30)&&!Bp(a)&&(t=hl(e,s),t===2&&(l=Qo(e),l!==0&&(s=l,t=ji(e,l))),t===1))throw n=Ks,Xn(e,0),Cn(e,s),ot(e,_e()),n;switch(e.finishedWork=a,e.finishedLanes=s,t){case 0:case 1:throw Error(O(345));case 2:Yn(e,rt,nn);break;case 3:if(Cn(e,s),(s&130023424)===s&&(t=gc+500-_e(),10<t)){if(Xa(e,0)!==0)break;if(a=e.suspendedLanes,(a&s)!==s){Je(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ni(Yn.bind(null,e,rt,nn),t);break}Yn(e,rt,nn);break;case 4:if(Cn(e,s),(s&4194240)===s)break;for(t=e.eventTimes,a=-1;0<s;){var o=31-$t(s);l=1<<o,o=t[o],o>a&&(a=o),s&=~l}if(s=a,s=_e()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*Up(s/1960))-s,10<s){e.timeoutHandle=ni(Yn.bind(null,e,rt,nn),s);break}Yn(e,rt,nn);break;case 5:Yn(e,rt,nn);break;default:throw Error(O(329))}}}return ot(e,_e()),e.callbackNode===n?gf.bind(null,e):null}function ji(e,t){var n=ws;return e.current.memoizedState.isDehydrated&&(Xn(e,t).flags|=256),e=hl(e,t),e!==2&&(t=rt,rt=n,t!==null&&Ni(t)),e}function Ni(e){rt===null?rt=e:rt.push.apply(rt,e)}function Bp(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var a=n[s],l=a.getSnapshot;a=a.value;try{if(!zt(l(),a))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Cn(e,t){for(t&=~pc,t&=~Ll,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-$t(t),s=1<<n;e[n]=-1,t&=~s}}function Vu(e){if(oe&6)throw Error(O(327));Tr();var t=Xa(e,0);if(!(t&1))return ot(e,_e()),null;var n=hl(e,t);if(e.tag!==0&&n===2){var s=Qo(e);s!==0&&(t=s,n=ji(e,s))}if(n===1)throw n=Ks,Xn(e,0),Cn(e,t),ot(e,_e()),n;if(n===6)throw Error(O(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Yn(e,rt,nn),ot(e,_e()),null}function yc(e,t){var n=oe;oe|=1;try{return e(t)}finally{oe=n,oe===0&&(zr=_e()+500,Tl&&Hn())}}function rr(e){En!==null&&En.tag===0&&!(oe&6)&&Tr();var t=oe;oe|=1;var n=Dt.transition,s=de;try{if(Dt.transition=null,de=1,e)return e()}finally{de=s,Dt.transition=n,oe=t,!(oe&6)&&Hn()}}function vc(){ht=Nr.current,pe(Nr)}function Xn(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,yp(n)),Te!==null)for(n=Te.return;n!==null;){var s=n;switch(Zi(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&tl();break;case 3:$r(),pe(at),pe(Ke),ic();break;case 5:oc(s);break;case 4:$r();break;case 13:pe(be);break;case 19:pe(be);break;case 10:rc(s.type._context);break;case 22:case 23:vc()}n=n.return}if($e=e,Te=e=Mn(e.current,null),Ue=ht=t,Le=0,Ks=null,pc=Ll=nr=0,rt=ws=null,Qn!==null){for(t=0;t<Qn.length;t++)if(n=Qn[t],s=n.interleaved,s!==null){n.interleaved=null;var a=s.next,l=n.pending;if(l!==null){var o=l.next;l.next=a,s.next=o}n.pending=s}Qn=null}return e}function yf(e,t){do{var n=Te;try{if(nc(),Ia.current=ul,cl){for(var s=je.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}cl=!1}if(tr=0,Ie=Re=je=null,vs=!1,Hs=0,xc.current=null,n===null||n.return===null){Le=1,Ks=t,Te=null;break}e:{var l=e,o=n.return,i=n,c=t;if(t=Ue,i.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,f=i,d=f.tag;if(!(f.mode&1)&&(d===0||d===11||d===15)){var y=f.alternate;y?(f.updateQueue=y.updateQueue,f.memoizedState=y.memoizedState,f.lanes=y.lanes):(f.updateQueue=null,f.memoizedState=null)}var g=Ru(o);if(g!==null){g.flags&=-257,Au(g,o,i,l,t),g.mode&1&&Fu(l,u,t),t=g,c=u;var b=t.updateQueue;if(b===null){var v=new Set;v.add(c),t.updateQueue=v}else b.add(c);break e}else{if(!(t&1)){Fu(l,u,t),bc();break e}c=Error(O(426))}}else if(ge&&i.mode&1){var S=Ru(o);if(S!==null){!(S.flags&65536)&&(S.flags|=256),Au(S,o,i,l,t),ec(Or(c,i));break e}}l=c=Or(c,i),Le!==4&&(Le=2),ws===null?ws=[l]:ws.push(l),l=o;do{switch(l.tag){case 3:l.flags|=65536,t&=-t,l.lanes|=t;var x=ef(l,c,t);ku(l,x);break e;case 1:i=c;var h=l.type,m=l.stateNode;if(!(l.flags&128)&&(typeof h.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Ln===null||!Ln.has(m)))){l.flags|=65536,t&=-t,l.lanes|=t;var k=tf(l,i,t);ku(l,k);break e}}l=l.return}while(l!==null)}wf(n)}catch(j){t=j,Te===n&&n!==null&&(Te=n=n.return);continue}break}while(!0)}function vf(){var e=dl.current;return dl.current=ul,e===null?ul:e}function bc(){(Le===0||Le===3||Le===2)&&(Le=4),$e===null||!(nr&268435455)&&!(Ll&268435455)||Cn($e,Ue)}function hl(e,t){var n=oe;oe|=2;var s=vf();($e!==e||Ue!==t)&&(nn=null,Xn(e,t));do try{Wp();break}catch(a){yf(e,a)}while(!0);if(nc(),oe=n,dl.current=s,Te!==null)throw Error(O(261));return $e=null,Ue=0,Le}function Wp(){for(;Te!==null;)bf(Te)}function Hp(){for(;Te!==null&&!xx();)bf(Te)}function bf(e){var t=Nf(e.alternate,e,ht);e.memoizedProps=e.pendingProps,t===null?wf(e):Te=t,xc.current=null}function wf(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Pp(n,t),n!==null){n.flags&=32767,Te=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Le=6,Te=null;return}}else if(n=Mp(n,t,ht),n!==null){Te=n;return}if(t=t.sibling,t!==null){Te=t;return}Te=t=e}while(t!==null);Le===0&&(Le=5)}function Yn(e,t,n){var s=de,a=Dt.transition;try{Dt.transition=null,de=1,Vp(e,t,n,s)}finally{Dt.transition=a,de=s}return null}function Vp(e,t,n,s){do Tr();while(En!==null);if(oe&6)throw Error(O(327));n=e.finishedWork;var a=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(O(177));e.callbackNode=null,e.callbackPriority=0;var l=n.lanes|n.childLanes;if(kx(e,l),e===$e&&(Te=$e=null,Ue=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Sa||(Sa=!0,Sf(Ga,function(){return Tr(),null})),l=(n.flags&15990)!==0,n.subtreeFlags&15990||l){l=Dt.transition,Dt.transition=null;var o=de;de=1;var i=oe;oe|=4,xc.current=null,Op(e,n),xf(n,e),dp(ei),qa=!!Zo,ei=Zo=null,e.current=n,zp(n),px(),oe=i,de=o,Dt.transition=l}else e.current=n;if(Sa&&(Sa=!1,En=e,fl=a),l=e.pendingLanes,l===0&&(Ln=null),vx(n.stateNode),ot(e,_e()),t!==null)for(s=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],s(a.value,{componentStack:a.stack,digest:a.digest});if(ml)throw ml=!1,e=bi,bi=null,e;return fl&1&&e.tag!==0&&Tr(),l=e.pendingLanes,l&1?e===wi?js++:(js=0,wi=e):js=0,Hn(),null}function Tr(){if(En!==null){var e=em(fl),t=Dt.transition,n=de;try{if(Dt.transition=null,de=16>e?16:e,En===null)var s=!1;else{if(e=En,En=null,fl=0,oe&6)throw Error(O(331));var a=oe;for(oe|=4,H=e.current;H!==null;){var l=H,o=l.child;if(H.flags&16){var i=l.deletions;if(i!==null){for(var c=0;c<i.length;c++){var u=i[c];for(H=u;H!==null;){var f=H;switch(f.tag){case 0:case 11:case 15:bs(8,f,l)}var d=f.child;if(d!==null)d.return=f,H=d;else for(;H!==null;){f=H;var y=f.sibling,g=f.return;if(mf(f),f===u){H=null;break}if(y!==null){y.return=g,H=y;break}H=g}}}var b=l.alternate;if(b!==null){var v=b.child;if(v!==null){b.child=null;do{var S=v.sibling;v.sibling=null,v=S}while(v!==null)}}H=l}}if(l.subtreeFlags&2064&&o!==null)o.return=l,H=o;else e:for(;H!==null;){if(l=H,l.flags&2048)switch(l.tag){case 0:case 11:case 15:bs(9,l,l.return)}var x=l.sibling;if(x!==null){x.return=l.return,H=x;break e}H=l.return}}var h=e.current;for(H=h;H!==null;){o=H;var m=o.child;if(o.subtreeFlags&2064&&m!==null)m.return=o,H=m;else e:for(o=h;H!==null;){if(i=H,i.flags&2048)try{switch(i.tag){case 0:case 11:case 15:Al(9,i)}}catch(j){ke(i,i.return,j)}if(i===o){H=null;break e}var k=i.sibling;if(k!==null){k.return=i.return,H=k;break e}H=i.return}}if(oe=a,Hn(),Xt&&typeof Xt.onPostCommitFiberRoot=="function")try{Xt.onPostCommitFiberRoot(kl,e)}catch{}s=!0}return s}finally{de=n,Dt.transition=t}}return!1}function Yu(e,t,n){t=Or(n,t),t=ef(e,t,1),e=An(e,t,1),t=Je(),e!==null&&(Zs(e,1,t),ot(e,t))}function ke(e,t,n){if(e.tag===3)Yu(e,e,n);else for(;t!==null;){if(t.tag===3){Yu(t,e,n);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Ln===null||!Ln.has(s))){e=Or(n,e),e=tf(t,e,1),t=An(t,e,1),e=Je(),t!==null&&(Zs(t,1,e),ot(t,e));break}}t=t.return}}function Yp(e,t,n){var s=e.pingCache;s!==null&&s.delete(t),t=Je(),e.pingedLanes|=e.suspendedLanes&n,$e===e&&(Ue&n)===n&&(Le===4||Le===3&&(Ue&130023424)===Ue&&500>_e()-gc?Xn(e,0):pc|=n),ot(e,t)}function jf(e,t){t===0&&(e.mode&1?(t=ha,ha<<=1,!(ha&130023424)&&(ha=4194304)):t=1);var n=Je();e=hn(e,t),e!==null&&(Zs(e,t,n),ot(e,n))}function Kp(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),jf(e,n)}function Qp(e,t){var n=0;switch(e.tag){case 13:var s=e.stateNode,a=e.memoizedState;a!==null&&(n=a.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(O(314))}s!==null&&s.delete(t),jf(e,n)}var Nf;Nf=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||at.current)st=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return st=!1,Ip(e,t,n);st=!!(e.flags&131072)}else st=!1,ge&&t.flags&1048576&&Cm(t,sl,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;Pa(e,t),e=t.pendingProps;var a=Ir(t,Ke.current);Dr(t,n),a=uc(null,t,s,e,a,n);var l=dc();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,lt(s)?(l=!0,nl(t)):l=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,ac(t),a.updater=Rl,t.stateNode=a,a._reactInternals=t,ci(t,s,e,n),t=mi(null,t,s,!0,l,n)):(t.tag=0,ge&&l&&Ji(t),Ge(null,t,a,n),t=t.child),t;case 16:s=t.elementType;e:{switch(Pa(e,t),e=t.pendingProps,a=s._init,s=a(s._payload),t.type=s,a=t.tag=Xp(s),e=Lt(s,e),a){case 0:t=di(null,t,s,e,n);break e;case 1:t=Mu(null,t,s,e,n);break e;case 11:t=Lu(null,t,s,e,n);break e;case 14:t=Iu(null,t,s,Lt(s.type,e),n);break e}throw Error(O(306,s,""))}return t;case 0:return s=t.type,a=t.pendingProps,a=t.elementType===s?a:Lt(s,a),di(e,t,s,a,n);case 1:return s=t.type,a=t.pendingProps,a=t.elementType===s?a:Lt(s,a),Mu(e,t,s,a,n);case 3:e:{if(af(t),e===null)throw Error(O(387));s=t.pendingProps,l=t.memoizedState,a=l.element,Rm(e,t),ol(t,s,null,n);var o=t.memoizedState;if(s=o.element,l.isDehydrated)if(l={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=l,t.memoizedState=l,t.flags&256){a=Or(Error(O(423)),t),t=Pu(e,t,s,n,a);break e}else if(s!==a){a=Or(Error(O(424)),t),t=Pu(e,t,s,n,a);break e}else for(pt=Rn(t.stateNode.containerInfo.firstChild),gt=t,ge=!0,Mt=null,n=Tm(t,null,s,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Mr(),s===a){t=xn(e,t,n);break e}Ge(e,t,s,n)}t=t.child}return t;case 5:return Am(t),e===null&&li(t),s=t.type,a=t.pendingProps,l=e!==null?e.memoizedProps:null,o=a.children,ti(s,a)?o=null:l!==null&&ti(s,l)&&(t.flags|=32),sf(e,t),Ge(e,t,o,n),t.child;case 6:return e===null&&li(t),null;case 13:return lf(e,t,n);case 4:return lc(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=Pr(t,null,s,n):Ge(e,t,s,n),t.child;case 11:return s=t.type,a=t.pendingProps,a=t.elementType===s?a:Lt(s,a),Lu(e,t,s,a,n);case 7:return Ge(e,t,t.pendingProps,n),t.child;case 8:return Ge(e,t,t.pendingProps.children,n),t.child;case 12:return Ge(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(s=t.type._context,a=t.pendingProps,l=t.memoizedProps,o=a.value,he(al,s._currentValue),s._currentValue=o,l!==null)if(zt(l.value,o)){if(l.children===a.children&&!at.current){t=xn(e,t,n);break e}}else for(l=t.child,l!==null&&(l.return=t);l!==null;){var i=l.dependencies;if(i!==null){o=l.child;for(var c=i.firstContext;c!==null;){if(c.context===s){if(l.tag===1){c=on(-1,n&-n),c.tag=2;var u=l.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?c.next=c:(c.next=f.next,f.next=c),u.pending=c}}l.lanes|=n,c=l.alternate,c!==null&&(c.lanes|=n),oi(l.return,n,t),i.lanes|=n;break}c=c.next}}else if(l.tag===10)o=l.type===t.type?null:l.child;else if(l.tag===18){if(o=l.return,o===null)throw Error(O(341));o.lanes|=n,i=o.alternate,i!==null&&(i.lanes|=n),oi(o,n,t),o=l.sibling}else o=l.child;if(o!==null)o.return=l;else for(o=l;o!==null;){if(o===t){o=null;break}if(l=o.sibling,l!==null){l.return=o.return,o=l;break}o=o.return}l=o}Ge(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,s=t.pendingProps.children,Dr(t,n),a=Tt(a),s=s(a),t.flags|=1,Ge(e,t,s,n),t.child;case 14:return s=t.type,a=Lt(s,t.pendingProps),a=Lt(s.type,a),Iu(e,t,s,a,n);case 15:return nf(e,t,t.type,t.pendingProps,n);case 17:return s=t.type,a=t.pendingProps,a=t.elementType===s?a:Lt(s,a),Pa(e,t),t.tag=1,lt(s)?(e=!0,nl(t)):e=!1,Dr(t,n),Zm(t,s,a),ci(t,s,a,n),mi(null,t,s,!0,e,n);case 19:return of(e,t,n);case 22:return rf(e,t,n)}throw Error(O(156,t.tag))};function Sf(e,t){return Xd(e,t)}function Gp(e,t,n,s){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Et(e,t,n,s){return new Gp(e,t,n,s)}function wc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Xp(e){if(typeof e=="function")return wc(e)?1:0;if(e!=null){if(e=e.$$typeof,e===zi)return 11;if(e===Ui)return 14}return 2}function Mn(e,t){var n=e.alternate;return n===null?(n=Et(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function za(e,t,n,s,a,l){var o=2;if(s=e,typeof e=="function")wc(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case fr:return qn(n.children,a,l,t);case Oi:o=8,a|=8;break;case Ao:return e=Et(12,n,t,a|2),e.elementType=Ao,e.lanes=l,e;case Lo:return e=Et(13,n,t,a),e.elementType=Lo,e.lanes=l,e;case Io:return e=Et(19,n,t,a),e.elementType=Io,e.lanes=l,e;case Ad:return Il(n,a,l,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Fd:o=10;break e;case Rd:o=9;break e;case zi:o=11;break e;case Ui:o=14;break e;case jn:o=16,s=null;break e}throw Error(O(130,e==null?e:typeof e,""))}return t=Et(o,n,t,a),t.elementType=e,t.type=s,t.lanes=l,t}function qn(e,t,n,s){return e=Et(7,e,s,t),e.lanes=n,e}function Il(e,t,n,s){return e=Et(22,e,s,t),e.elementType=Ad,e.lanes=n,e.stateNode={isHidden:!1},e}function jo(e,t,n){return e=Et(6,e,null,t),e.lanes=n,e}function No(e,t,n){return t=Et(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function qp(e,t,n,s,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=no(0),this.expirationTimes=no(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=no(0),this.identifierPrefix=s,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function jc(e,t,n,s,a,l,o,i,c){return e=new qp(e,t,n,i,c),t===1?(t=1,l===!0&&(t|=8)):t=0,l=Et(3,null,null,t),e.current=l,l.stateNode=e,l.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ac(l),e}function Jp(e,t,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:mr,key:s==null?null:""+s,children:e,containerInfo:t,implementation:n}}function kf(e){if(!e)return $n;e=e._reactInternals;e:{if(lr(e)!==e||e.tag!==1)throw Error(O(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(lt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(O(171))}if(e.tag===1){var n=e.type;if(lt(n))return Sm(e,n,t)}return t}function Cf(e,t,n,s,a,l,o,i,c){return e=jc(n,s,!0,e,a,l,o,i,c),e.context=kf(null),n=e.current,s=Je(),a=In(n),l=on(s,a),l.callback=t??null,An(n,l,a),e.current.lanes=a,Zs(e,a,s),ot(e,s),e}function Ml(e,t,n,s){var a=t.current,l=Je(),o=In(a);return n=kf(n),t.context===null?t.context=n:t.pendingContext=n,t=on(l,o),t.payload={element:e},s=s===void 0?null:s,s!==null&&(t.callback=s),e=An(a,t,o),e!==null&&(Ot(e,a,o,l),La(e,a,o)),o}function xl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Ku(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Nc(e,t){Ku(e,t),(e=e.alternate)&&Ku(e,t)}function Zp(){return null}var _f=typeof reportError=="function"?reportError:function(e){console.error(e)};function Sc(e){this._internalRoot=e}Pl.prototype.render=Sc.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(O(409));Ml(e,t,null,null)};Pl.prototype.unmount=Sc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;rr(function(){Ml(null,e,null,null)}),t[fn]=null}};function Pl(e){this._internalRoot=e}Pl.prototype.unstable_scheduleHydration=function(e){if(e){var t=rm();e={blockedOn:null,target:e,priority:t};for(var n=0;n<kn.length&&t!==0&&t<kn[n].priority;n++);kn.splice(n,0,e),n===0&&am(e)}};function kc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function $l(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Qu(){}function e0(e,t,n,s,a){if(a){if(typeof s=="function"){var l=s;s=function(){var u=xl(o);l.call(u)}}var o=Cf(t,s,e,0,null,!1,!1,"",Qu);return e._reactRootContainer=o,e[fn]=o.current,Os(e.nodeType===8?e.parentNode:e),rr(),o}for(;a=e.lastChild;)e.removeChild(a);if(typeof s=="function"){var i=s;s=function(){var u=xl(c);i.call(u)}}var c=jc(e,0,!1,null,null,!1,!1,"",Qu);return e._reactRootContainer=c,e[fn]=c.current,Os(e.nodeType===8?e.parentNode:e),rr(function(){Ml(t,c,n,s)}),c}function Ol(e,t,n,s,a){var l=n._reactRootContainer;if(l){var o=l;if(typeof a=="function"){var i=a;a=function(){var c=xl(o);i.call(c)}}Ml(t,o,e,a)}else o=e0(n,t,e,a,s);return xl(o)}tm=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ms(t.pendingLanes);n!==0&&(Hi(t,n|1),ot(t,_e()),!(oe&6)&&(zr=_e()+500,Hn()))}break;case 13:rr(function(){var s=hn(e,1);if(s!==null){var a=Je();Ot(s,e,1,a)}}),Nc(e,1)}};Vi=function(e){if(e.tag===13){var t=hn(e,134217728);if(t!==null){var n=Je();Ot(t,e,134217728,n)}Nc(e,134217728)}};nm=function(e){if(e.tag===13){var t=In(e),n=hn(e,t);if(n!==null){var s=Je();Ot(n,e,t,s)}Nc(e,t)}};rm=function(){return de};sm=function(e,t){var n=de;try{return de=e,t()}finally{de=n}};Vo=function(e,t,n){switch(t){case"input":if($o(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var s=n[t];if(s!==e&&s.form===e.form){var a=Dl(s);if(!a)throw Error(O(90));Id(s),$o(s,a)}}}break;case"textarea":Pd(e,n);break;case"select":t=n.value,t!=null&&kr(e,!!n.multiple,t,!1)}};Hd=yc;Vd=rr;var t0={usingClientEntryPoint:!1,Events:[ta,gr,Dl,Bd,Wd,yc]},os={findFiberByHostInstance:Kn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},n0={bundleType:os.bundleType,version:os.version,rendererPackageName:os.rendererPackageName,rendererConfig:os.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:pn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Qd(e),e===null?null:e.stateNode},findFiberByHostInstance:os.findFiberByHostInstance||Zp,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ka=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ka.isDisabled&&ka.supportsFiber)try{kl=ka.inject(n0),Xt=ka}catch{}}vt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=t0;vt.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!kc(t))throw Error(O(200));return Jp(e,t,null,n)};vt.createRoot=function(e,t){if(!kc(e))throw Error(O(299));var n=!1,s="",a=_f;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=jc(e,1,!1,null,null,n,!1,s,a),e[fn]=t.current,Os(e.nodeType===8?e.parentNode:e),new Sc(t)};vt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(O(188)):(e=Object.keys(e).join(","),Error(O(268,e)));return e=Qd(t),e=e===null?null:e.stateNode,e};vt.flushSync=function(e){return rr(e)};vt.hydrate=function(e,t,n){if(!$l(t))throw Error(O(200));return Ol(null,e,t,!0,n)};vt.hydrateRoot=function(e,t,n){if(!kc(e))throw Error(O(405));var s=n!=null&&n.hydratedSources||null,a=!1,l="",o=_f;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(l=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=Cf(t,null,e,1,n??null,a,!1,l,o),e[fn]=t.current,Os(e),s)for(e=0;e<s.length;e++)n=s[e],a=n._getVersion,a=a(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Pl(t)};vt.render=function(e,t,n){if(!$l(t))throw Error(O(200));return Ol(null,e,t,!1,n)};vt.unmountComponentAtNode=function(e){if(!$l(e))throw Error(O(40));return e._reactRootContainer?(rr(function(){Ol(null,null,e,!1,function(){e._reactRootContainer=null,e[fn]=null})}),!0):!1};vt.unstable_batchedUpdates=yc;vt.unstable_renderSubtreeIntoContainer=function(e,t,n,s){if(!$l(n))throw Error(O(200));if(e==null||e._reactInternals===void 0)throw Error(O(38));return Ol(e,t,n,!1,s)};vt.version="18.3.1-next-f1338f8080-20240426";function Ef(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ef)}catch(e){console.error(e)}}Ef(),_d.exports=vt;var Sr=_d.exports,Gu=Sr;Fo.createRoot=Gu.createRoot,Fo.hydrateRoot=Gu.hydrateRoot;const r0=()=>"https://admin-stage.dev.crm.seniorpomidornaya.ru/api",xt=r0(),Pt={SUCCESS:"success",ERROR:"error",INFO:"info"},re={LEADS:"leads",CLIENTS:"clients",FINANCES:"finances",CASH_DESKS:"cash_desks",WORKERS:"workers"},Ca={NAME:"name",POSITION:"position"},Df=["T-Bank","Sber","Alpha Bank","VTB","Raiffeisen","Газпромбанк","Россельхозбанк","Открытие","Почта Банк","МТС Банк"],Tf=["Собственник","СЕО","HR-менеджер","Разработчик","Продюссер","Бухгалтер","Диагност","CRM менеджер","СОО","Ассистент","Монтажер","Сценарист","СММ-специалист","Ревьюер","Методист","Семинарист","Лектор","Куратор"],me={ACTUAL:"actual",PLANNED:"planned",STATISTICS:"statistics"},ie={CREATED:"CREATED",DISTRIBUTION:"DISTRIBUTION",GIVE_ACCESS:"GIVE_ACCESS",IN_PROGRESS:"IN_PROGRESS",SEARCH_OFFER:"SEARCH_OFFER",ACCEPT_OFFER:"ACCEPT_OFFER",PAYING_OFFER:"PAYING_OFFER",FINISH:"FINISH"},Fr=["CREATED","DISTRIBUTION","GIVE_ACCESS"],Si=["IN_PROGRESS","SEARCH_OFFER","ACCEPT_OFFER","PAYING_OFFER","FINISH"],_t={[ie.CREATED]:"Создан",[ie.DISTRIBUTION]:"Распределение",[ie.GIVE_ACCESS]:"Выдача доступов",[ie.IN_PROGRESS]:"Обучается",[ie.SEARCH_OFFER]:"Ищет работу",[ie.ACCEPT_OFFER]:"Принимает оффер",[ie.PAYING_OFFER]:"Выплачивает процент",[ie.FINISH]:"Закончил обучение"},s0={[ie.CREATED]:"bg-blue-100 text-blue-800",[ie.DISTRIBUTION]:"bg-indigo-100 text-indigo-800",[ie.GIVE_ACCESS]:"bg-emerald-100 text-emerald-800",[ie.IN_PROGRESS]:"bg-yellow-100 text-yellow-800",[ie.SEARCH_OFFER]:"bg-orange-100 text-orange-800",[ie.ACCEPT_OFFER]:"bg-purple-100 text-purple-800",[ie.PAYING_OFFER]:"bg-red-100 text-red-800",[ie.FINISH]:"bg-green-100 text-green-800"},a0={[ie.CREATED]:_t[ie.CREATED],[ie.DISTRIBUTION]:_t[ie.DISTRIBUTION],[ie.GIVE_ACCESS]:_t[ie.GIVE_ACCESS]},l0={[ie.IN_PROGRESS]:_t[ie.IN_PROGRESS],[ie.SEARCH_OFFER]:_t[ie.SEARCH_OFFER],[ie.ACCEPT_OFFER]:_t[ie.ACCEPT_OFFER],[ie.PAYING_OFFER]:_t[ie.PAYING_OFFER],[ie.FINISH]:_t[ie.FINISH]},ft={ACTUAL:"actual",PLANNED:"planned"},sn={ADMIN:"admin",MANAGER:"manager",VIEWER:"viewer"},cn={ACCESS_TOKEN:"crm_access_token",REFRESH_TOKEN:"crm_refresh_token",USER:"crm_user"},ce={LEADS:"leads",CLIENTS:"clients",ALL:"all"};class o0{async login(t,n){const s=await fetch(`${xt}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:n})});if(!s.ok){const a=await s.json();throw new Error(a.error||"Ошибка входа")}return await s.json()}async register(t){const n=await fetch(`${xt}/auth/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok){const s=await n.json();throw new Error(s.error||"Ошибка регистрации")}return await n.json()}async refreshToken(t){const n=await fetch(`${xt}/auth/refresh`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:t})});if(!n.ok){const s=await n.json();throw new Error(s.error||"Ошибка обновления токена")}return await n.json()}async getProfile(t){const n=await fetch(`${xt}/auth/me`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}});if(!n.ok){const s=await n.json();throw new Error(s.error||"Ошибка получения профиля")}return await n.json()}async logout(t){try{const n=await fetch(`${xt}/auth/logout`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}});return n.ok||console.warn("Logout request failed, but continuing..."),await n.json()}catch(n){console.warn("Logout error:",n)}}}const is=new o0,Ua=(e,t)=>{localStorage.setItem(cn.ACCESS_TOKEN,e),localStorage.setItem(cn.REFRESH_TOKEN,t)},Rr=()=>localStorage.getItem(cn.ACCESS_TOKEN),Ff=()=>localStorage.getItem(cn.REFRESH_TOKEN),Ba=()=>{localStorage.removeItem(cn.ACCESS_TOKEN),localStorage.removeItem(cn.REFRESH_TOKEN),localStorage.removeItem(cn.USER)},So=e=>{localStorage.setItem(cn.USER,JSON.stringify(e))},i0=()=>{const e=localStorage.getItem(cn.USER);return e?JSON.parse(e):null},c0=e=>{if(!e)return!0;try{const t=JSON.parse(atob(e.split(".")[1])),n=Date.now()/1e3;return t.exp<n}catch{return!0}},u0=()=>{const[e,t]=p.useState(null),[n,s]=p.useState(!0),[a,l]=p.useState(!1),o=()=>{const g=Rr();return g?(console.log("Using existing token for auth header"),{Authorization:`Bearer ${g}`,"Content-Type":"application/json"}):(console.warn("No access token available"),{})};p.useEffect(()=>{(async()=>{try{const b=Rr(),v=Ff(),S=i0();if(!b||!v||!S){s(!1);return}if(c0(b))try{const x=await is.refreshToken(v);Ua(x.accessToken,v);const h=await is.getProfile(x.accessToken);t(h.user),So(h.user),l(!0)}catch(x){console.error("Token refresh failed:",x),Ba(),t(null),l(!1)}else t(S),l(!0)}catch(b){console.error("Auth initialization error:",b),Ba(),t(null),l(!1)}finally{s(!1)}})()},[]);const i=async(g,b)=>{s(!0);try{const v=await is.login(g,b),{user:S,accessToken:x,refreshToken:h}=v;return Ua(x,h),So(S),t(S),l(!0),{success:!0,user:S}}catch(v){return console.error("Login error:",v),{success:!1,error:v.message}}finally{s(!1)}},c=async g=>{s(!0);try{const b=await is.register(g),{user:v,accessToken:S,refreshToken:x}=b;return Ua(S,x),So(v),t(v),l(!0),{success:!0,user:v}}catch(b){return console.error("Registration error:",b),{success:!1,error:b.message}}finally{s(!1)}},u=async()=>{try{const g=Rr();g&&await is.logout(g)}catch(g){console.error("Logout error:",g)}finally{Ba(),t(null),l(!1)}},f=g=>e?Array.isArray(g)?g.includes(e.role):e.role===g:!1;return{user:e,loading:n,isAuthenticated:a,login:i,register:c,logout:u,hasRole:f,canDelete:()=>f(["admin","manager"]),isAdmin:()=>f("admin"),getAuthHeader:o}},Rf=p.createContext(),Rt=()=>{const e=p.useContext(Rf);if(!e)throw new Error("useAuthContext must be used within an AuthProvider");return e},d0=({children:e})=>{const t=u0();return r.jsx(Rf.Provider,{value:t,children:e})},m0=()=>{const[e,t]=p.useState({isVisible:!1,message:"",type:Pt.INFO}),n=(i,c=Pt.INFO)=>{t({isVisible:!0,message:i,type:c})};return{toast:e,showToast:n,hideToast:()=>{t(i=>({...i,isVisible:!1}))},showSuccess:i=>n(i,Pt.SUCCESS),showError:i=>n(i,Pt.ERROR),showInfo:i=>n(i,Pt.INFO)}};class f0{constructor(){this.isRefreshing=!1,this.failedQueue=[],this.requestCache=new Map}generateRequestKey(t,n){const s=n.method||"GET",a=n.body||"";return`${s}:${t}:${a}`}processQueue(t,n=null){this.failedQueue.forEach(({resolve:s,reject:a})=>{t?a(t):s(n)}),this.failedQueue=[]}async refreshAccessToken(){if(this.isRefreshing)return new Promise((t,n)=>{this.failedQueue.push({resolve:t,reject:n})});this.isRefreshing=!0;try{const t=Ff();if(!t)throw new Error("No refresh token available");const n=await fetch(`${xt}/auth/refresh`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:t})});if(!n.ok)throw new Error("Token refresh failed");const s=await n.json(),{accessToken:a}=s;return Ua(a,t),this.processQueue(null,a),a}catch(t){throw this.processQueue(t),Ba(),typeof window<"u"&&window.location.reload(),t}finally{this.isRefreshing=!1}}async request(t,n={}){const s=`${xt}${t}`;let a=Rr();const l=this.generateRequestKey(t,n);if(n.method==="POST"&&this.requestCache.has(l))return console.log("Duplicate POST request detected, returning cached promise"),this.requestCache.get(l);const o={headers:{"Content-Type":"application/json",...n.headers},...n};a&&(o.headers.Authorization=`Bearer ${a}`);const i=this.executeRequest(s,o);return n.method==="POST"&&(this.requestCache.set(l,i),setTimeout(()=>{this.requestCache.delete(l)},5e3)),i}async executeRequest(t,n){try{console.log(`Making request: ${n.method||"GET"} ${t}`);const s=await fetch(t,n);if(s.status===401||s.status===403)if(Rr()&&!this.isRefreshing)try{console.log("Token expired, refreshing...");const l=await this.refreshAccessToken();n.headers.Authorization=`Bearer ${l}`,console.log(`Retrying request with new token: ${n.method||"GET"} ${t}`);const o=await fetch(t,n);if(!o.ok){const i=await o.json();throw new Error(i.error||"Network error after token refresh")}return await o.json()}catch(l){throw console.error("Token refresh failed:",l),l}else{const l=await s.json();throw new Error(l.error||"Authentication required")}if(!s.ok){const a=await s.json();throw new Error(a.error||"Network error")}return await s.json()}catch(s){throw console.error("API Error:",s),s}}async get(t){return this.request(t,{headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}})}async getFresh(t){const n=Date.now(),s=t.includes("?")?"&":"?",a=`${t}${s}_t=${n}`;return this.request(a,{headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"}})}async post(t,n){return this.request(t,{method:"POST",body:JSON.stringify(n)})}async put(t,n){return this.request(t,{method:"PUT",body:JSON.stringify(n)})}async patch(t,n){return this.request(t,{method:"PATCH",body:JSON.stringify(n)})}async delete(t){return this.request(t,{method:"DELETE"})}clearCache(){this.requestCache.clear()}}const q=new f0,h0=Object.freeze(Object.defineProperty({__proto__:null,apiService:q},Symbol.toStringTag,{value:"Module"})),x0=()=>{const[e,t]=p.useState([]),[n,s]=p.useState(!1),[a,l]=p.useState(!1),o=p.useCallback(async(N={})=>{try{s(!0);const w=new URLSearchParams;N.search&&w.append("search",N.search),N.filter&&w.append("filter",N.filter),N.statusGroup&&w.append("status_group",N.statusGroup);const C=await q.get(`/clients?${w.toString()}`);t(C||[]),l(!0)}catch(w){throw console.error("Ошибка загрузки записей:",w),w}finally{s(!1)}},[]),i=p.useCallback(async(N,w="name",C=ce.ALL)=>{const _={};N!=null&&N.trim()&&(_.search=N.trim(),_.filter=w),C&&C!==ce.ALL&&(_.statusGroup=C),await o(_)},[o]),c=p.useCallback(async(N,w="name")=>{console.log("🎯 Поиск лидов:",{searchTerm:N,searchFilter:w}),await i(N,w,ce.LEADS)},[i]),u=p.useCallback(async(N,w="name")=>{console.log("👥 Поиск активных клиентов:",{searchTerm:N,searchFilter:w}),await i(N,w,ce.CLIENTS)},[i]),f=p.useCallback(async N=>{try{s(!0);const w={...N,name:N.fullName||N.name};w.fullName&&delete w.fullName,console.log("🔄 Создание клиента - отправляем в API:",w);const C=await q.post("/clients",w);return t(_=>[C,..._]),console.log("✅ Клиент создан успешно:",C),C}catch(w){throw console.error("❌ Ошибка создания клиента:",w),w}finally{s(!1)}},[]),d=p.useCallback(async(N,w)=>{try{s(!0);const C={...w,name:w.fullName||w.name};C.fullName&&delete C.fullName,console.log("🔄 Обновление клиента - отправляем в API:",{id:N,data:C});const _=await q.put(`/clients/${N}`,C);return t(E=>E.map(T=>T.id===N?{...T,..._}:T)),console.log("✅ Клиент обновлен успешно:",_),_}catch(C){throw console.error("❌ Ошибка обновления клиента:",C),C}finally{s(!1)}},[]),y=p.useCallback(async N=>{try{return s(!0),await q.delete(`/clients/${N}`),t(w=>w.filter(C=>C.id!==N)),!0}catch(w){throw console.error("Ошибка удаления клиента:",w),w}finally{s(!1)}},[]),g=p.useCallback(async N=>{try{return s(!0),await q.get(`/clients/${N}`)}catch(w){throw console.error("Ошибка загрузки клиента:",w),w}finally{s(!1)}},[]),b=p.useCallback((N=e)=>{const w={CREATED:[],DISTRIBUTION:[],GIVE_ACCESS:[],IN_PROGRESS:[],SEARCH_OFFER:[],ACCEPT_OFFER:[],PAYING_OFFER:[],FINISH:[]};return N.forEach(C=>{w[C.status]&&w[C.status].push(C)}),w},[e]),v=p.useCallback((N,w=e)=>{switch(N){case ce.LEADS:return w.filter(C=>["CREATED","DISTRIBUTION","GIVE_ACCESS"].includes(C.status));case ce.CLIENTS:return w.filter(C=>["IN_PROGRESS","SEARCH_OFFER","ACCEPT_OFFER","PAYING_OFFER","FINISH"].includes(C.status));case ce.ALL:default:return w}},[e]),S=p.useCallback(()=>{const N=v(ce.LEADS),w=v(ce.CLIENTS);return{total:e.length,leads:N.length,clients:w.length,byStatus:b()}},[e,v,b]),x=p.useCallback(async()=>{await o()},[o]),h=p.useCallback(async()=>{await c("")},[c]),m=p.useCallback(async()=>{await u("")},[u]),k=p.useCallback(()=>{t([]),l(!1)},[]),j=p.useCallback(async(N,w)=>{const C=e.find(E=>E.id===N);if(!C)throw new Error("Клиент не найден");const _={fullName:C.name,email:C.email,phone:C.phone,status:w};return await d(N,_)},[e,d]);return{clients:e,loading:n,showResults:a,fetchClients:o,searchClients:i,searchLeads:c,searchActiveClients:u,loadAllClients:x,loadLeads:h,loadActiveClients:m,createClient:f,updateClient:d,deleteClient:y,getClientById:g,updateClientStatus:j,groupClientsByStatus:b,filterClientsByGroup:v,getClientsStats:S,clearResults:k}},De={async getFinances(e={}){const t=new URLSearchParams;e.search&&t.append("search",e.search),e.status&&t.append("status",e.status),e.date_from&&t.append("date_from",e.date_from),e.date_to&&t.append("date_to",e.date_to),e.cash_desk_id&&t.append("cash_desk_id",e.cash_desk_id),e.client_search&&t.append("client_search",e.client_search),e.worker_search&&t.append("worker_search",e.worker_search),e.category&&t.append("category",e.category),e.description&&t.append("description",e.description);const n=t.toString(),s=n?`/finances?${n}`:"/finances";return console.log("🔍 Запрос финансовых операций с фильтрами:",e),q.get(s)},async getFinanceSummary(e={}){const t=new URLSearchParams;e.date_from&&t.append("date_from",e.date_from),e.date_to&&t.append("date_to",e.date_to);const n=t.toString(),s=n?`/finances/summary/stats?${n}`:"/finances/summary/stats";return console.log("📊 Запрос статистики финансов с фильтрами:",e),q.get(s)},async getClientFinances(e){return console.log("💸 Запрос операций для клиента:",e),q.get(`/finances/client/${e}`)},async createFinance(e){return console.log("💳 Создание новой финансовой операции:",e),q.post("/finances",e)},async createTransfer(e){return console.log("🔄 Создание transfer пары:",e),q.post("/finances/transfer",e)},async updateFinance(e,t){return console.log("🔄 Обновление финансовой операции:",{id:e,financeData:t}),q.put(`/finances/${e}`,t)},async deleteFinance(e){return console.log("🗑️ Удаление финансовой операции:",e),q.delete(`/finances/${e}`)},async getFinanceById(e){return console.log("📈 Запрос операции по ID:",e),q.get(`/finances/${e}`)},formatDateForAPI(e){if(!e)return null;if(typeof e=="string"){if(e.includes(".")){const[t,n,s]=e.split(".");return`${s}-${n.padStart(2,"0")}-${t.padStart(2,"0")}`}return e}return e instanceof Date?e.toISOString().split("T")[0]:null},getFirstDayOfCurrentMonth(){const e=new Date,t=new Date(e.getFullYear(),e.getMonth(),1);return this.formatDateForAPI(t)},getCurrentDate(){return this.formatDateForAPI(new Date)},async getFinancesForCurrentMonth(){const e=this.getFirstDayOfCurrentMonth(),t=this.getCurrentDate();return this.getFinances({date_from:e,date_to:t})},async getFinancesForLastWeek(){const e=new Date,t=new Date(e.getTime()-7*24*60*60*1e3);return this.getFinances({date_from:this.formatDateForAPI(t),date_to:this.formatDateForAPI(e)})},async getFinancesForLastMonth(){const e=new Date,t=new Date(e.getTime()-30*24*60*60*1e3);return this.getFinances({date_from:this.formatDateForAPI(t),date_to:this.formatDateForAPI(e)})},async getActualFinancesForPeriod(e,t){return this.getFinances({status:"actual",date_from:this.formatDateForAPI(e),date_to:this.formatDateForAPI(t)})},async getPlannedFinancesForPeriod(e,t){return this.getFinances({status:"planned",date_from:this.formatDateForAPI(e),date_to:this.formatDateForAPI(t)})},async getFinanceAnalytics(e={}){try{const{period:t=30,start_date:n,end_date:s}=e,a=new URLSearchParams;return a.append("period",t),n&&a.append("start_date",n),s&&a.append("end_date",s),await q.get(`/finances/analytics?${a}`)}catch(t){throw console.error("Ошибка получения финансовой аналитики:",t),t}}},Af=()=>{const[e,t]=p.useState([]),[n,s]=p.useState(!1),[a,l]=p.useState(null),[o,i]=p.useState(""),[c,u]=p.useState("actual"),[f,d]=p.useState(!1),[y,g]=p.useState({dateFrom:"",dateTo:"",type:"",category:"",client:"",worker:"",cashDesk:"",minAmount:"",maxAmount:""}),[b,v]=p.useState({dateFrom:"",dateTo:"",type:"",category:"",client:"",worker:"",cashDesk:"",minAmount:"",maxAmount:""}),[S,x]=p.useState({totalIncome:0,totalExpense:0,balance:0,operationsCount:0}),h=()=>c==="actual"?y:b,m=p.useCallback(async()=>{try{s(!0),l(null);const M=h(),B=await De.getFinances({...M,status:c,search:o});t(B),d(!0);const F=await De.getFinanceSummary(M);x(F)}catch(M){console.error("Ошибка загрузки операций:",M),l(M.message)}finally{s(!1)}},[c,o,y,b]),k=p.useCallback(async()=>{await m()},[m]),j=p.useCallback(async M=>{c==="actual"?g(M):v(M)},[c]),N=p.useCallback(async M=>{try{s(!0);const B=await De.createFinance(M);t(I=>[B,...I]);const F=h(),D=await De.getFinanceSummary(F);return x(D),B}catch(B){throw console.error("Ошибка создания операции:",B),B}finally{s(!1)}},[c,y,b]),w=p.useCallback(async M=>{try{s(!0);const B=await De.createTransfer(M);B&&B.data&&B.data.operations&&t(I=>[...B.data.operations,...I]);const F=h(),D=await De.getFinanceSummary(F);return x(D),B}catch(B){throw console.error("Ошибка создания transfer операции:",B),B}finally{s(!1)}},[h]),C=p.useCallback(async(M,B)=>{try{s(!0);const F=await De.updateFinance(M,B);t(P=>P.map($=>$.id===M?{...$,...F}:$));const D=h(),I=await De.getFinanceSummary(D);return x(I),F}catch(F){throw console.error("Ошибка обновления операции:",F),F}finally{s(!1)}},[c,y,b]),_=p.useCallback(async M=>{try{s(!0),await De.deleteFinance(M),t(D=>D.filter(I=>I.id!==M));const B=h(),F=await De.getFinanceSummary(B);return x(F),!0}catch(B){throw console.error("Ошибка удаления операции:",B),B}finally{s(!1)}},[c,y,b]),E=p.useCallback(async(M=null)=>{try{const B=M||h(),F=await De.exportToCSV({...B,status:c}),D=new Blob([F],{type:"text/csv;charset=utf-8;"}),I=document.createElement("a"),P=URL.createObjectURL(D);return I.setAttribute("href",P),I.setAttribute("download",`finances_${c}_${new Date().toISOString().split("T")[0]}.csv`),I.style.visibility="hidden",document.body.appendChild(I),I.click(),document.body.removeChild(I),!0}catch(B){throw console.error("Ошибка экспорта в CSV:",B),B}},[c,h]);p.useEffect(()=>{m()},[m]);const T=p.useCallback(M=>{u(M)},[]),L=p.useCallback(()=>{d(!1),i(""),g({dateFrom:"",dateTo:"",type:"",category:"",client:"",worker:"",cashDesk:"",minAmount:"",maxAmount:""}),v({dateFrom:"",dateTo:"",type:"",category:"",client:"",worker:"",cashDesk:"",minAmount:"",maxAmount:""})},[]),U=p.useCallback(async()=>{const M=new Date,B=new Date(M.getFullYear(),M.getMonth(),1),F=new Date(M.getFullYear(),M.getMonth()+1,0),D={dateFrom:B.toISOString().split("T")[0],dateTo:F.toISOString().split("T")[0],type:"",category:"",client:"",worker:"",cashDesk:"",minAmount:"",maxAmount:""};c==="actual"?g(D):v(D);try{s(!0),l(null);const I=await De.getFinances({...D,status:c,search:o});t(I),d(!0);const P=await De.getFinanceSummary(D);x(P)}catch(I){console.error("Ошибка загрузки операций:",I),l(I.message)}finally{s(!1)}},[c,o]),V=p.useCallback(async()=>{try{s(!0),l(null);const M=await De.getFinances({status:c,search:""});t(M),d(!0);const B=await De.getFinanceSummary({});x(B)}catch(M){console.error("Ошибка загрузки всех операций:",M),l(M.message)}finally{s(!1)}},[c]),Y=p.useCallback(async(M={})=>{try{return s(!0),l(null),await De.getFinanceAnalytics(M)}catch(B){throw console.error("Ошибка получения аналитики:",B),l(B.message),B}finally{s(!1)}},[]);return{finances:e,loading:n,error:a,financeSummary:S,showResults:f,status:c,searchTerm:o,actualFilters:y,plannedFilters:b,loadFinances:m,searchFinances:k,applyFilters:j,createFinance:N,createTransfer:w,updateFinance:C,deleteFinance:_,exportToCSV:E,handleStatusChange:T,clearResults:L,loadCurrentMonthFinances:U,loadAllFinances:V,getCurrentFilters:h,switchStatus:T,getAnalytics:Y,setSearchTerm:i,setStatus:u,setActualFilters:g,setPlannedFilters:v}},Cc=()=>{const[e,t]=p.useState([]),[n,s]=p.useState(!1),[a,l]=p.useState(!1),o=p.useCallback(async(S={})=>{try{s(!0);const x=new URLSearchParams;S.search&&x.append("search",S.search),S.active_only&&x.append("active_only","true");const h=x.toString(),m=h?`/cash-desks?${h}`:"/cash-desks",k=await q.getFresh(m);t(Array.isArray(k)?k:(k==null?void 0:k.data)||[]),l(!0)}catch(x){throw console.error("Ошибка загрузки касс:",x),x}finally{s(!1)}},[]),i=p.useCallback(async S=>{try{s(!0);const x=await q.get(`/cash-desks/${S}`);return(x==null?void 0:x.data)||x}catch(x){throw console.error("Ошибка загрузки кассы:",x),x}finally{s(!1)}},[]),c=p.useCallback(async S=>{try{s(!0);const x=await q.post("/cash-desks",S),h=(x==null?void 0:x.data)||x;return t(m=>[h,...m]),h}catch(x){throw console.error("Ошибка создания кассы:",x),x}finally{s(!1)}},[]),u=p.useCallback(async(S,x)=>{try{s(!0);const h=await q.put(`/cash-desks/${S}`,x),m=(h==null?void 0:h.data)||h;return t(k=>k.map(j=>j.id===S?m:j)),m}catch(h){throw console.error("Ошибка обновления кассы:",h),h}finally{s(!1)}},[]),f=p.useCallback(async S=>{try{return s(!0),await q.delete(`/cash-desks/${S}`),t(x=>x.filter(h=>h.id!==S)),!0}catch(x){throw console.error("Ошибка удаления кассы:",x),x}finally{s(!1)}},[]),d=p.useCallback(async(S,x={})=>{try{const h=new URLSearchParams;return x.limit&&h.append("limit",x.limit),x.offset&&h.append("offset",x.offset),x.status&&h.append("status",x.status),await q.get(`/cash-desks/${S}/transactions?${h.toString()}`)}catch(h){throw console.error("Ошибка загрузки операций кассы:",h),h}},[]),y=p.useCallback(async(S,x="30")=>{try{return await q.get(`/cash-desks/${S}/stats?period=${x}`)}catch(h){throw console.error("Ошибка загрузки статистики кассы:",h),h}},[]),g=p.useCallback(async(S,x={})=>{try{const h=new URLSearchParams;return x.period&&h.append("period",x.period),x.end_date&&h.append("end_date",x.end_date),await q.get(`/cash-desks/${S}/balance-history?${h.toString()}`)}catch(h){throw console.error("Ошибка загрузки истории баланса кассы:",h),h}},[]),b=p.useCallback(async(S,x="name")=>{const h={};S!=null&&S.trim()&&(h.search=S.trim()),x==="active"&&(h.active_only=!0),await o(h)},[o]),v=p.useCallback(()=>{t([]),l(!1)},[]);return{cashDesks:e,loading:n,showResults:a,fetchCashDesks:o,fetchCashDesk:i,createCashDesk:c,updateCashDesk:u,deleteCashDesk:f,fetchCashDeskTransactions:d,fetchCashDeskStats:y,fetchCashDeskBalanceHistory:g,searchCashDesks:b,clearResults:v}},p0=()=>{const[e,t]=p.useState([]),[n,s]=p.useState(!1),[a,l]=p.useState(null),o=p.useCallback(async(N={})=>{s(!0),l(null);try{const w=new URLSearchParams;N.search&&w.append("search",N.search),N.active_only!==void 0&&w.append("active_only",N.active_only);const C=`/workers${w.toString()?`?${w.toString()}`:""}`,_=await q.get(C);t(Array.isArray(_)?_:[]),console.log(`👥 Загружено работников: ${Array.isArray(_)?_.length:0}`)}catch(w){console.error("Ошибка при загрузке работников:",w),l(w.message),t([])}finally{s(!1)}},[]),i=p.useCallback(async N=>{s(!0),l(null);try{const w=await q.post("/workers",N);return t(C=>[w,...C]),console.log(`✅ Создан новый работник: ${w.full_name}`),w}catch(w){throw console.error("Ошибка при создании работника:",w),l(w.message),w}finally{s(!1)}},[]),c=p.useCallback(async(N,w)=>{s(!0),l(null);try{const C=await q.put(`/workers/${N}`,w);return t(_=>_.map(E=>E.id===N?C:E)),console.log(`✅ Обновлен работник: ${C.full_name}`),C}catch(C){throw console.error("Ошибка при обновлении работника:",C),l(C.message),C}finally{s(!1)}},[]),u=p.useCallback(async N=>{s(!0),l(null);try{await q.delete(`/workers/${N}`),t(w=>w.filter(C=>C.id!==N)),console.log(`🗑️ Удален работник с ID: ${N}`)}catch(w){throw console.error("Ошибка при удалении работника:",w),l(w.message),w}finally{s(!1)}},[]),f=p.useCallback(async N=>{s(!0),l(null);try{const w=await q.get(`/workers/${N}`);return console.log(`👤 Загружен работник: ${w.full_name}`),w}catch(w){throw console.error("Ошибка при загрузке работника:",w),l(w.message),w}finally{s(!1)}},[]),d=p.useCallback(async N=>{s(!0),l(null);try{const w=await q.get(`/workers/${N}/finances`);return console.log(`💰 Загружены финансы работника ${N}: ${w.length} операций`),w}catch(w){throw console.error("Ошибка при загрузке финансов работника:",w),l(w.message),w}finally{s(!1)}},[]),y=p.useCallback(async N=>{s(!0),l(null);try{const w=await q.get(`/workers/${N}/stats`);return console.log(`📊 Загружена статистика работника ${N}`),w}catch(w){throw console.error("Ошибка при загрузке статистики работника:",w),l(w.message),w}finally{s(!1)}},[]),g=p.useCallback(async(N,w=!1)=>{console.log(`🔍 Поиск работников: "${N}", только активные: ${w}`),await o({search:N,active_only:w})},[o]),b=p.useCallback(async(N="")=>{await g(N,!0)},[g]),v=p.useCallback(async(N="")=>{await g(N,!1)},[g]),S=p.useCallback((N,w=e)=>N?w.filter(C=>C.is_active):w,[e]),x=p.useCallback((N=e)=>{const w={};return N.forEach(C=>{const _=C.position||"Не указано";w[_]||(w[_]=[]),w[_].push(C)}),w},[e]),h=p.useCallback(()=>{const N=S(!0),w=S(!1).filter(C=>!C.is_active);return{total:e.length,active:N.length,inactive:w.length,byPosition:x()}},[e,S,x]),m=p.useCallback(async()=>{await o()},[o]),k=p.useCallback(async()=>{await b("")},[b]),j=p.useCallback(async(N,w)=>{const C={is_active:w,fire_date:w?null:new Date().toISOString().split("T")[0]};return await c(N,C)},[c]);return{workers:e,loading:n,error:a,fetchWorkers:o,createWorker:i,updateWorker:c,deleteWorker:u,fetchWorkerById:f,fetchWorkerFinances:d,fetchWorkerStats:y,searchWorkers:g,searchActiveWorkers:b,searchAllWorkers:v,filterWorkersByStatus:S,groupWorkersByPosition:x,getWorkersStats:h,loadAllWorkers:m,loadActiveWorkers:k,toggleWorkerStatus:j,clearError:()=>l(null)}};var g0={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const y0=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),v0=(e,t)=>{const n=p.forwardRef(({color:s="currentColor",size:a=24,strokeWidth:l=2,absoluteStrokeWidth:o,children:i,...c},u)=>p.createElement("svg",{ref:u,...g0,width:a,height:a,stroke:s,strokeWidth:o?Number(l)*24/Number(a):l,className:`lucide lucide-${y0(e)}`,...c},[...t.map(([f,d])=>p.createElement(f,d)),...(Array.isArray(i)?i:[i])||[]]));return n.displayName=`${e}`,n};var Q=v0;const b0=Q("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]),Ct=Q("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Lf=Q("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),w0=Q("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),j0=Q("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),N0=Q("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),Gt=Q("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),If=Q("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),S0=Q("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]),Ns=Q("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),it=Q("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),On=Q("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),Wa=Q("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),Mf=Q("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),Pf=Q("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),pl=Q("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Ha=Q("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),Qs=Q("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),Xe=Q("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),ki=Q("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),$f=Q("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]),_c=Q("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),ra=Q("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Ss=Q("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),or=Q("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),ko=Q("GraduationCap",[["path",{d:"M22 10v6M2 10l10-5 10 5-10 5z",key:"1ef52a"}],["path",{d:"M6 12v5c3 3 9 3 12 0v-5",key:"1f75yj"}]]),Pe=Q("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),k0=Q("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),C0=Q("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),zl=Q("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),_0=Q("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),zn=Q("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]),Ci=Q("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),E0=Q("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),Xu=Q("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]),ks=Q("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),Ec=Q("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]),Jn=Q("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),un=Q("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),D0=Q("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),Cs=Q("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),_i=Q("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),Of=Q("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),T0=Q("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}]]),F0=Q("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),R0=Q("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]),Ur=Q("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Yr=Q("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),Br=Q("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),sr=Q("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),Dc=Q("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),A0=Q("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),Ee=Q("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Jt=Q("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),dn=Q("Wallet",[["path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4",key:"195gfw"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5",key:"195n9w"}],["path",{d:"M18 12a2 2 0 0 0 0 4h4v-4Z",key:"vllfpd"}]]),gl=Q("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Fe=Q("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),L0=()=>{var l,o;const{user:e,logout:t}=Rt(),n=async()=>{confirm("Вы уверены, что хотите выйти?")&&await t()},s=i=>{switch(i){case sn.ADMIN:return r.jsx(T0,{className:"w-4 h-4 text-red-500"});case sn.MANAGER:return r.jsx(Ee,{className:"w-4 h-4 text-blue-500"});case sn.VIEWER:return r.jsx(ra,{className:"w-4 h-4 text-gray-500"});default:return r.jsx(Ee,{className:"w-4 h-4 text-gray-500"})}},a=i=>{switch(i){case sn.ADMIN:return"Администратор";case sn.MANAGER:return"Менеджер";case sn.VIEWER:return"Пользователь";default:return"Пользователь"}};return r.jsx("div",{className:"bg-white shadow-sm border-b",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:r.jsxs("div",{className:"flex justify-between items-center py-4",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center",children:r.jsx(Jt,{className:"w-5 h-5 text-white"})}),r.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"CRM Система"})]}),r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[s(e==null?void 0:e.role),r.jsxs("div",{className:"text-right",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:e==null?void 0:e.name}),r.jsx("div",{className:"text-xs text-gray-500",children:a(e==null?void 0:e.role)})]})]}),r.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:r.jsx("span",{className:"text-sm font-medium text-white",children:(o=(l=e==null?void 0:e.name)==null?void 0:l.charAt(0))==null?void 0:o.toUpperCase()})})]}),r.jsxs("button",{onClick:n,className:"flex items-center space-x-2 px-3 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",title:"Выйти из системы",children:[r.jsx(C0,{className:"w-4 h-4"}),r.jsx("span",{className:"hidden sm:inline",children:"Выйти"})]})]})]})})})},I0=({activeTab:e,onTabChange:t})=>r.jsx("div",{className:"mb-8",children:r.jsx("div",{className:"border-b border-gray-200",children:r.jsxs("nav",{className:"-mb-px flex space-x-8",children:[r.jsx("button",{onClick:()=>t(re.LEADS),className:`py-2 px-1 border-b-2 font-medium text-sm transition-colors ${e===re.LEADS?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Ur,{className:"w-4 h-4"}),r.jsx("span",{children:"Распределитель"})]})}),r.jsx("button",{onClick:()=>t(re.CLIENTS),className:`py-2 px-1 border-b-2 font-medium text-sm transition-colors ${e===re.CLIENTS?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Jt,{className:"w-4 h-4"}),r.jsx("span",{children:"Ученики"})]})}),r.jsx("button",{onClick:()=>t(re.FINANCES),className:`py-2 px-1 border-b-2 font-medium text-sm transition-colors ${e===re.FINANCES?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Xe,{className:"w-4 h-4"}),r.jsx("span",{children:"Финансы"})]})}),r.jsx("button",{onClick:()=>t(re.CASH_DESKS),className:`py-2 px-1 border-b-2 font-medium text-sm transition-colors ${e===re.CASH_DESKS?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(dn,{className:"w-4 h-4"}),r.jsx("span",{children:"Кассы"})]})}),r.jsx("button",{onClick:()=>t(re.WORKERS),className:`py-2 px-1 border-b-2 font-medium text-sm transition-colors ${e===re.WORKERS?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Dc,{className:"w-4 h-4"}),r.jsx("span",{children:"Работники"})]})})]})})}),M0=({searchTerm:e,searchFilter:t,onSearchTermChange:n,onSearchFilterChange:s,onSearch:a,loading:l=!1,placeholder:o="Поиск...",filters:i=[{value:"name",label:"По имени"},{value:"email",label:"По email"}]})=>{const[c,u]=p.useState(e),f=b=>{b.preventDefault(),n(c),a()},d=()=>{u(""),n("")},y=b=>{s(b),e.trim()&&a()};return r.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:r.jsxs("form",{onSubmit:f,className:"space-y-4",children:[r.jsxs("div",{className:"flex space-x-4",children:[r.jsxs("div",{className:"flex-1 relative",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:r.jsx(_i,{className:"h-5 w-5 text-gray-400"})}),r.jsx("input",{type:"text",value:c,onChange:b=>u(b.target.value),className:"block w-full pl-10 pr-12 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:o,disabled:l}),c&&r.jsx("button",{type:"button",onClick:d,className:"absolute inset-y-0 right-0 pr-3 flex items-center",disabled:l,children:r.jsx(Fe,{className:"h-4 w-4 text-gray-400 hover:text-gray-600"})})]}),r.jsx("div",{className:"w-48",children:r.jsx("select",{value:t,onChange:b=>y(b.target.value),className:"w-full py-2 px-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:l,children:i.map(b=>r.jsx("option",{value:b.value,children:b.label},b.value))})}),r.jsx("button",{type:"submit",disabled:l||!c.trim(),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2 transition-colors",children:l?r.jsxs(r.Fragment,{children:[r.jsx(Pe,{className:"w-4 h-4 animate-spin"}),r.jsx("span",{children:"Поиск..."})]}):r.jsxs(r.Fragment,{children:[r.jsx(_i,{className:"w-4 h-4"}),r.jsx("span",{children:"Найти"})]})})]}),r.jsx("div",{className:"text-sm text-gray-500",children:g()})]})});function g(){const b=i.find(S=>S.value===t),v=b?b.label.toLowerCase():"выбранному критерию";return t==="active"?'Поиск среди активных касс. Оставьте поле пустым и нажмите "Найти" чтобы показать все активные кассы.':`Поиск ${v}. Введите запрос и нажмите Enter или кнопку "Найти".`}},P0=({message:e,type:t,isVisible:n,onClose:s})=>{if(p.useEffect(()=>{if(n){const o=setTimeout(()=>{s()},3e3);return()=>clearTimeout(o)}},[n,s]),!n)return null;const a=()=>{const o="fixed top-4 right-4 z-50 px-6 py-4 rounded-lg shadow-lg flex items-center space-x-3 transform transition-all duration-300";switch(t){case Pt.SUCCESS:return`${o} bg-green-500 text-white`;case Pt.ERROR:return`${o} bg-red-500 text-white`;case Pt.INFO:return`${o} bg-blue-500 text-white`;default:return`${o} bg-gray-500 text-white`}},l=()=>{switch(t){case Pt.SUCCESS:return r.jsx(sr,{className:"w-5 h-5"});case Pt.ERROR:return r.jsx(Fe,{className:"w-5 h-5"});case Pt.INFO:return r.jsx(Ee,{className:"w-5 h-5"});default:return r.jsx(Ee,{className:"w-5 h-5"})}};return r.jsxs("div",{className:a(),children:[l(),r.jsx("span",{className:"font-medium",children:e}),r.jsx("button",{onClick:s,className:"ml-2 hover:bg-white hover:bg-opacity-20 rounded p-1 transition-colors",children:r.jsx(Fe,{className:"w-4 h-4"})})]})},$0=({onLogin:e,loading:t=!1})=>{const[n,s]=p.useState({email:"",password:""}),[a,l]=p.useState({}),[o,i]=p.useState(!1),c=(d,y)=>{s(g=>({...g,[d]:y})),a[d]&&l(g=>({...g,[d]:""}))},u=()=>{const d={};return n.email.trim()?/\S+@\S+\.\S+/.test(n.email)||(d.email="Некорректный email"):d.email="Введите email",n.password.trim()||(d.password="Введите пароль"),l(d),Object.keys(d).length===0},f=d=>{d.preventDefault(),u()&&e(n.email,n.password)};return r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:r.jsxs("div",{className:"max-w-md w-full space-y-8",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"mx-auto h-16 w-16 bg-blue-600 rounded-full flex items-center justify-center",children:r.jsx(Jt,{className:"h-8 w-8 text-white"})}),r.jsx("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:"Вход в CRM систему"}),r.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Введите свои данные для доступа"})]}),r.jsx("div",{className:"bg-white py-8 px-6 shadow-lg rounded-lg",children:r.jsxs("form",{onSubmit:f,className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email адрес"}),r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:r.jsx(zl,{className:"h-5 w-5 text-gray-400"})}),r.jsx("input",{type:"email",value:n.email,onChange:d=>c("email",d.target.value),placeholder:"example@company.com",className:`w-full pl-10 pr-3 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors ${a.email?"border-red-500":"border-gray-300"}`})]}),a.email&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.email})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Пароль"}),r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:r.jsx(k0,{className:"h-5 w-5 text-gray-400"})}),r.jsx("input",{type:o?"text":"password",value:n.password,onChange:d=>c("password",d.target.value),placeholder:"••••••••",className:`w-full pl-10 pr-12 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors ${a.password?"border-red-500":"border-gray-300"}`}),r.jsx("button",{type:"button",onClick:()=>i(!o),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:o?r.jsx(_c,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"}):r.jsx(ra,{className:"h-5 w-5 text-gray-400 hover:text-gray-600"})})]}),a.password&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.password})]}),r.jsx("button",{type:"submit",disabled:t,className:"w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:t?r.jsxs(r.Fragment,{children:[r.jsx(Pe,{className:"w-4 h-4 animate-spin mr-2"}),"Вход..."]}):"Войти"})]})}),r.jsx("div",{className:"text-center",children:r.jsx("p",{className:"text-xs text-gray-500",children:"Защищенная CRM система с авторизацией"})})]})})},O0=({children:e,requiredRoles:t=null})=>{const{user:n,loading:s,isAuthenticated:a,login:l,hasRole:o}=Rt();return s?r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx(Pe,{className:"w-12 h-12 mx-auto mb-4 text-blue-600 animate-spin"}),r.jsx("p",{className:"text-gray-600",children:"Проверка авторизации..."})]})}):a?t&&!o(t)?r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:r.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg text-center max-w-md",children:[r.jsx("div",{className:"text-red-500 text-6xl mb-4",children:"🚫"}),r.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Доступ запрещен"}),r.jsx("p",{className:"text-gray-600 mb-4",children:"У вас недостаточно прав для просмотра этой страницы."}),r.jsxs("div",{className:"text-sm text-gray-500",children:[r.jsxs("p",{children:["Ваша роль: ",r.jsx("span",{className:"font-semibold",children:n==null?void 0:n.role})]}),r.jsxs("p",{children:["Требуется: ",r.jsx("span",{className:"font-semibold",children:Array.isArray(t)?t.join(", "):t})]})]})]})}):e:r.jsx($0,{onLogin:l,loading:s})},z0=e=>Fr.includes(e),U0=e=>Si.includes(e),zf=e=>z0(e)?"lead":U0(e)?"client":"unknown",Uf=e=>{switch(zf(e)){case"lead":return"Лид";case"client":return"Клиент";default:return"Неизвестно"}},B0=e=>{switch(e){case ce.LEADS:return a0;case ce.CLIENTS:return l0;case ce.ALL:default:return _t}},W0=e=>{switch(e){case ce.LEADS:return Fr;case ce.CLIENTS:return Si;case ce.ALL:default:return[...Fr,...Si]}},Bf=e=>{switch(e){case ce.LEADS:return"CREATED";case ce.CLIENTS:return"IN_PROGRESS";case ce.ALL:default:return"CREATED"}},ue=({label:e,placeholder:t,value:n="",onChange:s,disabled:a=!1,error:l="",type:o="text"})=>{const[i,c]=p.useState(!1),u=y=>{a||s==null||s(y.target.value)},f=()=>{c(!0)},d=()=>{c(!1)};return r.jsxs("div",{className:"relative",children:[r.jsx("label",{className:"absolute -top-3 left-4 bg-white px-2 text-gray-500 z-10",style:{fontFamily:'"Noto Sans Devanagari", sans-serif',fontSize:"14px",fontWeight:"500",color:"#6B7280"},children:e}),r.jsx("input",{type:o,value:n,onChange:u,onFocus:f,onBlur:d,placeholder:t,disabled:a,className:`w-full border-2 bg-gray-50 rounded-xl px-4 outline-none transition-colors duration-200 ${l?"border-red-500 focus:border-red-600":i?"border-blue-600":"border-gray-300 hover:border-gray-400"} ${a?"opacity-50 cursor-not-allowed":""}`,style:{width:"400px",height:"56px",borderRadius:"12px",border:l?"2px solid #EF4444":i?"2px solid #3B82F6":"2px solid #E5E7EB",background:"#FDFDFD",fontSize:"16px",fontWeight:"400",fontFamily:'"Noto Sans Devanagari", sans-serif',color:"#1F2937",paddingLeft:"16px",paddingRight:"16px"}}),r.jsx("style",{children:`
        input::placeholder {
          color: #A4AEC1;
          font-family: "Noto Sans Devanagari", sans-serif;
          font-size: 16px;
          font-weight: 400;
          line-height: normal;
        }
      `}),l&&r.jsx("p",{className:"mt-2 text-red-600 px-4",style:{fontFamily:'"Noto Sans Devanagari", sans-serif',fontSize:"20px",fontWeight:"400"},children:l})]})},qe=({label:e,placeholder:t="Выберите опцию",value:n="",onChange:s,options:a=[],disabled:l=!1,error:o=""})=>{const[i,c]=p.useState(!1),u=p.useRef(null);p.useEffect(()=>{const b=v=>{u.current&&!u.current.contains(v.target)&&c(!1)};return document.addEventListener("mousedown",b),()=>{document.removeEventListener("mousedown",b)}},[]);const f=()=>{l||c(!i)},d=b=>{s==null||s(b.value),c(!1)},y=a.find(b=>b.value===n),g=y?y.label:t;return r.jsxs("div",{className:"relative",ref:u,children:[r.jsx("label",{className:"absolute -top-3 left-4 bg-white px-2 text-gray-500 z-20",style:{fontFamily:'"Noto Sans Devanagari", sans-serif',fontSize:"14px",fontWeight:"500",color:"#6B7280"},children:e}),r.jsxs("div",{className:`w-full border-2 bg-gray-50 rounded-full px-10 flex items-center justify-between cursor-pointer outline-none transition-colors duration-200 ${o?"border-red-500":i?"border-blue-600":"border-gray-300 hover:border-gray-400"} ${l?"opacity-50 cursor-not-allowed":""}`,style:{width:"400px",height:"56px",borderRadius:"12px",border:o?"2px solid #EF4444":i?"2px solid #3B82F6":"2px solid #E5E7EB",background:"#FDFDFD",paddingLeft:"16px",paddingRight:"16px"},onClick:f,children:[r.jsx("span",{className:y?"text-gray-900":"text-gray-400",style:{fontSize:"16px",fontWeight:"400",fontFamily:'"Noto Sans Devanagari", sans-serif'},children:g}),r.jsx("svg",{className:`w-5 h-5 text-gray-500 transition-transform duration-300 ${i?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),i&&!l&&r.jsx("div",{className:"absolute top-full left-0 mt-2 w-full bg-white border-2 border-gray-300 rounded-2xl shadow-lg z-30 max-h-60 overflow-y-auto",style:{borderRadius:"12px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)"},children:a.length===0?r.jsx("div",{className:"px-4 py-8 text-gray-500 text-center",style:{fontSize:"16px",fontWeight:"400",fontFamily:'"Noto Sans Devanagari", sans-serif'},children:"Нет доступных опций"}):a.map((b,v)=>r.jsx("div",{className:"px-4 py-3 hover:bg-gray-50 active:bg-gray-100 cursor-pointer transition-colors border-b border-gray-100 last:border-b-0",onClick:()=>d(b),style:{fontSize:"16px",fontWeight:"400",fontFamily:'"Noto Sans Devanagari", sans-serif'},children:b.label},b.value||v))}),o&&r.jsx("p",{className:"mt-2 text-red-600 px-4",style:{fontFamily:'"Noto Sans Devanagari", sans-serif',fontSize:"14px",fontWeight:"400"},children:o})]})},Ul=({state:e="inactive",onClick:t,text:n="Добавить",loadingText:s="Загрузка...",successText:a="Успешно!",errorText:l="Повторить",disabled:o=!1})=>{const i=()=>{o||e==="inactive"||e==="loading"||t==null||t()},c=()=>{switch(e){case"active":return"bg-orange-400 text-white shadow-orange-200 hover:bg-orange-500 hover:shadow-orange-300 hover:transform hover:-translate-y-1 active:translate-y-0";case"error":return"bg-red-600 text-white shadow-red-200 hover:bg-red-700 hover:shadow-red-300 hover:transform hover:-translate-y-1 active:translate-y-0";case"success":return"bg-green-600 text-white shadow-green-200 hover:bg-green-700 hover:shadow-green-300 hover:transform hover:-translate-y-1 active:translate-y-0";case"loading":return"bg-gray-400 text-white cursor-wait";default:return"bg-gray-300 text-gray-500 cursor-not-allowed"}},u=()=>{switch(e){case"loading":return s;case"success":return a;case"error":return l;default:return n}};return r.jsxs("button",{onClick:i,disabled:o||e==="inactive"||e==="loading",className:`${c()} rounded-3xl transition-all duration-300 flex items-center justify-center shadow-lg focus:outline-none focus:ring-4 focus:ring-opacity-50`,style:{width:"176px",height:"48px",borderRadius:"12px",fontSize:"16px",fontWeight:"500",fontFamily:'"Noto Sans Devanagari", sans-serif'},children:[e==="loading"&&r.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-8 w-8 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[r.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),r.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),u()]})},Bl=({onClick:e,text:t="Отменить",disabled:n=!1})=>{const s=()=>{n||e==null||e()};return r.jsx("button",{onClick:s,disabled:n,className:`bg-white text-gray-500 border-2 border-gray-300 rounded-3xl transition-all duration-200 flex items-center justify-center focus:outline-none focus:ring-4 focus:ring-gray-200 focus:ring-opacity-50 ${n?"opacity-50 cursor-not-allowed":"hover:border-gray-400 hover:text-gray-600 hover:bg-gray-50 active:transform active:translate-y-1"}`,style:{width:"176px",height:"48px",borderRadius:"12px",border:"2px solid #E5E7EB",fontSize:"16px",fontWeight:"400",fontFamily:'"Noto Sans Devanagari", sans-serif',color:"#838791"},children:t})},Wf=({isOpen:e,onClose:t,onApplyFilters:n,clients:s=[],initialFilters:a={}})=>{const[l,o]=p.useState({name:"",nameFilter:"any",telegram:"",telegramFilter:"any",phone:"",phoneFilter:"any",flow:"",direction:"",group:"",status:""}),[i,c]=p.useState("inactive");p.useEffect(()=>{e&&o({...l,...a})},[e,a]),p.useEffect(()=>{const v=Object.entries(l).some(([S,x])=>S.endsWith("Filter")?x!=="any":x&&x.trim()!=="");c(v?"active":"inactive")},[l]);const u=(v,S)=>{o(x=>({...x,[v]:S}))},f=()=>{n(l),t()},d=()=>{const v={name:"",nameFilter:"any",telegram:"",telegramFilter:"any",phone:"",phoneFilter:"any",flow:"",direction:"",group:"",status:""};o(v),n(v),t()},y=()=>{t()},g=v=>{const S=new Set;return s.forEach(x=>{var m;let h;v==="status"?h=x.status:h=(m=x.data)==null?void 0:m[v],h&&h.trim()!==""&&S.add(h)}),Array.from(S).sort()},b=Object.entries(_t).map(([v,S])=>({value:v,label:S}));return e?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-3xl shadow-xl w-full max-w-md max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(or,{className:"w-6 h-6 text-blue-600"}),r.jsx("h2",{className:"text-2xl font-semibold text-gray-800",style:{fontFamily:'"Noto Sans Devanagari", sans-serif'},children:"Фильтры"})]}),r.jsx("button",{onClick:y,className:"text-gray-400 hover:text-gray-600 transition-colors p-2",children:r.jsx(Fe,{className:"w-6 h-6"})})]}),r.jsxs("div",{className:"p-8 space-y-6",children:[r.jsx("div",{className:"space-y-3",children:r.jsx(ue,{label:"ФИО",placeholder:"Введите ФИО",value:l.name,onChange:v=>u("name",v)})}),r.jsx("div",{className:"space-y-3",children:r.jsx(ue,{label:"Телеграм",placeholder:"Введите Telegram",value:l.telegram,onChange:v=>u("telegram",v)})}),r.jsx("div",{className:"space-y-3",children:r.jsx(ue,{label:"Номер телефона",placeholder:"Введите номер телефона",value:l.phone,onChange:v=>u("phone",v)})}),r.jsx(qe,{label:"Поток",value:l.flow,onChange:v=>u("flow",v),options:g("flow").map(v=>({value:v,label:v})),placeholder:"Выберите поток"}),r.jsx(qe,{label:"Направление",value:l.direction,onChange:v=>u("direction",v),options:g("direction").map(v=>({value:v,label:v})),placeholder:"Выберите направление"}),r.jsx(qe,{label:"Группа",value:l.group,onChange:v=>u("group",v),options:g("group").map(v=>({value:v,label:v})),placeholder:"Выберите группу"}),r.jsx(qe,{label:"Статус",value:l.status,onChange:v=>u("status",v),options:b,placeholder:"Выберите статус"}),r.jsxs("div",{className:"flex justify-center gap-12 pt-4",children:[r.jsx(Bl,{onClick:d,text:"Сбросить"}),r.jsx(Ul,{state:i,onClick:f,text:"Применить",loadingText:"Применение...",successText:"Применено!",errorText:"Ошибка"})]})]})]})}):null},H0=({clients:e=[],loading:t=!1,showResults:n=!0,onAddClient:s,onEditClient:a,onDeleteClient:l,onClientCardOpen:o,statusGroup:i=ce.ALL})=>{const{canDelete:c}=Rt(),[u,f]=p.useState(1),[d,y]=p.useState(20),[g,b]=p.useState(!1),[v,S]=p.useState({name:"",nameFilter:"any",telegram:"",telegramFilter:"any",phone:"",phoneFilter:"any",flow:"",direction:"",group:"",status:""}),x=p.useMemo(()=>e.filter(A=>{var K,J,te;return!(v.name.trim()&&!(A.name&&A.name.toLowerCase().includes(v.name.toLowerCase()))||v.nameFilter==="filled"&&(!A.name||!A.name.trim())||v.nameFilter==="empty"&&A.name&&A.name.trim()||v.telegram.trim()&&!(A.telegram&&A.telegram.toLowerCase().includes(v.telegram.toLowerCase()))||v.telegramFilter==="filled"&&(!A.telegram||!A.telegram.trim())||v.telegramFilter==="empty"&&A.telegram&&A.telegram.trim()||v.phone.trim()&&!(A.phone&&A.phone.includes(v.phone))||v.phoneFilter==="filled"&&(!A.phone||!A.phone.trim())||v.phoneFilter==="empty"&&A.phone&&A.phone.trim()||v.flow&&((K=A.data)==null?void 0:K.flow)!==v.flow||v.direction&&((J=A.data)==null?void 0:J.direction)!==v.direction||v.group&&((te=A.data)==null?void 0:te.group)!==v.group||v.status&&A.status!==v.status)}),[e,v]),m=(()=>{switch(i){case ce.LEADS:return{title:"Список лидов",addButtonText:"Добавить лида",icon:Ur,emptyMessage:"Лидов пока нет. Добавьте первого лида!",noResultsMessage:"Лиды не найдены"};case ce.CLIENTS:return{title:"Список клиентов",addButtonText:"Добавить клиента",icon:Jt,emptyMessage:"Клиентов пока нет. Добавьте первого клиента!",noResultsMessage:"Клиенты не найдены"};default:return{title:"Список записей",addButtonText:"Добавить запись",icon:Jt,emptyMessage:"Записей пока нет. Добавьте первую запись!",noResultsMessage:"Записи не найдены"}}})(),k=m.icon,j=x.length,N=Math.ceil(j/d),w=(u-1)*d,C=w+d,_=x.slice(w,C),E=A=>{f(A)},T=A=>{y(A),f(1)},L=()=>{const K=[],J=[];for(let te=Math.max(2,u-2);te<=Math.min(N-1,u+2);te++)K.push(te);return u-2>2?J.push(1,"..."):J.push(1),J.push(...K),u+2<N-1?J.push("...",N):N>1&&J.push(N),J};p.useState(()=>{u>N&&N>0&&f(1)},[x.length,d]);const U=()=>{b(!0)},V=()=>{b(!1)},Y=A=>{S(A),f(1)},M=async(A,K)=>{A.stopPropagation();const J=Uf(K.status);console.log(`🗑️ ClientsTable.handleDelete вызван с ${J.toLowerCase()}:`,K),l&&await l(K.id)},B=(A,K)=>{A.stopPropagation(),a&&a(K)},F=A=>{window.open(`/client/${A.id}`,"_blank")},D=A=>_t[A]||A,I=A=>s0[A]||"bg-gray-100 text-gray-800",P=A=>{var K,J,te;return{flow:((K=A.data)==null?void 0:K.flow)||"—",direction:((J=A.data)==null?void 0:J.direction)||"—",group:((te=A.data)==null?void 0:te.group)||"—"}},$=A=>{switch(A){case"QA":return"bg-blue-100 text-blue-800";case"AQA":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-500"}};return r.jsxs("div",{className:"bg-white rounded-lg shadow-sm",children:[r.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(k,{className:"w-5 h-5 text-gray-600"}),r.jsx("h2",{className:"text-lg font-medium text-gray-900",children:m.title}),n&&j>0&&r.jsxs("span",{className:"text-sm text-gray-500",children:["(",j," ",j===1?"запись":j<5?"записи":"записей",")"]})]}),r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsxs("button",{onClick:U,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 flex items-center space-x-2 transition-colors",children:[r.jsx(or,{className:"w-4 h-4"}),r.jsx("span",{})]}),r.jsxs("button",{onClick:s,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center space-x-2 transition-colors",children:[r.jsx(un,{className:"w-4 h-4"}),r.jsx("span",{children:m.addButtonText})]})]})]}),t?r.jsxs("div",{className:"p-12 text-center text-gray-500",children:[r.jsx(Pe,{className:"w-12 h-12 mx-auto mb-4 text-gray-300 animate-spin"}),r.jsx("p",{children:"Загрузка..."})]}):x.length===0?r.jsxs("div",{className:"p-12 text-center text-gray-500",children:[r.jsx(k,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),r.jsx("p",{className:"text-lg font-medium text-gray-900 mb-2",children:e.length===0?m.emptyMessage:m.noResultsMessage}),e.length===0&&r.jsxs("p",{className:"text-sm",children:['Используйте кнопку "',m.addButtonText,'" для добавления первой записи.']}),e.length>0&&x.length===0&&r.jsx("p",{className:"text-sm",children:"Попробуйте изменить параметры фильтрации."})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"px-6 py-3 bg-gray-50 border-b border-gray-200 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsx("span",{className:"text-sm text-gray-600",children:"Показывать по:"}),r.jsx("div",{className:"flex space-x-1",children:[10,20,40].map(A=>r.jsx("button",{onClick:()=>T(A),className:`px-3 py-1 text-sm rounded transition-colors ${d===A?"bg-blue-100 text-blue-700 font-medium":"text-gray-600 hover:bg-gray-100"}`,children:A},A))})]}),r.jsxs("div",{className:"text-sm text-gray-600",children:["Показано ",w+1,"-",Math.min(C,j)," из ",j]})]}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx(Ee,{className:"w-4 h-4"}),r.jsx("span",{children:"Имя"})]})}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx(Ci,{className:"w-4 h-4"}),r.jsx("span",{children:"Телеграм"})]})}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:r.jsx("div",{className:"flex items-center space-x-1",children:r.jsx("span",{children:"Телефон"})})}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx(j0,{className:"w-4 h-4"}),r.jsx("span",{children:"Поток"})]})}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx(If,{className:"w-4 h-4"}),r.jsx("span",{children:"Направление"})]})}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx(Jt,{className:"w-4 h-4"}),r.jsx("span",{children:"Группа"})]})}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Статус"}),r.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Действия"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:_.map(A=>{const K=P(A);return r.jsxs("tr",{onClick:()=>F(A),className:"hover:bg-gray-50 cursor-pointer transition-colors",children:[r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:A.name}),r.jsxs("div",{className:"text-xs text-gray-500",children:["ID: ",A.id]})]}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm text-blue-800",children:A.telegram?`${A.telegram}`:"—"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm text-gray-900",children:A.phone||"—"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm text-gray-900",children:K.flow})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:K.direction!=="—"?r.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${$(K.direction)}`,children:K.direction}):r.jsx("span",{className:"text-sm text-gray-500",children:"—"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm text-gray-900",children:K.group})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${I(A.status)}`,children:D(A.status)})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:r.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[r.jsx("button",{onClick:J=>B(J,A),className:"text-blue-600 hover:text-blue-900 transition-colors",title:"Редактировать",children:"Изменить"}),c&&r.jsx("button",{onClick:J=>M(J,A),className:"text-red-600 hover:text-red-900 transition-colors",title:"Удалить",children:"Удалить"})]})})]},A.id)})})]})}),N>1&&r.jsxs("div",{className:"px-6 py-4 flex items-center justify-between border-t border-gray-200",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("button",{onClick:()=>E(u-1),disabled:u===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:r.jsx(Mf,{className:"h-5 w-5"})}),r.jsx("div",{className:"hidden md:flex",children:L().map((A,K)=>A==="..."?r.jsx("span",{className:"relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700",children:"..."},`dots-${K}`):r.jsx("button",{onClick:()=>E(A),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${u===A?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:A},A))}),r.jsx("button",{onClick:()=>E(u+1),disabled:u===N,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:r.jsx(Pf,{className:"h-5 w-5"})})]}),r.jsxs("div",{className:"text-sm text-gray-700",children:["Страница ",u," из ",N]})]})]}),r.jsx(Wf,{isOpen:g,onClose:V,onApplyFilters:Y,clients:e,initialFilters:v})]})},V0=(e,t=[],n=[],s=[])=>{var v;const{type:a,client_id:l,cash_desk_id:o,worker_id:i,category:c,client_name:u,cash_desk_name:f,worker_name:d}=e;let y=t.find(S=>S.id===l),g=n.find(S=>S.id===o),b=s.find(S=>S.id===i);if(!y&&l&&u&&(y={id:l,name:u}),!g&&o&&f&&(g={id:o,name:f}),!b&&i&&d&&(b={id:i,name:d}),a==="income")return{sender:y?{type:"client",id:y.id,name:y.name||y.fullName,icon:"User"}:null,recipient:g?{type:"cash_desk",id:g.id,name:g.name,icon:"Wallet"}:null};if(a==="expense"){const S=c==="Перевод между кассами",x=c==="Зарплата";if(S){let h=null;if(e.description&&e.description.includes("→")){const m=(v=e.description.split("→")[1])==null?void 0:v.trim();m&&(h={type:"cash_desk",id:null,name:m,icon:"Wallet"})}return{sender:g?{type:"cash_desk",id:g.id,name:g.name,icon:"Wallet"}:null,recipient:h||{type:"cash_desk",id:null,name:"Другая касса",icon:"Wallet"}}}return x?{sender:g?{type:"cash_desk",id:g.id,name:g.name,icon:"Wallet"}:null,recipient:b?{type:"worker",id:b.id,name:b.name,icon:"Users"}:null}:{sender:g?{type:"cash_desk",id:g.id,name:g.name,icon:"Wallet"}:null,recipient:y?{type:"client",id:y.id,name:y.name||y.fullName,icon:"User"}:{type:"external",id:null,name:c||"Внешний получатель",icon:"Building"}}}return{sender:null,recipient:null}},Y0=e=>({User:"👤",Wallet:"💳",Users:"👥",Building:"🏢"})[e]||"❓",K0=e=>({client:"text-blue-600 bg-blue-50",cash_desk:"text-green-600 bg-green-50",worker:"text-purple-600 bg-purple-50",external:"text-gray-600 bg-gray-50"})[e]||"text-gray-600 bg-gray-50",Q0=e=>({client:"Клиент",cash_desk:"Касса",worker:"Сотрудник",external:"Внешний"})[e]||"Неизвестно",G0=(e,t=[])=>{console.log("🔄 Группировка переводов:",{totalFinances:e.length,cashDesksCount:t.length});const n=e.filter(c=>(c.category==="Перевод между касс"||c.category==="Перевод между кассами")&&c.transfer_pair_id);console.log("💸 Найдено переводов:",n.length);const s=new Set,a=[],l=t.reduce((c,u)=>(c[u.id]=u,c),{});n.forEach(c=>{if(s.has(c.id))return;const u=n.find(f=>f.id===c.transfer_pair_id&&f.transfer_pair_id===c.id);if(u){console.log("👥 Найдена пара переводов:",{id1:c.id,amount1:c.amount,cashDesk1:c.cash_desk_id,id2:u.id,amount2:u.amount,cashDesk2:u.cash_desk_id});const f=Number(c.amount)<0,d=f?c:u,y=f?u:c;let g=l[d.cash_desk_id],b=l[y.cash_desk_id];!g&&d.cash_desk_name&&(g={id:d.cash_desk_id,name:d.cash_desk_name}),!b&&y.cash_desk_name&&(b={id:y.cash_desk_id,name:y.cash_desk_name}),console.log("🏦 Информация о кассах:",{fromCashDesk:(g==null?void 0:g.name)||"НЕ НАЙДЕНА",toCashDesk:(b==null?void 0:b.name)||"НЕ НАЙДЕНА"});const v={id:`transfer_${Math.min(c.id,u.id)}_${Math.max(c.id,u.id)}`,type:"transfer",category:"Перевод между касс",amount:Math.abs(Number(d.amount)),date:d.date,status:d.status,description:`Перевод ${Math.abs(Number(d.amount)).toLocaleString("ru-RU")} ₽ из ${(g==null?void 0:g.name)||"Касса"} в ${(b==null?void 0:b.name)||"Касса"}`,from_cash_desk_id:d.cash_desk_id,to_cash_desk_id:y.cash_desk_id,from_cash_desk:g,to_cash_desk:b,original_payments:[d,y],is_grouped_transfer:!0};a.push(v),s.add(c.id),s.add(u.id)}});const i=[...e.filter(c=>!((c.category==="Перевод между касс"||c.category==="Перевод между кассами")&&c.transfer_pair_id&&s.has(c.id))),...a].sort((c,u)=>{const f=new Date(c.date),d=new Date(u.date);if(f.getTime()!==d.getTime())return d-f;if(c.created_at&&u.created_at)return new Date(u.created_at)-new Date(c.created_at);const y=typeof c.id=="string"?parseInt(c.id.split("_")[1]||"0"):c.id;return(typeof u.id=="string"?parseInt(u.id.split("_")[1]||"0"):u.id)-y});return console.log("✅ Результат группировки:",{исходныхОпераций:e.length,найденоПереводов:n.length,сгруппированныхПереводов:a.length,итоговыхОпераций:i.length}),i},X0=e=>{var t,n,s,a;return{sender:{type:"cash_desk",id:((t=e.from_cash_desk)==null?void 0:t.id)||e.from_cash_desk_id,name:((n=e.from_cash_desk)==null?void 0:n.name)||`Касса #${e.from_cash_desk_id}`,icon:"Wallet"},recipient:{type:"cash_desk",id:((s=e.to_cash_desk)==null?void 0:s.id)||e.to_cash_desk_id,name:((a=e.to_cash_desk)==null?void 0:a.name)||`Касса #${e.to_cash_desk_id}`,icon:"Wallet"}}},qu=({participant:e,showIcon:t=!0})=>e?r.jsxs("div",{className:"flex items-center space-x-2",children:[t&&r.jsx("span",{className:"text-lg",title:e.type,children:Y0(e.icon)}),r.jsxs("div",{children:[r.jsx("div",{className:"font-medium text-gray-900 truncate",children:e.name}),r.jsx("div",{className:`text-xs px-2 py-0.5 rounded-full inline-block ${K0(e.type)}`,children:Q0(e.type)})]})]}):r.jsx("span",{className:"text-gray-400 italic",children:"Не указан"}),q0=({activeSubTab:e,onSubTabChange:t,actualCount:n=0,plannedCount:s=0})=>r.jsx("div",{className:"mb-6",children:r.jsx("div",{className:"border-b border-gray-200",children:r.jsxs("nav",{className:"-mb-px flex space-x-8",children:[r.jsx("button",{onClick:()=>t(me.ACTUAL),className:`py-3 px-1 border-b-2 font-medium text-sm transition-colors ${e===me.ACTUAL?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(On,{className:"w-4 h-4"}),r.jsx("span",{children:"Факт"}),n>0&&r.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${e===me.ACTUAL?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600"}`,children:n})]})}),r.jsx("button",{onClick:()=>t(me.PLANNED),className:`py-3 px-1 border-b-2 font-medium text-sm transition-colors ${e===me.PLANNED?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(pl,{className:"w-4 h-4"}),r.jsx("span",{children:"План"}),s>0&&r.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${e===me.PLANNED?"bg-orange-100 text-orange-600":"bg-gray-100 text-gray-600"}`,children:s})]})}),r.jsx("button",{onClick:()=>t(me.STATISTICS),className:`py-3 px-1 border-b-2 font-medium text-sm transition-colors ${e===me.STATISTICS?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Gt,{className:"w-4 h-4"}),r.jsx("span",{children:"Статистика"})]})})]})})}),J0=()=>{const[e,t]=p.useState(!1),[n,s]=p.useState(null),a=p.useCallback((i,c)=>{if(!i||!c)throw new Error('Даты "от" и "до" обязательны');const u=new Date(i),f=new Date(c);if(u>f)throw new Error('Дата "от" не может быть больше даты "до"');const d=365*24*60*60*1e3;if(f-u>d)throw new Error("Максимальный период выписки - 1 год");const y=new Date;if(y.setHours(23,59,59,999),f>y)throw new Error('Дата "до" не может быть в будущем');return!0},[]),l=p.useCallback(async(i,c)=>{try{t(!0),s(null),a(i,c);const u=De.formatDateForAPI(i),f=De.formatDateForAPI(c),d=Rr();if(!d)throw new Error("Необходима авторизация для генерации выписки");const y=await fetch(`undefined/finances/statement?date_from=${u}&date_to=${f}`,{method:"GET",headers:{Authorization:`Bearer ${d}`,Accept:"text/csv"}});if(!y.ok){let m=`HTTP error! status: ${y.status}`;try{m=(await y.json()).error||m}catch{}throw new Error(m)}const g=y.headers.get("Content-Disposition");let b="statement.csv";if(g){const m=g.match(/filename="(.+)"/);m&&(b=m[1])}const v=await y.text(),S=new Blob([v],{type:"text/csv;charset=utf-8;"}),x=document.createElement("a"),h=URL.createObjectURL(S);return x.setAttribute("href",h),x.setAttribute("download",b),x.style.visibility="hidden",document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(h),console.log("📋 Выписка успешно скачана:",b),{success:!0,filename:b,dateFrom:u,dateTo:f}}catch(u){console.error("❌ Ошибка при генерации выписки:",u);const f=u.message||"Неизвестная ошибка при генерации выписки";throw s(f),u}finally{t(!1)}},[a]),o=p.useCallback(()=>{s(null)},[]);return{isLoading:e,error:n,generateStatement:l,clearError:o,validateDates:a}},Z0=({isOpen:e,onClose:t,onError:n})=>{const[s,a]=p.useState(""),[l,o]=p.useState(""),[i,c]=p.useState({}),{isLoading:u,error:f,generateStatement:d,clearError:y,validateDates:g}=J0();p.useEffect(()=>{e&&(a(""),o(""),c({}),y())},[e,y]);const b=()=>{const j={};if(s||(j.dateFrom='Дата "от" обязательна'),l||(j.dateTo='Дата "до" обязательна'),s&&l)try{g(s,l)}catch(N){j.dateRange=N.message}return c(j),Object.keys(j).length===0},v=j=>{const N=j.target.value;a(N),N&&(!l||new Date(N)>new Date(l))&&o(N),(i.dateFrom||i.dateRange)&&c(w=>({...w,dateFrom:void 0,dateRange:void 0}))},S=j=>{const N=j.target.value;o(N),(i.dateTo||i.dateRange)&&c(w=>({...w,dateTo:void 0,dateRange:void 0}))},x=async()=>{if(b())try{await d(s,l),h()}catch(j){n==null||n(j.message||"Ошибка при генерации выписки")}},h=()=>{u||(a(""),o(""),c({}),y(),t==null||t())},m=()=>{if(!s||!l)return"";const j=new Date(s),N=new Date(l),w=`${j.getDate().toString().padStart(2,"0")}.${(j.getMonth()+1).toString().padStart(2,"0")}`,C=`${N.getDate().toString().padStart(2,"0")}.${(N.getMonth()+1).toString().padStart(2,"0")}`;return`statement_${w}_${C}.csv`};if(!e)return null;const k=Object.keys(i).length>0||f;return r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:[r.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:r.jsx(ki,{className:"w-5 h-5 text-blue-600"})}),r.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Генерация выписки"})]}),r.jsx("button",{onClick:h,disabled:u,className:"text-gray-400 hover:text-gray-600 transition-colors disabled:opacity-50",children:r.jsx(Fe,{className:"w-5 h-5"})})]}),r.jsxs("div",{className:"p-6 space-y-4",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Выберите период для выписки"}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Дата от *"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:"date",value:s,onChange:v,disabled:u,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all disabled:opacity-50 disabled:cursor-not-allowed ${i.dateFrom?"border-red-500":"border-gray-300"}`}),r.jsx(it,{className:"absolute right-3 top-2.5 w-4 h-4 text-gray-400 pointer-events-none"})]}),i.dateFrom&&r.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[r.jsx(Ct,{className:"w-4 h-4 mr-1"}),i.dateFrom]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Дата до *"}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:"date",value:l,onChange:S,disabled:u,min:s,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all disabled:opacity-50 disabled:cursor-not-allowed ${i.dateTo?"border-red-500":"border-gray-300"}`}),r.jsx(it,{className:"absolute right-3 top-2.5 w-4 h-4 text-gray-400 pointer-events-none"})]}),i.dateTo&&r.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[r.jsx(Ct,{className:"w-4 h-4 mr-1"}),i.dateTo]})]}),i.dateRange&&r.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:r.jsxs("p",{className:"text-sm text-red-800 flex items-center",children:[r.jsx(Ct,{className:"w-4 h-4 mr-2"}),i.dateRange]})}),f&&r.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:r.jsxs("p",{className:"text-sm text-red-800 flex items-center",children:[r.jsx(Ct,{className:"w-4 h-4 mr-2"}),f]})})]}),r.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[r.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-2",children:"Что будет включено в выписку:"}),r.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[r.jsx("li",{children:"• Только фактические операции (actual)"}),r.jsx("li",{children:"• Доходы и расходы за выбранный период"}),r.jsx("li",{children:"• Переводы между кассами"}),r.jsx("li",{children:"• Расчетный баланс касс"})]}),m()&&r.jsx("div",{className:"mt-3 pt-3 border-t border-blue-200",children:r.jsxs("p",{className:"text-xs text-blue-600",children:[r.jsx("strong",{children:"Имя файла:"})," ",m()]})})]})]}),r.jsxs("div",{className:"flex justify-end space-x-3 px-6 py-4 border-t border-gray-200",children:[r.jsx("button",{onClick:h,disabled:u,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Отмена"}),r.jsx("button",{onClick:x,disabled:u||k||!s||!l,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:u?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),r.jsx("span",{children:"Генерация..."})]}):r.jsxs(r.Fragment,{children:[r.jsx(ki,{className:"w-4 h-4"}),r.jsx("span",{children:"Скачать выписку"})]})})]})]})})},eg=({onApplyFilter:e,loading:t=!1,initialDateFrom:n=null,initialDateTo:s=null})=>{const[a,l]=p.useState(""),[o,i]=p.useState(""),[c,u]=p.useState(!1),[f,d]=p.useState(!1),[y,g]=p.useState(new Date),[b,v]=p.useState(!0),S=p.useRef(null),x=p.useRef(null),h=()=>{const L=new Date,U=new Date(L.getFullYear(),L.getMonth(),1),V=new Date(L.getFullYear(),L.getMonth()+1,0);return{firstDay:m(U),lastDay:m(V)}};p.useEffect(()=>{if(!f){if(n&&s)l(m(n)),i(m(s));else{const{firstDay:L,lastDay:U}=h();l(L),i(U),setTimeout(()=>{e({date_from:L,date_to:U})},100)}d(!0)}},[n,s,f,e]);const m=L=>{if(!L)return"";if(typeof L=="string"){if(L.includes(".")){const[U,V,Y]=L.split(".");return`${Y}-${V.padStart(2,"0")}-${U.padStart(2,"0")}`}return L.includes("-"),L}if(L instanceof Date){const U=L.getFullYear(),V=String(L.getMonth()+1).padStart(2,"0"),Y=String(L.getDate()).padStart(2,"0");return`${U}-${V}-${Y}`}return""},k=L=>{if(!L)return"";const U=new Date(L);if(isNaN(U.getTime()))return"";const V=U.getDate().toString().padStart(2,"0"),Y=(U.getMonth()+1).toString().padStart(2,"0"),M=U.getFullYear();return`${V}.${Y}.${M}`};p.useEffect(()=>{const L=U=>{S.current&&!S.current.contains(U.target)&&x.current&&!x.current.contains(U.target)&&(u(!1),v(!0))};return document.addEventListener("mousedown",L),()=>document.removeEventListener("mousedown",L)},[]);const j=L=>{if(console.log("📅 Выбрана дата:",L,"Выбираем начало:",b),b)l(L),i(""),v(!1);else{const U=new Date(a);new Date(L)>=U?i(L):(l(L),i(a)),u(!1),v(!0)}},N=()=>{u(!c),v(!0)},w=(L,U)=>{U.stopPropagation();const V=new Date(y);V.setMonth(V.getMonth()+L),g(V)},C=()=>{if(a&&o){const L=new Date(a),U=new Date(o);if(L>U){alert('Дата "от" не может быть больше даты "до"');return}}console.log("📅 Применяем фильтр по датам:",{dateFrom:a,dateTo:o}),e({date_from:a,date_to:o})},_=()=>{const{firstDay:L,lastDay:U}=h();l(L),i(U),g(new Date),e({date_from:L,date_to:U})},E=()=>{const L=y.getFullYear(),U=y.getMonth(),V=new Date(L,U,1),Y=new Date(L,U+1,0),M=(V.getDay()+6)%7,B=[],F=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],D=new Date(L,U-1,0);for(let P=M;P>0;P--){const $=new Date(L,U-1,D.getDate()-P+1);B.push({date:$,isCurrentMonth:!1,day:$.getDate()})}for(let P=1;P<=Y.getDate();P++){const $=new Date(L,U,P);B.push({date:$,isCurrentMonth:!0,day:P})}const I=42-B.length;for(let P=1;P<=I;P++){const $=new Date(L,U+1,P);B.push({date:$,isCurrentMonth:!1,day:$.getDate()})}return r.jsxs("div",{className:"p-4 w-80",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("button",{type:"button",onClick:P=>w(-1,P),className:"p-1 hover:bg-gray-100 rounded focus:outline-none",tabIndex:-1,children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),r.jsxs("h3",{className:"text-sm font-medium",children:[F[U]," ",L]}),r.jsx("button",{type:"button",onClick:P=>w(1,P),className:"p-1 hover:bg-gray-100 rounded focus:outline-none",tabIndex:-1,children:r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),r.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["Пн","Вт","Ср","Чт","Пт","Сб","Вс"].map(P=>r.jsx("div",{className:"text-xs text-gray-500 text-center p-2 font-medium",children:P},P))}),r.jsx("div",{className:"grid grid-cols-7 gap-1",children:B.map((P,$)=>{const A=m(P.date),K=A===a,J=A===o,te=a&&o&&A>=a&&A<=o,fe=A===m(new Date);return r.jsx("button",{type:"button",onClick:Ce=>{Ce.stopPropagation(),j(A)},className:`p-2 text-xs rounded hover:bg-blue-50 transition-colors focus:outline-none ${P.isCurrentMonth?K||J?"bg-blue-600 text-white hover:bg-blue-700":te?"bg-blue-100 text-blue-900 hover:bg-blue-200":fe?"bg-gray-200 text-gray-900 font-medium":"text-gray-700 hover:bg-gray-100":"text-gray-400 hover:bg-gray-50"}`,tabIndex:-1,children:P.day},$)})}),r.jsx("div",{className:"mt-4 text-xs text-gray-500 text-center",children:b?"Выберите дату начала периода":"Выберите дату окончания периода"}),a&&o&&r.jsxs("div",{className:"mt-2 text-xs text-center p-2 bg-blue-50 rounded",children:[r.jsx("strong",{children:"Выбран период:"}),r.jsx("br",{}),k(a)," - ",k(o)]})]})},T=()=>!a&&!o?"Выберите период":a&&!o?`От ${k(a)}`:a&&o?a===o?k(a):`${k(a)} - ${k(o)}`:"Выберите период";return r.jsxs("div",{className:"flex flex-wrap items-end gap-4",children:[r.jsxs("div",{className:"relative",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Период:"}),r.jsxs("button",{ref:x,type:"button",onClick:N,className:"flex items-center gap-2 px-3 py-2 border border-gray-300 rounded-lg bg-white hover:bg-gray-50 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 min-w-[200px]",children:[r.jsx(it,{className:"w-4 h-4 text-gray-500"}),r.jsx("span",{className:"text-sm font-medium",children:T()}),r.jsx("svg",{className:"w-4 h-4 text-gray-400 ml-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),c&&r.jsx("div",{ref:S,className:"absolute top-full left-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-20",onClick:L=>L.stopPropagation(),children:E()})]}),r.jsx("button",{type:"button",onClick:C,disabled:t,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors font-medium text-sm flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:t?r.jsxs(r.Fragment,{children:[r.jsx("svg",{className:"w-4 h-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Загрузка..."]}):r.jsxs(r.Fragment,{children:[r.jsx(or,{className:"w-4 h-4"}),"Применить"]})}),r.jsxs("button",{type:"button",onClick:_,disabled:t,className:"px-3 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors font-medium text-sm flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[r.jsx(D0,{className:"w-4 h-4"}),"Сбросить"]})]})},tg=({isOpen:e,onClose:t,onApplyFilters:n,finances:s=[],cashDesks:a=[],clients:l=[],workers:o=[],initialFilters:i={}})=>{const[c,u]=p.useState({date_from:"",date_to:"",cash_desk_id:"",client_search:"",worker_search:"",category:"",description:""}),[f,d]=p.useState("inactive"),[y,g]=p.useState([]),[b,v]=p.useState(!1);p.useEffect(()=>{e&&u({...c,...i})},[e,i]),p.useEffect(()=>{const _=Object.entries(c).some(([E,T])=>T&&T.trim()!=="");d(_?"active":"inactive")},[c]),p.useEffect(()=>{(async()=>{if(e&&!(a&&a.length>0))try{v(!0);const E=await q.get("/cash-desks"),T=(E==null?void 0:E.data)||E||[];g(Array.isArray(T)?T:[])}catch(E){console.error("Не удалось загрузить кассы для фильтров:",E)}finally{v(!1)}})()},[e,a]);const S=(_,E)=>{u(T=>({...T,[_]:E}))},x=_=>{u(E=>({...E,date_from:_.date_from||"",date_to:_.date_to||""}))},h=()=>{n(c),t()},m=()=>{const _={date_from:"",date_to:"",cash_desk_id:"",client_search:"",worker_search:"",category:"",description:""};u(_),n(_),t()},k=()=>{t()},j=()=>{const _=new Set;return s.forEach(E=>{E.category&&E.category.trim()!==""&&_.add(E.category)}),Array.from(_).sort()},N=a&&a.length>0?a:y,w=N&&N.length>0?N.map(_=>({value:_.id!=null?_.id.toString():"",label:_.name||""})):(()=>{const _=new Map;return s.forEach(E=>{const T=E.cash_desk_id,L=E.cash_desk_name;T!=null&&L&&!_.has(T)&&_.set(T,{value:T.toString(),label:L})}),Array.from(_.values())})();if(e)try{console.debug("FinanceFilterModal cashDeskOptions:",w)}catch{}const C=j().map(_=>({value:_,label:_}));return e?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-3xl shadow-xl w-full max-w-md max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(or,{className:"w-6 h-6 text-blue-600"}),r.jsx("h2",{className:"text-2xl font-semibold text-gray-800",style:{fontFamily:'"Noto Sans Devanagari", sans-serif'},children:"Фильтры финансов"})]}),r.jsx("button",{onClick:k,className:"text-gray-400 hover:text-gray-600 transition-colors p-2",children:r.jsx(Fe,{className:"w-6 h-6"})})]}),r.jsxs("div",{className:"p-8 space-y-6",children:[r.jsxs("div",{className:"space-y-3",children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Период"}),r.jsx(eg,{onApplyFilter:x,initialDateFrom:c.date_from,initialDateTo:c.date_to,loading:!1})]}),r.jsx(qe,{label:"Касса",value:c.cash_desk_id,onChange:_=>S("cash_desk_id",_),options:w,placeholder:"Выберите кассу"}),r.jsx(ue,{label:"Клиент",placeholder:"ФИО, email, телефон, телеграм",value:c.client_search,onChange:_=>S("client_search",_)}),r.jsx(ue,{label:"Работник",placeholder:"ФИО, должность, телефон, телеграм",value:c.worker_search,onChange:_=>S("worker_search",_)}),r.jsx(qe,{label:"Категория",value:c.category,onChange:_=>S("category",_),options:C,placeholder:"Выберите категорию"}),r.jsx(ue,{label:"Описание",placeholder:"Поиск по описанию операции",value:c.description,onChange:_=>S("description",_)}),r.jsxs("div",{className:"flex justify-center gap-12 pt-4",children:[r.jsx(Bl,{onClick:m,text:"Сбросить"}),r.jsx(Ul,{state:f,onClick:h,text:"Применить",loadingText:"Применение...",successText:"Применено!",errorText:"Ошибка"})]})]})]})}):null},ng=()=>{const{getAnalytics:e,loading:t}=Af(),[n,s]=p.useState(null),[a,l]=p.useState(30),[o,i]=p.useState(null),c=[{value:7,label:"7 дней"},{value:14,label:"14 дней"},{value:30,label:"30 дней"},{value:60,label:"60 дней"},{value:90,label:"90 дней"},{value:180,label:"180 дней"},{value:365,label:"365 дней"}],u=g=>Math.abs(Number(g)).toLocaleString("ru-RU")+" ₽",f=g=>{const b=Number(g);return b>0?"text-green-600":b<0?"text-red-600":"text-gray-600"},d=async g=>{try{i(null);const b=await e({period:g});s(b)}catch(b){i(b.message)}};p.useEffect(()=>{d(a)},[a]);const y=g=>{l(g)};return t?r.jsxs("div",{className:"p-12 text-center text-gray-500",children:[r.jsx(Pe,{className:"w-12 h-12 mx-auto mb-4 text-gray-300 animate-spin"}),r.jsx("p",{children:"Загрузка аналитики..."})]}):o?r.jsxs("div",{className:"p-8 text-center text-red-500",children:[r.jsx("p",{className:"text-lg font-medium mb-2",children:"Ошибка загрузки аналитики"}),r.jsx("p",{className:"text-sm",children:o})]}):n?r.jsxs("div",{className:"p-8",children:[r.jsxs("div",{className:"mb-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Финансовая аналитика"}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(it,{className:"w-4 h-4 text-gray-500"}),r.jsx("span",{className:"text-sm text-gray-600",children:"Период:"})]})]}),r.jsx("div",{className:"flex flex-wrap gap-2",children:c.map(g=>r.jsx("button",{onClick:()=>y(g.value),className:`px-3 py-2 text-sm font-medium rounded-lg transition-colors ${a===g.value?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:g.label},g.value))}),r.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:[n.start_date," - ",n.end_date]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[r.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-6 border border-green-200",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h4",{className:"text-lg font-semibold text-green-900",children:"Доходы"}),r.jsx(sr,{className:"w-6 h-6 text-green-600"})]}),r.jsx("div",{className:"text-2xl font-bold text-green-900",children:u(n.metrics.total_income)}),r.jsxs("div",{className:"text-sm text-green-700 mt-2",children:[n.metrics.total_operations," операций"]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-red-100 rounded-lg p-6 border border-red-200",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h4",{className:"text-lg font-semibold text-red-900",children:"Расходы"}),r.jsx(Br,{className:"w-6 h-6 text-red-600"})]}),r.jsx("div",{className:"text-2xl font-bold text-red-900",children:u(n.metrics.total_expense)}),r.jsxs("div",{className:"text-sm text-red-700 mt-2",children:[n.metrics.total_operations," операций"]})]}),r.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-6 border border-blue-200",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h4",{className:"text-lg font-semibold text-blue-900",children:"Прибыль"}),r.jsx(Xe,{className:"w-6 h-6 text-blue-600"})]}),r.jsx("div",{className:`text-2xl font-bold ${f(n.metrics.profit)}`,children:u(n.metrics.profit)}),r.jsx("div",{className:"text-sm text-blue-700 mt-2",children:"EBITDA"})]}),r.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg p-6 border border-purple-200",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h4",{className:"text-lg font-semibold text-purple-900",children:"Рентабельность"}),r.jsx(Gt,{className:"w-6 h-6 text-purple-600"})]}),r.jsx("div",{className:"text-2xl font-bold text-purple-900",children:n.metrics.profit_margin?`${n.metrics.profit_margin}%`:"N/A"}),r.jsxs("div",{className:"text-sm text-purple-700 mt-2",children:["Доход/Расход: ",n.metrics.income_expense_ratio||"N/A"]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Доходы по категориям"}),Object.keys(n.categories.income).length>0?r.jsx("div",{className:"space-y-3",children:Object.entries(n.categories.income).map(([g,b])=>r.jsxs("div",{className:"flex justify-between items-center p-3 bg-green-50 rounded-lg",children:[r.jsxs("div",{children:[r.jsx("div",{className:"font-medium text-green-900",children:g}),r.jsxs("div",{className:"text-sm text-green-700",children:[b.operations_count," операций"]})]}),r.jsx("div",{className:"text-lg font-bold text-green-900",children:u(b.amount)})]},g))}):r.jsxs("div",{className:"text-center py-8 text-gray-500",children:[r.jsx(sr,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),r.jsx("p",{children:"Нет доходов за выбранный период"})]})]}),r.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Расходы по категориям"}),Object.keys(n.categories.expense).length>0?r.jsx("div",{className:"space-y-3",children:Object.entries(n.categories.expense).map(([g,b])=>r.jsxs("div",{className:"flex justify-between items-center p-3 bg-red-50 rounded-lg",children:[r.jsxs("div",{children:[r.jsx("div",{className:"font-medium text-red-900",children:g}),r.jsxs("div",{className:"text-sm text-red-700",children:[b.operations_count," операций"]})]}),r.jsx("div",{className:"text-lg font-bold text-red-900",children:u(b.amount)})]},g))}):r.jsxs("div",{className:"text-center py-8 text-gray-500",children:[r.jsx(Br,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),r.jsx("p",{children:"Нет расходов за выбранный период"})]})]})]})]}):r.jsxs("div",{className:"p-8 text-center text-gray-500",children:[r.jsx(Gt,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),r.jsx("p",{children:"Нет данных для отображения"})]})},Co=e=>Math.abs(Number(e)).toLocaleString("ru-RU")+" ₽",rg=e=>new Date(e).toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric"}),sg=e=>{const t=Number(e);return t>0?"text-green-600":t<0?"text-red-600":"text-gray-600"},ag=({finances:e=[],clients:t=[],cashDesks:n=[],workers:s=[],financeSummary:a={total_income:0,total_expense:0,balance:0},loading:l=!1,onAddFinance:o,onEditFinance:i,onDeleteFinance:c,onError:u,activeSubTab:f=me.ACTUAL,onSubTabChange:d,onApplyFilters:y})=>{const{user:g}=Rt(),b=(g==null?void 0:g.role)==="admin"||(g==null?void 0:g.role)==="manager",[v,S]=p.useState(1),[x,h]=p.useState(20),[m,k]=p.useState(!1),[j,N]=p.useState({date_from:"",date_to:"",cash_desk_id:"",client_search:"",worker_search:"",category:"",description:""}),[w,C]=p.useState(!1),_=(g==null?void 0:g.role)==="admin"||(g==null?void 0:g.role)==="manager",E=()=>{C(!0)},T=()=>{C(!1)},L=R=>{u==null||u(R)},U=()=>{k(!0)},V=()=>{k(!1)},Y=R=>{if(N(R),S(1),y){const ee={...R,status:f===me.ACTUAL?ft.ACTUAL:ft.PLANNED};y(ee)}},M=()=>Object.values(j).filter(R=>R&&R.toString().trim()!=="").length,B=G0(e,n);console.log("🔍 Данные для группировки:",{исходныеФинансы:e.length,касс:n.length,сгруппированныеФинансы:B.length});const F=B.filter(R=>f===me.ACTUAL?R.status===ft.ACTUAL:R.status===ft.PLANNED).sort((R,ee)=>f===me.ACTUAL?new Date(ee.date)-new Date(R.date):new Date(R.date)-new Date(ee.date)),D=F.length,I=Math.ceil(D/x),P=(v-1)*x,$=P+x,A=F.slice(P,$),K=R=>{S(R)},J=R=>{h(R),S(1)},te=()=>{const ee=[],ae=[];for(let W=Math.max(2,v-2);W<=Math.min(I-1,v+2);W++)ee.push(W);return v-2>2?ae.push(1,"..."):ae.push(1),ae.push(...ee),v+2<I-1?ae.push("...",I):I>1&&ae.push(I),ae};p.useState(()=>{v>I&&I>0&&S(1)},[F.length,x]);const fe=e.filter(R=>R.status===ft.ACTUAL).length,Ce=e.filter(R=>R.status===ft.PLANNED).length,Z=(()=>{const R=F,ee=R.filter(W=>W.type==="income"&&!W.is_grouped_transfer).reduce((W,X)=>W+Number(X.amount),0),ae=R.filter(W=>W.type==="expense"&&!W.is_grouped_transfer).reduce((W,X)=>W+Math.abs(Number(X.amount)),0);return{total_income:ee,total_expense:ae,balance:ee-ae}})(),Qe=R=>{R.is_grouped_transfer?(console.log("Редактирование перевода:",R.original_payments),i(R.original_payments[0])):i(R)},ve=R=>{const ee=F.find(ae=>ae.id===R);ee!=null&&ee.is_grouped_transfer?(console.log("Удаление перевода:",ee.original_payments),confirm("Удалить перевод между кассами? Будут удалены обе связанные операции.")&&ee.original_payments.forEach(ae=>{c(ae.id)})):c(R)},ne=R=>{if(R.is_grouped_transfer)return r.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[r.jsx(w0,{className:"w-3 h-3 mr-1"}),"Перевод"]});const ee=R.status===ft.PLANNED&&new Date(R.date)<new Date;return r.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${R.status===ft.ACTUAL?"bg-green-100 text-green-800":ee?"bg-red-100 text-red-800":"bg-orange-100 text-orange-800"}`,children:[r.jsx(pl,{className:"w-3 h-3 mr-1"}),R.status===ft.ACTUAL?"Выполнен":ee?"Просрочен":"План"]})};return r.jsxs("div",{className:"space-y-6",children:[r.jsx(q0,{activeSubTab:f,onSubTabChange:d,actualCount:fe,plannedCount:Ce}),f!==me.STATISTICS&&r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[r.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:r.jsx(sr,{className:"w-5 h-5 text-green-600"})}),r.jsxs("div",{className:"ml-3",children:[r.jsx("p",{className:"text-sm font-medium text-gray-500",children:f===me.ACTUAL?"Доходы (факт)":"Доходы (план)"}),r.jsx("p",{className:"text-2xl font-semibold text-green-600",children:Co(Z.total_income)})]})]})}),r.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center",children:r.jsx(Br,{className:"w-5 h-5 text-red-600"})}),r.jsxs("div",{className:"ml-3",children:[r.jsx("p",{className:"text-sm font-medium text-gray-500",children:f===me.ACTUAL?"Расходы (факт)":"Расходы (план)"}),r.jsxs("p",{className:"text-2xl font-semibold text-red-600",children:["-",Number(Z.total_expense).toLocaleString("ru-RU")," ₽"]})]})]})}),r.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center ${f===me.ACTUAL?"bg-blue-100":"bg-orange-100"}`,children:r.jsx(Xe,{className:`w-5 h-5 ${f===me.ACTUAL?"text-blue-600":"text-orange-600"}`})}),r.jsxs("div",{className:"ml-3",children:[r.jsx("p",{className:"text-sm font-medium text-gray-500",children:f===me.ACTUAL?"Баланс (факт)":"Баланс (план)"}),r.jsx("p",{className:`text-2xl font-semibold ${sg(Z.balance)}`,children:Co(Z.balance)})]})]})})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow-sm",children:[r.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[r.jsx("div",{children:r.jsx("h2",{className:"text-lg font-medium text-gray-900",children:f===me.ACTUAL?`Фактические операции (${fe})`:f===me.PLANNED?`Планируемые операции (${Ce})`:"Статистика финансов"})}),f!==me.STATISTICS&&r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsxs("button",{onClick:U,className:`inline-flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors ${M()>0?"bg-blue-100 text-blue-700 hover:bg-blue-200":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,title:"Фильтры",children:[r.jsx(or,{className:"w-4 h-4 mr-2"}),"Фильтры",M()>0&&r.jsx("span",{className:"ml-2 bg-blue-600 text-white text-xs rounded-full px-2 py-1",children:M()})]}),f===me.ACTUAL&&_&&r.jsxs("button",{onClick:E,className:"inline-flex items-center px-3 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 transition-colors",title:"Скачать выписку",children:[r.jsx(ki,{className:"w-4 h-4 mr-2"}),"Выписка"]}),r.jsxs("button",{onClick:o,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 transition-colors",children:[r.jsx(un,{className:"w-4 h-4 mr-2"}),"Добавить операцию"]})]})]}),f===me.STATISTICS?r.jsx(ng,{}):l?r.jsxs("div",{className:"p-12 text-center text-gray-500",children:[r.jsx(Pe,{className:"w-12 h-12 mx-auto mb-4 text-gray-300 animate-spin"}),r.jsx("p",{children:"Загрузка..."})]}):F.length===0?r.jsxs("div",{className:"px-6 py-12 text-center text-gray-500",children:[f===me.ACTUAL?r.jsx(On,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}):r.jsx(pl,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),r.jsx("p",{children:f===me.ACTUAL?"Фактические операции не найдены":"Планируемые операции не найдены"}),r.jsx("p",{className:"text-sm mt-2",children:"Добавьте первую операцию, нажав кнопку выше"})]}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"px-6 py-3 bg-gray-50 border-b border-gray-200 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsx("span",{className:"text-sm text-gray-600",children:"Показывать по:"}),r.jsx("div",{className:"flex space-x-1",children:[10,20,40].map(R=>r.jsx("button",{onClick:()=>J(R),className:`px-3 py-1 text-sm rounded transition-colors ${x===R?"bg-blue-100 text-blue-700 font-medium":"text-gray-600 hover:bg-gray-100"}`,children:R},R))})]}),r.jsxs("div",{className:"text-sm text-gray-600",children:["Показано ",P+1,"-",Math.min($,D)," из ",D]})]}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Дата"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Сумма"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Отправитель"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Получатель"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Описание"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Статус"}),r.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Действия"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:A.map(R=>{const{sender:ee,recipient:ae}=R.is_grouped_transfer?X0(R):V0(R,t,n,s);return r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:rg(R.date)}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsxs("span",{className:`text-sm font-medium ${R.is_grouped_transfer?"text-blue-600":R.type==="income"?"text-green-600":"text-red-600"}`,children:[R.is_grouped_transfer?"→":R.type==="income"?"+":"-",Co(R.amount)]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx(qu,{participant:ee})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx(qu,{participant:ae})}),r.jsx("td",{className:"px-6 py-4 text-sm text-gray-900 max-w-xs",children:r.jsxs("div",{children:[R.category&&r.jsx("div",{className:"font-semibold text-gray-900 truncate",title:R.category,children:R.category}),R.description&&r.jsx("div",{className:"truncate text-gray-600",title:R.description,children:R.description}),!R.category&&!R.description&&r.jsx("span",{className:"text-gray-400 italic",children:"—"})]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:ne(R)}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:r.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[!R.is_grouped_transfer&&r.jsx("button",{onClick:()=>Qe(R),className:"text-blue-600 hover:text-blue-900 transition-colors",title:"Редактировать",children:r.jsx(Ec,{className:"w-4 h-4"})}),b&&r.jsx("button",{onClick:()=>ve(R.id||R.transfer_id),className:"text-red-600 hover:text-red-900 transition-colors",title:R.is_grouped_transfer?"Удалить перевод":"Удалить",children:r.jsx(Yr,{className:"w-4 h-4"})})]})})]},R.id||`${R.date}-${R.amount}-${Math.random()}`)})})]})}),I>1&&r.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200 flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("button",{onClick:()=>K(v-1),disabled:v===1,className:"inline-flex items-center px-2 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:r.jsx(Mf,{className:"w-4 h-4"})}),r.jsx("div",{className:"flex items-center space-x-1",children:te().map((R,ee)=>r.jsx("button",{onClick:()=>typeof R=="number"?K(R):null,disabled:R==="...",className:`px-3 py-2 text-sm font-medium rounded-md transition-colors ${R===v?"bg-blue-600 text-white":R==="..."?"text-gray-400 cursor-default":"text-gray-700 bg-white border border-gray-300 hover:bg-gray-50"}`,children:R},ee))}),r.jsx("button",{onClick:()=>K(v+1),disabled:v===I,className:"inline-flex items-center px-2 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:r.jsx(Pf,{className:"w-4 h-4"})})]}),r.jsxs("div",{className:"text-sm text-gray-700",children:["Страница ",v," из ",I]})]})]})]}),r.jsx(Z0,{isOpen:w,onClose:T,onError:L}),r.jsx(tg,{isOpen:m,onClose:V,onApplyFilters:Y,finances:e,cashDesks:n,clients:t,workers:s,initialFilters:j})]})},cs=e=>`${Math.abs(Number(e)).toLocaleString("ru-RU")} ₽`,Ju=e=>{const t=Number(e);return t>0?"text-green-600":t<0?"text-red-600":"text-gray-600"},lg=e=>{if(!e)return"Не указана";try{return new Date(e).toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"Неверная дата"}},og=({cashDesks:e,loading:t,showResults:n,onAddCashDesk:s,onEditCashDesk:a,onDeleteCashDesk:l,onViewTransactions:o})=>{const{user:i}=Rt(),c=(i==null?void 0:i.role)===sn.ADMIN||(i==null?void 0:i.role)===sn.MANAGER,u=(i==null?void 0:i.role)===sn.ADMIN;return t?r.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:r.jsxs("div",{className:"flex justify-center items-center",children:[r.jsx(Pe,{className:"w-8 h-8 animate-spin text-blue-600"}),r.jsx("span",{className:"ml-3 text-gray-600",children:"Загрузка касс..."})]})}):r.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[r.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(dn,{className:"w-6 h-6 text-blue-600 mr-3"}),r.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Управление кассами",n&&r.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-500",children:["(",e.length," ",e.length===1?"касса":e.length<5?"кассы":"касс",")"]})]})]}),c&&r.jsxs("button",{onClick:s,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-colors",children:[r.jsx(un,{className:"w-4 h-4"}),r.jsx("span",{children:"Добавить кассу"})]})]}),n&&e.length>0?r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Название"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Текущий баланс"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Расчетный баланс"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Операции"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Статус"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Создана"}),r.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Действия"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.filter(f=>f).map(f=>r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsxs("div",{children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:(f==null?void 0:f.name)||"Без названия"}),(f==null?void 0:f.description)&&r.jsx("div",{className:"text-sm text-gray-500",children:f.description})]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsxs("div",{className:`text-sm font-semibold ${Ju((f==null?void 0:f.current_balance)||0)}`,children:[r.jsx(Xe,{className:"w-4 h-4 inline mr-1"}),cs((f==null?void 0:f.current_balance)||0)]})}),r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[r.jsx("div",{className:`text-sm font-medium ${Ju((f==null?void 0:f.calculated_balance)||0)}`,children:cs((f==null?void 0:f.calculated_balance)||0)}),Math.abs(Number((f==null?void 0:f.current_balance)||0)-Number((f==null?void 0:f.calculated_balance)||0))>.01&&r.jsxs("div",{className:"text-xs text-orange-600",children:["Расхождение: ",cs(Number((f==null?void 0:f.calculated_balance)||0)-Number((f==null?void 0:f.current_balance)||0))]})]}),r.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsxs("div",{className:"flex items-center text-green-600",children:[r.jsx(sr,{className:"w-4 h-4 mr-1"}),r.jsx("span",{children:cs((f==null?void 0:f.actual_income)||0)})]}),r.jsxs("div",{className:"flex items-center text-red-600",children:[r.jsx(Br,{className:"w-4 h-4 mr-1"}),r.jsx("span",{children:cs(Math.abs((f==null?void 0:f.actual_expense)||0))})]})]}),r.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Всего операций: ",(f==null?void 0:f.transactions_count)||0]})]}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${f!=null&&f.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:f!=null&&f.is_active?"Активна":"Неактивна"})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:lg(f==null?void 0:f.created_at)}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:r.jsxs("div",{className:"flex justify-end space-x-2",children:[r.jsx("button",{onClick:()=>o(f),className:"text-blue-600 hover:text-blue-900 p-2 rounded-lg hover:bg-blue-50 transition-colors",title:"Просмотр операций",children:r.jsx(ra,{className:"w-4 h-4"})}),c&&r.jsx("button",{onClick:()=>a(f),className:"text-indigo-600 hover:text-indigo-900 p-2 rounded-lg hover:bg-indigo-50 transition-colors",title:"Редактировать",children:r.jsx(Ec,{className:"w-4 h-4"})}),u&&r.jsx("button",{onClick:()=>l(f.id),className:"text-red-600 hover:text-red-900 p-2 rounded-lg hover:bg-red-50 transition-colors",title:"Удалить",children:r.jsx(Yr,{className:"w-4 h-4"})})]})})]},f.id))})]})}):n?r.jsxs("div",{className:"px-6 py-12 text-center",children:[r.jsx(dn,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Кассы не найдены"}),r.jsx("p",{className:"text-gray-500 mb-4",children:"Попробуйте изменить параметры поиска или создайте новую кассу."}),c&&r.jsxs("button",{onClick:s,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 mx-auto transition-colors",children:[r.jsx(un,{className:"w-4 h-4"}),r.jsx("span",{children:"Создать кассу"})]})]}):r.jsxs("div",{className:"px-6 py-12 text-center",children:[r.jsx(dn,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Управление кассами"}),r.jsx("p",{className:"text-gray-500 mb-4",children:"Начните поиск касс или создайте новую кассу для управления финансами."}),c&&r.jsxs("button",{onClick:s,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 mx-auto transition-colors",children:[r.jsx(un,{className:"w-4 h-4"}),r.jsx("span",{children:"Создать кассу"})]})]})]})};function ig(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return p.useMemo(()=>s=>{t.forEach(a=>a(s))},t)}const Wl=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Kr(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function Tc(e){return"nodeType"in e}function tt(e){var t,n;return e?Kr(e)?e:Tc(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function Fc(e){const{Document:t}=tt(e);return e instanceof t}function sa(e){return Kr(e)?!1:e instanceof tt(e).HTMLElement}function Hf(e){return e instanceof tt(e).SVGElement}function Qr(e){return e?Kr(e)?e.document:Tc(e)?Fc(e)?e:sa(e)||Hf(e)?e.ownerDocument:document:document:document}const Ut=Wl?p.useLayoutEffect:p.useEffect;function Hl(e){const t=p.useRef(e);return Ut(()=>{t.current=e}),p.useCallback(function(){for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return t.current==null?void 0:t.current(...s)},[])}function cg(){const e=p.useRef(null),t=p.useCallback((s,a)=>{e.current=setInterval(s,a)},[]),n=p.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function Gs(e,t){t===void 0&&(t=[e]);const n=p.useRef(e);return Ut(()=>{n.current!==e&&(n.current=e)},t),n}function aa(e,t){const n=p.useRef();return p.useMemo(()=>{const s=e(n.current);return n.current=s,s},[...t])}function yl(e){const t=Hl(e),n=p.useRef(null),s=p.useCallback(a=>{a!==n.current&&(t==null||t(a,n.current)),n.current=a},[]);return[n,s]}function vl(e){const t=p.useRef();return p.useEffect(()=>{t.current=e},[e]),t.current}let _o={};function la(e,t){return p.useMemo(()=>{if(t)return t;const n=_o[e]==null?0:_o[e]+1;return _o[e]=n,e+"-"+n},[e,t])}function Vf(e){return function(t){for(var n=arguments.length,s=new Array(n>1?n-1:0),a=1;a<n;a++)s[a-1]=arguments[a];return s.reduce((l,o)=>{const i=Object.entries(o);for(const[c,u]of i){const f=l[c];f!=null&&(l[c]=f+e*u)}return l},{...t})}}const Ar=Vf(1),Xs=Vf(-1);function ug(e){return"clientX"in e&&"clientY"in e}function Vl(e){if(!e)return!1;const{KeyboardEvent:t}=tt(e.target);return t&&e instanceof t}function dg(e){if(!e)return!1;const{TouchEvent:t}=tt(e.target);return t&&e instanceof t}function bl(e){if(dg(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return ug(e)?{x:e.clientX,y:e.clientY}:null}const Un=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[Un.Translate.toString(e),Un.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:s}=e;return t+" "+n+"ms "+s}}}),Zu="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function mg(e){return e.matches(Zu)?e:e.querySelector(Zu)}const fg={display:"none"};function hg(e){let{id:t,value:n}=e;return we.createElement("div",{id:t,style:fg},n)}function xg(e){let{id:t,announcement:n,ariaLiveType:s="assertive"}=e;const a={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return we.createElement("div",{id:t,style:a,role:"status","aria-live":s,"aria-atomic":!0},n)}function pg(){const[e,t]=p.useState("");return{announce:p.useCallback(s=>{s!=null&&t(s)},[]),announcement:e}}const Yf=p.createContext(null);function gg(e){const t=p.useContext(Yf);p.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function yg(){const[e]=p.useState(()=>new Set),t=p.useCallback(s=>(e.add(s),()=>e.delete(s)),[e]);return[p.useCallback(s=>{let{type:a,event:l}=s;e.forEach(o=>{var i;return(i=o[a])==null?void 0:i.call(o,l)})},[e]),t]}const vg={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},bg={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function wg(e){let{announcements:t=bg,container:n,hiddenTextDescribedById:s,screenReaderInstructions:a=vg}=e;const{announce:l,announcement:o}=pg(),i=la("DndLiveRegion"),[c,u]=p.useState(!1);if(p.useEffect(()=>{u(!0)},[]),gg(p.useMemo(()=>({onDragStart(d){let{active:y}=d;l(t.onDragStart({active:y}))},onDragMove(d){let{active:y,over:g}=d;t.onDragMove&&l(t.onDragMove({active:y,over:g}))},onDragOver(d){let{active:y,over:g}=d;l(t.onDragOver({active:y,over:g}))},onDragEnd(d){let{active:y,over:g}=d;l(t.onDragEnd({active:y,over:g}))},onDragCancel(d){let{active:y,over:g}=d;l(t.onDragCancel({active:y,over:g}))}}),[l,t])),!c)return null;const f=we.createElement(we.Fragment,null,we.createElement(hg,{id:s,value:a.draggable}),we.createElement(xg,{id:i,announcement:o}));return n?Sr.createPortal(f,n):f}var Ae;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(Ae||(Ae={}));function wl(){}function ed(e,t){return p.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function jg(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return p.useMemo(()=>[...t].filter(s=>s!=null),[...t])}const Bt=Object.freeze({x:0,y:0});function Ng(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Sg(e,t){const n=bl(e);if(!n)return"0 0";const s={x:(n.x-t.left)/t.width*100,y:(n.y-t.top)/t.height*100};return s.x+"% "+s.y+"%"}function kg(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return n-s}function Cg(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return s-n}function td(e){let{left:t,top:n,height:s,width:a}=e;return[{x:t,y:n},{x:t+a,y:n},{x:t,y:n+s},{x:t+a,y:n+s}]}function Kf(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}const Qf=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const a=td(t),l=[];for(const o of s){const{id:i}=o,c=n.get(i);if(c){const u=td(c),f=a.reduce((y,g,b)=>y+Ng(u[b],g),0),d=Number((f/4).toFixed(4));l.push({id:i,data:{droppableContainer:o,value:d}})}}return l.sort(kg)};function _g(e,t){const n=Math.max(t.top,e.top),s=Math.max(t.left,e.left),a=Math.min(t.left+t.width,e.left+e.width),l=Math.min(t.top+t.height,e.top+e.height),o=a-s,i=l-n;if(s<a&&n<l){const c=t.width*t.height,u=e.width*e.height,f=o*i,d=f/(c+u-f);return Number(d.toFixed(4))}return 0}const Eg=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const a=[];for(const l of s){const{id:o}=l,i=n.get(o);if(i){const c=_g(i,t);c>0&&a.push({id:o,data:{droppableContainer:l,value:c}})}}return a.sort(Cg)};function Dg(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function Gf(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Bt}function Tg(e){return function(n){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];return a.reduce((o,i)=>({...o,top:o.top+e*i.y,bottom:o.bottom+e*i.y,left:o.left+e*i.x,right:o.right+e*i.x}),{...n})}}const Fg=Tg(1);function Xf(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function Rg(e,t,n){const s=Xf(t);if(!s)return e;const{scaleX:a,scaleY:l,x:o,y:i}=s,c=e.left-o-(1-a)*parseFloat(n),u=e.top-i-(1-l)*parseFloat(n.slice(n.indexOf(" ")+1)),f=a?e.width/a:e.width,d=l?e.height/l:e.height;return{width:f,height:d,top:u,right:c+f,bottom:u+d,left:c}}const Ag={ignoreTransform:!1};function Gr(e,t){t===void 0&&(t=Ag);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:u,transformOrigin:f}=tt(e).getComputedStyle(e);u&&(n=Rg(n,u,f))}const{top:s,left:a,width:l,height:o,bottom:i,right:c}=n;return{top:s,left:a,width:l,height:o,bottom:i,right:c}}function nd(e){return Gr(e,{ignoreTransform:!0})}function Lg(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function Ig(e,t){return t===void 0&&(t=tt(e).getComputedStyle(e)),t.position==="fixed"}function Mg(e,t){t===void 0&&(t=tt(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(a=>{const l=t[a];return typeof l=="string"?n.test(l):!1})}function Yl(e,t){const n=[];function s(a){if(t!=null&&n.length>=t||!a)return n;if(Fc(a)&&a.scrollingElement!=null&&!n.includes(a.scrollingElement))return n.push(a.scrollingElement),n;if(!sa(a)||Hf(a)||n.includes(a))return n;const l=tt(e).getComputedStyle(a);return a!==e&&Mg(a,l)&&n.push(a),Ig(a,l)?n:s(a.parentNode)}return e?s(e):n}function qf(e){const[t]=Yl(e,1);return t??null}function Eo(e){return!Wl||!e?null:Kr(e)?e:Tc(e)?Fc(e)||e===Qr(e).scrollingElement?window:sa(e)?e:null:null}function Jf(e){return Kr(e)?e.scrollX:e.scrollLeft}function Zf(e){return Kr(e)?e.scrollY:e.scrollTop}function Ei(e){return{x:Jf(e),y:Zf(e)}}var Me;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(Me||(Me={}));function eh(e){return!Wl||!e?!1:e===document.scrollingElement}function th(e){const t={x:0,y:0},n=eh(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},s={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},a=e.scrollTop<=t.y,l=e.scrollLeft<=t.x,o=e.scrollTop>=s.y,i=e.scrollLeft>=s.x;return{isTop:a,isLeft:l,isBottom:o,isRight:i,maxScroll:s,minScroll:t}}const Pg={x:.2,y:.2};function $g(e,t,n,s,a){let{top:l,left:o,right:i,bottom:c}=n;s===void 0&&(s=10),a===void 0&&(a=Pg);const{isTop:u,isBottom:f,isLeft:d,isRight:y}=th(e),g={x:0,y:0},b={x:0,y:0},v={height:t.height*a.y,width:t.width*a.x};return!u&&l<=t.top+v.height?(g.y=Me.Backward,b.y=s*Math.abs((t.top+v.height-l)/v.height)):!f&&c>=t.bottom-v.height&&(g.y=Me.Forward,b.y=s*Math.abs((t.bottom-v.height-c)/v.height)),!y&&i>=t.right-v.width?(g.x=Me.Forward,b.x=s*Math.abs((t.right-v.width-i)/v.width)):!d&&o<=t.left+v.width&&(g.x=Me.Backward,b.x=s*Math.abs((t.left+v.width-o)/v.width)),{direction:g,speed:b}}function Og(e){if(e===document.scrollingElement){const{innerWidth:l,innerHeight:o}=window;return{top:0,left:0,right:l,bottom:o,width:l,height:o}}const{top:t,left:n,right:s,bottom:a}=e.getBoundingClientRect();return{top:t,left:n,right:s,bottom:a,width:e.clientWidth,height:e.clientHeight}}function nh(e){return e.reduce((t,n)=>Ar(t,Ei(n)),Bt)}function zg(e){return e.reduce((t,n)=>t+Jf(n),0)}function Ug(e){return e.reduce((t,n)=>t+Zf(n),0)}function rh(e,t){if(t===void 0&&(t=Gr),!e)return;const{top:n,left:s,bottom:a,right:l}=t(e);qf(e)&&(a<=0||l<=0||n>=window.innerHeight||s>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Bg=[["x",["left","right"],zg],["y",["top","bottom"],Ug]];class Rc{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const s=Yl(n),a=nh(s);this.rect={...t},this.width=t.width,this.height=t.height;for(const[l,o,i]of Bg)for(const c of o)Object.defineProperty(this,c,{get:()=>{const u=i(s),f=a[l]-u;return this.rect[c]+f},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class _s{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var s;return(s=this.target)==null?void 0:s.removeEventListener(...n)})},this.target=t}add(t,n,s){var a;(a=this.target)==null||a.addEventListener(t,n,s),this.listeners.push([t,n,s])}}function Wg(e){const{EventTarget:t}=tt(e);return e instanceof t?e:Qr(e)}function Do(e,t){const n=Math.abs(e.x),s=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+s**2)>t:"x"in t&&"y"in t?n>t.x&&s>t.y:"x"in t?n>t.x:"y"in t?s>t.y:!1}var Nt;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(Nt||(Nt={}));function rd(e){e.preventDefault()}function Hg(e){e.stopPropagation()}var le;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(le||(le={}));const sh={start:[le.Space,le.Enter],cancel:[le.Esc],end:[le.Space,le.Enter,le.Tab]},Vg=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case le.Right:return{...n,x:n.x+25};case le.Left:return{...n,x:n.x-25};case le.Down:return{...n,y:n.y+25};case le.Up:return{...n,y:n.y-25}}};class Ac{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new _s(Qr(n)),this.windowListeners=new _s(tt(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Nt.Resize,this.handleCancel),this.windowListeners.add(Nt.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Nt.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,s=t.node.current;s&&rh(s),n(Bt)}handleKeyDown(t){if(Vl(t)){const{active:n,context:s,options:a}=this.props,{keyboardCodes:l=sh,coordinateGetter:o=Vg,scrollBehavior:i="smooth"}=a,{code:c}=t;if(l.end.includes(c)){this.handleEnd(t);return}if(l.cancel.includes(c)){this.handleCancel(t);return}const{collisionRect:u}=s.current,f=u?{x:u.left,y:u.top}:Bt;this.referenceCoordinates||(this.referenceCoordinates=f);const d=o(t,{active:n,context:s.current,currentCoordinates:f});if(d){const y=Xs(d,f),g={x:0,y:0},{scrollableAncestors:b}=s.current;for(const v of b){const S=t.code,{isTop:x,isRight:h,isLeft:m,isBottom:k,maxScroll:j,minScroll:N}=th(v),w=Og(v),C={x:Math.min(S===le.Right?w.right-w.width/2:w.right,Math.max(S===le.Right?w.left:w.left+w.width/2,d.x)),y:Math.min(S===le.Down?w.bottom-w.height/2:w.bottom,Math.max(S===le.Down?w.top:w.top+w.height/2,d.y))},_=S===le.Right&&!h||S===le.Left&&!m,E=S===le.Down&&!k||S===le.Up&&!x;if(_&&C.x!==d.x){const T=v.scrollLeft+y.x,L=S===le.Right&&T<=j.x||S===le.Left&&T>=N.x;if(L&&!y.y){v.scrollTo({left:T,behavior:i});return}L?g.x=v.scrollLeft-T:g.x=S===le.Right?v.scrollLeft-j.x:v.scrollLeft-N.x,g.x&&v.scrollBy({left:-g.x,behavior:i});break}else if(E&&C.y!==d.y){const T=v.scrollTop+y.y,L=S===le.Down&&T<=j.y||S===le.Up&&T>=N.y;if(L&&!y.x){v.scrollTo({top:T,behavior:i});return}L?g.y=v.scrollTop-T:g.y=S===le.Down?v.scrollTop-j.y:v.scrollTop-N.y,g.y&&v.scrollBy({top:-g.y,behavior:i});break}}this.handleMove(t,Ar(Xs(d,this.referenceCoordinates),g))}}}handleMove(t,n){const{onMove:s}=this.props;t.preventDefault(),s(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Ac.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:s=sh,onActivation:a}=t,{active:l}=n;const{code:o}=e.nativeEvent;if(s.start.includes(o)){const i=l.activatorNode.current;return i&&e.target!==i?!1:(e.preventDefault(),a==null||a({event:e.nativeEvent}),!0)}return!1}}];function sd(e){return!!(e&&"distance"in e)}function ad(e){return!!(e&&"delay"in e)}class Lc{constructor(t,n,s){var a;s===void 0&&(s=Wg(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:l}=t,{target:o}=l;this.props=t,this.events=n,this.document=Qr(o),this.documentListeners=new _s(this.document),this.listeners=new _s(s),this.windowListeners=new _s(tt(o)),this.initialCoordinates=(a=bl(l))!=null?a:Bt,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:s}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(Nt.Resize,this.handleCancel),this.windowListeners.add(Nt.DragStart,rd),this.windowListeners.add(Nt.VisibilityChange,this.handleCancel),this.windowListeners.add(Nt.ContextMenu,rd),this.documentListeners.add(Nt.Keydown,this.handleKeydown),n){if(s!=null&&s({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(ad(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(sd(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:s,onPending:a}=this.props;a(s,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(Nt.Click,Hg,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Nt.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:s,initialCoordinates:a,props:l}=this,{onMove:o,options:{activationConstraint:i}}=l;if(!a)return;const c=(n=bl(t))!=null?n:Bt,u=Xs(a,c);if(!s&&i){if(sd(i)){if(i.tolerance!=null&&Do(u,i.tolerance))return this.handleCancel();if(Do(u,i.distance))return this.handleStart()}if(ad(i)&&Do(u,i.tolerance))return this.handleCancel();this.handlePending(i,u);return}t.cancelable&&t.preventDefault(),o(c)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===le.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Yg={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Ic extends Lc{constructor(t){const{event:n}=t,s=Qr(n.target);super(t,Yg,s)}}Ic.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return!n.isPrimary||n.button!==0?!1:(s==null||s({event:n}),!0)}}];const Kg={move:{name:"mousemove"},end:{name:"mouseup"}};var Di;(function(e){e[e.RightClick=2]="RightClick"})(Di||(Di={}));class Qg extends Lc{constructor(t){super(t,Kg,Qr(t.event.target))}}Qg.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return n.button===Di.RightClick?!1:(s==null||s({event:n}),!0)}}];const To={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Gg extends Lc{constructor(t){super(t,To)}static setup(){return window.addEventListener(To.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(To.move.name,t)};function t(){}}}Gg.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;const{touches:a}=n;return a.length>1?!1:(s==null||s({event:n}),!0)}}];var Es;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Es||(Es={}));var jl;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(jl||(jl={}));function Xg(e){let{acceleration:t,activator:n=Es.Pointer,canScroll:s,draggingRect:a,enabled:l,interval:o=5,order:i=jl.TreeOrder,pointerCoordinates:c,scrollableAncestors:u,scrollableAncestorRects:f,delta:d,threshold:y}=e;const g=Jg({delta:d,disabled:!l}),[b,v]=cg(),S=p.useRef({x:0,y:0}),x=p.useRef({x:0,y:0}),h=p.useMemo(()=>{switch(n){case Es.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case Es.DraggableRect:return a}},[n,a,c]),m=p.useRef(null),k=p.useCallback(()=>{const N=m.current;if(!N)return;const w=S.current.x*x.current.x,C=S.current.y*x.current.y;N.scrollBy(w,C)},[]),j=p.useMemo(()=>i===jl.TreeOrder?[...u].reverse():u,[i,u]);p.useEffect(()=>{if(!l||!u.length||!h){v();return}for(const N of j){if((s==null?void 0:s(N))===!1)continue;const w=u.indexOf(N),C=f[w];if(!C)continue;const{direction:_,speed:E}=$g(N,C,h,t,y);for(const T of["x","y"])g[T][_[T]]||(E[T]=0,_[T]=0);if(E.x>0||E.y>0){v(),m.current=N,b(k,o),S.current=E,x.current=_;return}}S.current={x:0,y:0},x.current={x:0,y:0},v()},[t,k,s,v,l,o,JSON.stringify(h),JSON.stringify(g),b,u,j,f,JSON.stringify(y)])}const qg={x:{[Me.Backward]:!1,[Me.Forward]:!1},y:{[Me.Backward]:!1,[Me.Forward]:!1}};function Jg(e){let{delta:t,disabled:n}=e;const s=vl(t);return aa(a=>{if(n||!s||!a)return qg;const l={x:Math.sign(t.x-s.x),y:Math.sign(t.y-s.y)};return{x:{[Me.Backward]:a.x[Me.Backward]||l.x===-1,[Me.Forward]:a.x[Me.Forward]||l.x===1},y:{[Me.Backward]:a.y[Me.Backward]||l.y===-1,[Me.Forward]:a.y[Me.Forward]||l.y===1}}},[n,t,s])}function Zg(e,t){const n=t!=null?e.get(t):void 0,s=n?n.node.current:null;return aa(a=>{var l;return t==null?null:(l=s??a)!=null?l:null},[s,t])}function ey(e,t){return p.useMemo(()=>e.reduce((n,s)=>{const{sensor:a}=s,l=a.activators.map(o=>({eventName:o.eventName,handler:t(o.handler,s)}));return[...n,...l]},[]),[e,t])}var qs;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(qs||(qs={}));var Ti;(function(e){e.Optimized="optimized"})(Ti||(Ti={}));const ld=new Map;function ty(e,t){let{dragging:n,dependencies:s,config:a}=t;const[l,o]=p.useState(null),{frequency:i,measure:c,strategy:u}=a,f=p.useRef(e),d=S(),y=Gs(d),g=p.useCallback(function(x){x===void 0&&(x=[]),!y.current&&o(h=>h===null?x:h.concat(x.filter(m=>!h.includes(m))))},[y]),b=p.useRef(null),v=aa(x=>{if(d&&!n)return ld;if(!x||x===ld||f.current!==e||l!=null){const h=new Map;for(let m of e){if(!m)continue;if(l&&l.length>0&&!l.includes(m.id)&&m.rect.current){h.set(m.id,m.rect.current);continue}const k=m.node.current,j=k?new Rc(c(k),k):null;m.rect.current=j,j&&h.set(m.id,j)}return h}return x},[e,l,n,d,c]);return p.useEffect(()=>{f.current=e},[e]),p.useEffect(()=>{d||g()},[n,d]),p.useEffect(()=>{l&&l.length>0&&o(null)},[JSON.stringify(l)]),p.useEffect(()=>{d||typeof i!="number"||b.current!==null||(b.current=setTimeout(()=>{g(),b.current=null},i))},[i,d,g,...s]),{droppableRects:v,measureDroppableContainers:g,measuringScheduled:l!=null};function S(){switch(u){case qs.Always:return!1;case qs.BeforeDragging:return n;default:return!n}}}function Mc(e,t){return aa(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function ny(e,t){return Mc(e,t)}function ry(e){let{callback:t,disabled:n}=e;const s=Hl(t),a=p.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:l}=window;return new l(s)},[s,n]);return p.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function Kl(e){let{callback:t,disabled:n}=e;const s=Hl(t),a=p.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:l}=window;return new l(s)},[n]);return p.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function sy(e){return new Rc(Gr(e),e)}function od(e,t,n){t===void 0&&(t=sy);const[s,a]=p.useState(null);function l(){a(c=>{if(!e)return null;if(e.isConnected===!1){var u;return(u=c??n)!=null?u:null}const f=t(e);return JSON.stringify(c)===JSON.stringify(f)?c:f})}const o=ry({callback(c){if(e)for(const u of c){const{type:f,target:d}=u;if(f==="childList"&&d instanceof HTMLElement&&d.contains(e)){l();break}}}}),i=Kl({callback:l});return Ut(()=>{l(),e?(i==null||i.observe(e),o==null||o.observe(document.body,{childList:!0,subtree:!0})):(i==null||i.disconnect(),o==null||o.disconnect())},[e]),s}function ay(e){const t=Mc(e);return Gf(e,t)}const id=[];function ly(e){const t=p.useRef(e),n=aa(s=>e?s&&s!==id&&e&&t.current&&e.parentNode===t.current.parentNode?s:Yl(e):id,[e]);return p.useEffect(()=>{t.current=e},[e]),n}function oy(e){const[t,n]=p.useState(null),s=p.useRef(e),a=p.useCallback(l=>{const o=Eo(l.target);o&&n(i=>i?(i.set(o,Ei(o)),new Map(i)):null)},[]);return p.useEffect(()=>{const l=s.current;if(e!==l){o(l);const i=e.map(c=>{const u=Eo(c);return u?(u.addEventListener("scroll",a,{passive:!0}),[u,Ei(u)]):null}).filter(c=>c!=null);n(i.length?new Map(i):null),s.current=e}return()=>{o(e),o(l)};function o(i){i.forEach(c=>{const u=Eo(c);u==null||u.removeEventListener("scroll",a)})}},[a,e]),p.useMemo(()=>e.length?t?Array.from(t.values()).reduce((l,o)=>Ar(l,o),Bt):nh(e):Bt,[e,t])}function cd(e,t){t===void 0&&(t=[]);const n=p.useRef(null);return p.useEffect(()=>{n.current=null},t),p.useEffect(()=>{const s=e!==Bt;s&&!n.current&&(n.current=e),!s&&n.current&&(n.current=null)},[e]),n.current?Xs(e,n.current):Bt}function iy(e){p.useEffect(()=>{if(!Wl)return;const t=e.map(n=>{let{sensor:s}=n;return s.setup==null?void 0:s.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function cy(e,t){return p.useMemo(()=>e.reduce((n,s)=>{let{eventName:a,handler:l}=s;return n[a]=o=>{l(o,t)},n},{}),[e,t])}function ah(e){return p.useMemo(()=>e?Lg(e):null,[e])}const ud=[];function uy(e,t){t===void 0&&(t=Gr);const[n]=e,s=ah(n?tt(n):null),[a,l]=p.useState(ud);function o(){l(()=>e.length?e.map(c=>eh(c)?s:new Rc(t(c),c)):ud)}const i=Kl({callback:o});return Ut(()=>{i==null||i.disconnect(),o(),e.forEach(c=>i==null?void 0:i.observe(c))},[e]),a}function lh(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return sa(t)?t:e}function dy(e){let{measure:t}=e;const[n,s]=p.useState(null),a=p.useCallback(u=>{for(const{target:f}of u)if(sa(f)){s(d=>{const y=t(f);return d?{...d,width:y.width,height:y.height}:y});break}},[t]),l=Kl({callback:a}),o=p.useCallback(u=>{const f=lh(u);l==null||l.disconnect(),f&&(l==null||l.observe(f)),s(f?t(f):null)},[t,l]),[i,c]=yl(o);return p.useMemo(()=>({nodeRef:i,rect:n,setRef:c}),[n,i,c])}const my=[{sensor:Ic,options:{}},{sensor:Ac,options:{}}],fy={current:{}},Va={draggable:{measure:nd},droppable:{measure:nd,strategy:qs.WhileDragging,frequency:Ti.Optimized},dragOverlay:{measure:Gr}};class Ds extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,s;return(n=(s=this.get(t))==null?void 0:s.node.current)!=null?n:void 0}}const hy={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Ds,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:wl},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Va,measureDroppableContainers:wl,windowRect:null,measuringScheduled:!1},oh={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:wl,draggableNodes:new Map,over:null,measureDroppableContainers:wl},oa=p.createContext(oh),ih=p.createContext(hy);function xy(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Ds}}}function py(e,t){switch(t.type){case Ae.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case Ae.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case Ae.DragEnd:case Ae.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Ae.RegisterDroppable:{const{element:n}=t,{id:s}=n,a=new Ds(e.droppable.containers);return a.set(s,n),{...e,droppable:{...e.droppable,containers:a}}}case Ae.SetDroppableDisabled:{const{id:n,key:s,disabled:a}=t,l=e.droppable.containers.get(n);if(!l||s!==l.key)return e;const o=new Ds(e.droppable.containers);return o.set(n,{...l,disabled:a}),{...e,droppable:{...e.droppable,containers:o}}}case Ae.UnregisterDroppable:{const{id:n,key:s}=t,a=e.droppable.containers.get(n);if(!a||s!==a.key)return e;const l=new Ds(e.droppable.containers);return l.delete(n),{...e,droppable:{...e.droppable,containers:l}}}default:return e}}function gy(e){let{disabled:t}=e;const{active:n,activatorEvent:s,draggableNodes:a}=p.useContext(oa),l=vl(s),o=vl(n==null?void 0:n.id);return p.useEffect(()=>{if(!t&&!s&&l&&o!=null){if(!Vl(l)||document.activeElement===l.target)return;const i=a.get(o);if(!i)return;const{activatorNode:c,node:u}=i;if(!c.current&&!u.current)return;requestAnimationFrame(()=>{for(const f of[c.current,u.current]){if(!f)continue;const d=mg(f);if(d){d.focus();break}}})}},[s,t,a,o,l]),null}function ch(e,t){let{transform:n,...s}=t;return e!=null&&e.length?e.reduce((a,l)=>l({transform:a,...s}),n):n}function yy(e){return p.useMemo(()=>({draggable:{...Va.draggable,...e==null?void 0:e.draggable},droppable:{...Va.droppable,...e==null?void 0:e.droppable},dragOverlay:{...Va.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function vy(e){let{activeNode:t,measure:n,initialRect:s,config:a=!0}=e;const l=p.useRef(!1),{x:o,y:i}=typeof a=="boolean"?{x:a,y:a}:a;Ut(()=>{if(!o&&!i||!t){l.current=!1;return}if(l.current||!s)return;const u=t==null?void 0:t.node.current;if(!u||u.isConnected===!1)return;const f=n(u),d=Gf(f,s);if(o||(d.x=0),i||(d.y=0),l.current=!0,Math.abs(d.x)>0||Math.abs(d.y)>0){const y=qf(u);y&&y.scrollBy({top:d.y,left:d.x})}},[t,o,i,s,n])}const Ql=p.createContext({...Bt,scaleX:1,scaleY:1});var Sn;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Sn||(Sn={}));const by=p.memo(function(t){var n,s,a,l;let{id:o,accessibility:i,autoScroll:c=!0,children:u,sensors:f=my,collisionDetection:d=Eg,measuring:y,modifiers:g,...b}=t;const v=p.useReducer(py,void 0,xy),[S,x]=v,[h,m]=yg(),[k,j]=p.useState(Sn.Uninitialized),N=k===Sn.Initialized,{draggable:{active:w,nodes:C,translate:_},droppable:{containers:E}}=S,T=w!=null?C.get(w):null,L=p.useRef({initial:null,translated:null}),U=p.useMemo(()=>{var We;return w!=null?{id:w,data:(We=T==null?void 0:T.data)!=null?We:fy,rect:L}:null},[w,T]),V=p.useRef(null),[Y,M]=p.useState(null),[B,F]=p.useState(null),D=Gs(b,Object.values(b)),I=la("DndDescribedBy",o),P=p.useMemo(()=>E.getEnabled(),[E]),$=yy(y),{droppableRects:A,measureDroppableContainers:K,measuringScheduled:J}=ty(P,{dragging:N,dependencies:[_.x,_.y],config:$.droppable}),te=Zg(C,w),fe=p.useMemo(()=>B?bl(B):null,[B]),Ce=Th(),ye=ny(te,$.draggable.measure);vy({activeNode:w!=null?C.get(w):null,config:Ce.layoutShiftCompensation,initialRect:ye,measure:$.draggable.measure});const Z=od(te,$.draggable.measure,ye),Qe=od(te?te.parentElement:null),ve=p.useRef({activatorEvent:null,active:null,activeNode:te,collisionRect:null,collisions:null,droppableRects:A,draggableNodes:C,draggingNode:null,draggingNodeRect:null,droppableContainers:E,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),ne=E.getNodeFor((n=ve.current.over)==null?void 0:n.id),R=dy({measure:$.dragOverlay.measure}),ee=(s=R.nodeRef.current)!=null?s:te,ae=N?(a=R.rect)!=null?a:Z:null,W=!!(R.nodeRef.current&&R.rect),X=ay(W?null:Z),Se=ah(ee?tt(ee):null),nt=ly(N?ne??te:null),Wt=uy(nt),Zt=ch(g,{transform:{x:_.x-X.x,y:_.y-X.y,scaleX:1,scaleY:1},activatorEvent:B,active:U,activeNodeRect:Z,containerNodeRect:Qe,draggingNodeRect:ae,over:ve.current.over,overlayNodeRect:R.rect,scrollableAncestors:nt,scrollableAncestorRects:Wt,windowRect:Se}),z=fe?Ar(fe,_):null,G=oy(nt),ct=cd(G),ia=cd(G,[Z]),ir=Ar(Zt,ct),cr=ae?Fg(ae,Zt):null,Xr=U&&cr?d({active:U,collisionRect:cr,droppableRects:A,droppableContainers:P,pointerCoordinates:z}):null,Pc=Kf(Xr,"id"),[gn,$c]=p.useState(null),kh=W?Zt:Ar(Zt,ia),Ch=Dg(kh,(l=gn==null?void 0:gn.rect)!=null?l:null,Z),Gl=p.useRef(null),Oc=p.useCallback((We,ut)=>{let{sensor:dt,options:yn}=ut;if(V.current==null)return;const wt=C.get(V.current);if(!wt)return;const mt=We.nativeEvent,Ht=new dt({active:V.current,activeNode:wt,event:mt,options:yn,context:ve,onAbort(Oe){if(!C.get(Oe))return;const{onDragAbort:Vt}=D.current,en={id:Oe};Vt==null||Vt(en),h({type:"onDragAbort",event:en})},onPending(Oe,vn,Vt,en){if(!C.get(Oe))return;const{onDragPending:Jr}=D.current,bn={id:Oe,constraint:vn,initialCoordinates:Vt,offset:en};Jr==null||Jr(bn),h({type:"onDragPending",event:bn})},onStart(Oe){const vn=V.current;if(vn==null)return;const Vt=C.get(vn);if(!Vt)return;const{onDragStart:en}=D.current,qr={activatorEvent:mt,active:{id:vn,data:Vt.data,rect:L}};Sr.unstable_batchedUpdates(()=>{en==null||en(qr),j(Sn.Initializing),x({type:Ae.DragStart,initialCoordinates:Oe,active:vn}),h({type:"onDragStart",event:qr}),M(Gl.current),F(mt)})},onMove(Oe){x({type:Ae.DragMove,coordinates:Oe})},onEnd:ur(Ae.DragEnd),onCancel:ur(Ae.DragCancel)});Gl.current=Ht;function ur(Oe){return async function(){const{active:Vt,collisions:en,over:qr,scrollAdjustedTranslate:Jr}=ve.current;let bn=null;if(Vt&&Jr){const{cancelDrop:Zr}=D.current;bn={activatorEvent:mt,active:Vt,collisions:en,delta:Jr,over:qr},Oe===Ae.DragEnd&&typeof Zr=="function"&&await Promise.resolve(Zr(bn))&&(Oe=Ae.DragCancel)}V.current=null,Sr.unstable_batchedUpdates(()=>{x({type:Oe}),j(Sn.Uninitialized),$c(null),M(null),F(null),Gl.current=null;const Zr=Oe===Ae.DragEnd?"onDragEnd":"onDragCancel";if(bn){const Xl=D.current[Zr];Xl==null||Xl(bn),h({type:Zr,event:bn})}})}}},[C]),_h=p.useCallback((We,ut)=>(dt,yn)=>{const wt=dt.nativeEvent,mt=C.get(yn);if(V.current!==null||!mt||wt.dndKit||wt.defaultPrevented)return;const Ht={active:mt};We(dt,ut.options,Ht)===!0&&(wt.dndKit={capturedBy:ut.sensor},V.current=yn,Oc(dt,ut))},[C,Oc]),zc=ey(f,_h);iy(f),Ut(()=>{Z&&k===Sn.Initializing&&j(Sn.Initialized)},[Z,k]),p.useEffect(()=>{const{onDragMove:We}=D.current,{active:ut,activatorEvent:dt,collisions:yn,over:wt}=ve.current;if(!ut||!dt)return;const mt={active:ut,activatorEvent:dt,collisions:yn,delta:{x:ir.x,y:ir.y},over:wt};Sr.unstable_batchedUpdates(()=>{We==null||We(mt),h({type:"onDragMove",event:mt})})},[ir.x,ir.y]),p.useEffect(()=>{const{active:We,activatorEvent:ut,collisions:dt,droppableContainers:yn,scrollAdjustedTranslate:wt}=ve.current;if(!We||V.current==null||!ut||!wt)return;const{onDragOver:mt}=D.current,Ht=yn.get(Pc),ur=Ht&&Ht.rect.current?{id:Ht.id,rect:Ht.rect.current,data:Ht.data,disabled:Ht.disabled}:null,Oe={active:We,activatorEvent:ut,collisions:dt,delta:{x:wt.x,y:wt.y},over:ur};Sr.unstable_batchedUpdates(()=>{$c(ur),mt==null||mt(Oe),h({type:"onDragOver",event:Oe})})},[Pc]),Ut(()=>{ve.current={activatorEvent:B,active:U,activeNode:te,collisionRect:cr,collisions:Xr,droppableRects:A,draggableNodes:C,draggingNode:ee,draggingNodeRect:ae,droppableContainers:E,over:gn,scrollableAncestors:nt,scrollAdjustedTranslate:ir},L.current={initial:ae,translated:cr}},[U,te,Xr,cr,C,ee,ae,A,E,gn,nt,ir]),Xg({...Ce,delta:_,draggingRect:cr,pointerCoordinates:z,scrollableAncestors:nt,scrollableAncestorRects:Wt});const Eh=p.useMemo(()=>({active:U,activeNode:te,activeNodeRect:Z,activatorEvent:B,collisions:Xr,containerNodeRect:Qe,dragOverlay:R,draggableNodes:C,droppableContainers:E,droppableRects:A,over:gn,measureDroppableContainers:K,scrollableAncestors:nt,scrollableAncestorRects:Wt,measuringConfiguration:$,measuringScheduled:J,windowRect:Se}),[U,te,Z,B,Xr,Qe,R,C,E,A,gn,K,nt,Wt,$,J,Se]),Dh=p.useMemo(()=>({activatorEvent:B,activators:zc,active:U,activeNodeRect:Z,ariaDescribedById:{draggable:I},dispatch:x,draggableNodes:C,over:gn,measureDroppableContainers:K}),[B,zc,U,Z,x,I,C,gn,K]);return we.createElement(Yf.Provider,{value:m},we.createElement(oa.Provider,{value:Dh},we.createElement(ih.Provider,{value:Eh},we.createElement(Ql.Provider,{value:Ch},u)),we.createElement(gy,{disabled:(i==null?void 0:i.restoreFocus)===!1})),we.createElement(wg,{...i,hiddenTextDescribedById:I}));function Th(){const We=(Y==null?void 0:Y.autoScrollEnabled)===!1,ut=typeof c=="object"?c.enabled===!1:c===!1,dt=N&&!We&&!ut;return typeof c=="object"?{...c,enabled:dt}:{enabled:dt}}}),wy=p.createContext(null),dd="button",jy="Draggable";function Ny(e){let{id:t,data:n,disabled:s=!1,attributes:a}=e;const l=la(jy),{activators:o,activatorEvent:i,active:c,activeNodeRect:u,ariaDescribedById:f,draggableNodes:d,over:y}=p.useContext(oa),{role:g=dd,roleDescription:b="draggable",tabIndex:v=0}=a??{},S=(c==null?void 0:c.id)===t,x=p.useContext(S?Ql:wy),[h,m]=yl(),[k,j]=yl(),N=cy(o,t),w=Gs(n);Ut(()=>(d.set(t,{id:t,key:l,node:h,activatorNode:k,data:w}),()=>{const _=d.get(t);_&&_.key===l&&d.delete(t)}),[d,t]);const C=p.useMemo(()=>({role:g,tabIndex:v,"aria-disabled":s,"aria-pressed":S&&g===dd?!0:void 0,"aria-roledescription":b,"aria-describedby":f.draggable}),[s,g,v,S,b,f.draggable]);return{active:c,activatorEvent:i,activeNodeRect:u,attributes:C,isDragging:S,listeners:s?void 0:N,node:h,over:y,setNodeRef:m,setActivatorNodeRef:j,transform:x}}function uh(){return p.useContext(ih)}const Sy="Droppable",ky={timeout:25};function dh(e){let{data:t,disabled:n=!1,id:s,resizeObserverConfig:a}=e;const l=la(Sy),{active:o,dispatch:i,over:c,measureDroppableContainers:u}=p.useContext(oa),f=p.useRef({disabled:n}),d=p.useRef(!1),y=p.useRef(null),g=p.useRef(null),{disabled:b,updateMeasurementsFor:v,timeout:S}={...ky,...a},x=Gs(v??s),h=p.useCallback(()=>{if(!d.current){d.current=!0;return}g.current!=null&&clearTimeout(g.current),g.current=setTimeout(()=>{u(Array.isArray(x.current)?x.current:[x.current]),g.current=null},S)},[S]),m=Kl({callback:h,disabled:b||!o}),k=p.useCallback((C,_)=>{m&&(_&&(m.unobserve(_),d.current=!1),C&&m.observe(C))},[m]),[j,N]=yl(k),w=Gs(t);return p.useEffect(()=>{!m||!j.current||(m.disconnect(),d.current=!1,m.observe(j.current))},[j,m]),p.useEffect(()=>(i({type:Ae.RegisterDroppable,element:{id:s,key:l,disabled:n,node:j,rect:y,data:w}}),()=>i({type:Ae.UnregisterDroppable,key:l,id:s})),[s]),p.useEffect(()=>{n!==f.current.disabled&&(i({type:Ae.SetDroppableDisabled,id:s,key:l,disabled:n}),f.current.disabled=n)},[s,l,n,i]),{active:o,rect:y,isOver:(c==null?void 0:c.id)===s,node:j,over:c,setNodeRef:N}}function Cy(e){let{animation:t,children:n}=e;const[s,a]=p.useState(null),[l,o]=p.useState(null),i=vl(n);return!n&&!s&&i&&a(i),Ut(()=>{if(!l)return;const c=s==null?void 0:s.key,u=s==null?void 0:s.props.id;if(c==null||u==null){a(null);return}Promise.resolve(t(u,l)).then(()=>{a(null)})},[t,s,l]),we.createElement(we.Fragment,null,n,s?p.cloneElement(s,{ref:o}):null)}const _y={x:0,y:0,scaleX:1,scaleY:1};function Ey(e){let{children:t}=e;return we.createElement(oa.Provider,{value:oh},we.createElement(Ql.Provider,{value:_y},t))}const Dy={position:"fixed",touchAction:"none"},Ty=e=>Vl(e)?"transform 250ms ease":void 0,Fy=p.forwardRef((e,t)=>{let{as:n,activatorEvent:s,adjustScale:a,children:l,className:o,rect:i,style:c,transform:u,transition:f=Ty}=e;if(!i)return null;const d=a?u:{...u,scaleX:1,scaleY:1},y={...Dy,width:i.width,height:i.height,top:i.top,left:i.left,transform:Un.Transform.toString(d),transformOrigin:a&&s?Sg(s,i):void 0,transition:typeof f=="function"?f(s):f,...c};return we.createElement(n,{className:o,style:y,ref:t},l)}),Ry=e=>t=>{let{active:n,dragOverlay:s}=t;const a={},{styles:l,className:o}=e;if(l!=null&&l.active)for(const[i,c]of Object.entries(l.active))c!==void 0&&(a[i]=n.node.style.getPropertyValue(i),n.node.style.setProperty(i,c));if(l!=null&&l.dragOverlay)for(const[i,c]of Object.entries(l.dragOverlay))c!==void 0&&s.node.style.setProperty(i,c);return o!=null&&o.active&&n.node.classList.add(o.active),o!=null&&o.dragOverlay&&s.node.classList.add(o.dragOverlay),function(){for(const[c,u]of Object.entries(a))n.node.style.setProperty(c,u);o!=null&&o.active&&n.node.classList.remove(o.active)}},Ay=e=>{let{transform:{initial:t,final:n}}=e;return[{transform:Un.Transform.toString(t)},{transform:Un.Transform.toString(n)}]},Ly={duration:250,easing:"ease",keyframes:Ay,sideEffects:Ry({styles:{active:{opacity:"0"}}})};function Iy(e){let{config:t,draggableNodes:n,droppableContainers:s,measuringConfiguration:a}=e;return Hl((l,o)=>{if(t===null)return;const i=n.get(l);if(!i)return;const c=i.node.current;if(!c)return;const u=lh(o);if(!u)return;const{transform:f}=tt(o).getComputedStyle(o),d=Xf(f);if(!d)return;const y=typeof t=="function"?t:My(t);return rh(c,a.draggable.measure),y({active:{id:l,data:i.data,node:c,rect:a.draggable.measure(c)},draggableNodes:n,dragOverlay:{node:o,rect:a.dragOverlay.measure(u)},droppableContainers:s,measuringConfiguration:a,transform:d})})}function My(e){const{duration:t,easing:n,sideEffects:s,keyframes:a}={...Ly,...e};return l=>{let{active:o,dragOverlay:i,transform:c,...u}=l;if(!t)return;const f={x:i.rect.left-o.rect.left,y:i.rect.top-o.rect.top},d={scaleX:c.scaleX!==1?o.rect.width*c.scaleX/i.rect.width:1,scaleY:c.scaleY!==1?o.rect.height*c.scaleY/i.rect.height:1},y={x:c.x-f.x,y:c.y-f.y,...d},g=a({...u,active:o,dragOverlay:i,transform:{initial:c,final:y}}),[b]=g,v=g[g.length-1];if(JSON.stringify(b)===JSON.stringify(v))return;const S=s==null?void 0:s({active:o,dragOverlay:i,...u}),x=i.node.animate(g,{duration:t,easing:n,fill:"forwards"});return new Promise(h=>{x.onfinish=()=>{S==null||S(),h()}})}}let md=0;function Py(e){return p.useMemo(()=>{if(e!=null)return md++,md},[e])}const $y=we.memo(e=>{let{adjustScale:t=!1,children:n,dropAnimation:s,style:a,transition:l,modifiers:o,wrapperElement:i="div",className:c,zIndex:u=999}=e;const{activatorEvent:f,active:d,activeNodeRect:y,containerNodeRect:g,draggableNodes:b,droppableContainers:v,dragOverlay:S,over:x,measuringConfiguration:h,scrollableAncestors:m,scrollableAncestorRects:k,windowRect:j}=uh(),N=p.useContext(Ql),w=Py(d==null?void 0:d.id),C=ch(o,{activatorEvent:f,active:d,activeNodeRect:y,containerNodeRect:g,draggingNodeRect:S.rect,over:x,overlayNodeRect:S.rect,scrollableAncestors:m,scrollableAncestorRects:k,transform:N,windowRect:j}),_=Mc(y),E=Iy({config:s,draggableNodes:b,droppableContainers:v,measuringConfiguration:h}),T=_?S.setRef:void 0;return we.createElement(Ey,null,we.createElement(Cy,{animation:E},d&&w?we.createElement(Fy,{key:w,id:d.id,ref:T,as:i,activatorEvent:f,adjustScale:t,className:c,transition:l,rect:_,style:{zIndex:u,...a},transform:C},n):null))});function mh(e,t,n){const s=e.slice();return s.splice(n<0?s.length+n:n,0,s.splice(t,1)[0]),s}function Oy(e,t){return e.reduce((n,s,a)=>{const l=t.get(s);return l&&(n[a]=l),n},Array(e.length))}function _a(e){return e!==null&&e>=0}function zy(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Uy(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const fh=e=>{let{rects:t,activeIndex:n,overIndex:s,index:a}=e;const l=mh(t,s,n),o=t[a],i=l[a];return!i||!o?null:{x:i.left-o.left,y:i.top-o.top,scaleX:i.width/o.width,scaleY:i.height/o.height}},Ea={scaleX:1,scaleY:1},By=e=>{var t;let{activeIndex:n,activeNodeRect:s,index:a,rects:l,overIndex:o}=e;const i=(t=l[n])!=null?t:s;if(!i)return null;if(a===n){const u=l[o];return u?{x:0,y:n<o?u.top+u.height-(i.top+i.height):u.top-i.top,...Ea}:null}const c=Wy(l,a,n);return a>n&&a<=o?{x:0,y:-i.height-c,...Ea}:a<n&&a>=o?{x:0,y:i.height+c,...Ea}:{x:0,y:0,...Ea}};function Wy(e,t,n){const s=e[t],a=e[t-1],l=e[t+1];return s?n<t?a?s.top-(a.top+a.height):l?l.top-(s.top+s.height):0:l?l.top-(s.top+s.height):a?s.top-(a.top+a.height):0:0}const hh="Sortable",xh=we.createContext({activeIndex:-1,containerId:hh,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:fh,disabled:{draggable:!1,droppable:!1}});function Hy(e){let{children:t,id:n,items:s,strategy:a=fh,disabled:l=!1}=e;const{active:o,dragOverlay:i,droppableRects:c,over:u,measureDroppableContainers:f}=uh(),d=la(hh,n),y=i.rect!==null,g=p.useMemo(()=>s.map(N=>typeof N=="object"&&"id"in N?N.id:N),[s]),b=o!=null,v=o?g.indexOf(o.id):-1,S=u?g.indexOf(u.id):-1,x=p.useRef(g),h=!zy(g,x.current),m=S!==-1&&v===-1||h,k=Uy(l);Ut(()=>{h&&b&&f(g)},[h,g,b,f]),p.useEffect(()=>{x.current=g},[g]);const j=p.useMemo(()=>({activeIndex:v,containerId:d,disabled:k,disableTransforms:m,items:g,overIndex:S,useDragOverlay:y,sortedRects:Oy(g,c),strategy:a}),[v,d,k.draggable,k.droppable,m,g,S,c,y,a]);return we.createElement(xh.Provider,{value:j},t)}const Vy=e=>{let{id:t,items:n,activeIndex:s,overIndex:a}=e;return mh(n,s,a).indexOf(t)},Yy=e=>{let{containerId:t,isSorting:n,wasDragging:s,index:a,items:l,newIndex:o,previousItems:i,previousContainerId:c,transition:u}=e;return!u||!s||i!==l&&a===o?!1:n?!0:o!==a&&t===c},Ky={duration:200,easing:"ease"},ph="transform",Qy=Un.Transition.toString({property:ph,duration:0,easing:"linear"}),Gy={roleDescription:"sortable"};function Xy(e){let{disabled:t,index:n,node:s,rect:a}=e;const[l,o]=p.useState(null),i=p.useRef(n);return Ut(()=>{if(!t&&n!==i.current&&s.current){const c=a.current;if(c){const u=Gr(s.current,{ignoreTransform:!0}),f={x:c.left-u.left,y:c.top-u.top,scaleX:c.width/u.width,scaleY:c.height/u.height};(f.x||f.y)&&o(f)}}n!==i.current&&(i.current=n)},[t,n,s,a]),p.useEffect(()=>{l&&o(null)},[l]),l}function qy(e){let{animateLayoutChanges:t=Yy,attributes:n,disabled:s,data:a,getNewIndex:l=Vy,id:o,strategy:i,resizeObserverConfig:c,transition:u=Ky}=e;const{items:f,containerId:d,activeIndex:y,disabled:g,disableTransforms:b,sortedRects:v,overIndex:S,useDragOverlay:x,strategy:h}=p.useContext(xh),m=Jy(s,g),k=f.indexOf(o),j=p.useMemo(()=>({sortable:{containerId:d,index:k,items:f},...a}),[d,a,k,f]),N=p.useMemo(()=>f.slice(f.indexOf(o)),[f,o]),{rect:w,node:C,isOver:_,setNodeRef:E}=dh({id:o,data:j,disabled:m.droppable,resizeObserverConfig:{updateMeasurementsFor:N,...c}}),{active:T,activatorEvent:L,activeNodeRect:U,attributes:V,setNodeRef:Y,listeners:M,isDragging:B,over:F,setActivatorNodeRef:D,transform:I}=Ny({id:o,data:j,attributes:{...Gy,...n},disabled:m.draggable}),P=ig(E,Y),$=!!T,A=$&&!b&&_a(y)&&_a(S),K=!x&&B,J=K&&A?I:null,fe=A?J??(i??h)({rects:v,activeNodeRect:U,activeIndex:y,overIndex:S,index:k}):null,Ce=_a(y)&&_a(S)?l({id:o,items:f,activeIndex:y,overIndex:S}):k,ye=T==null?void 0:T.id,Z=p.useRef({activeId:ye,items:f,newIndex:Ce,containerId:d}),Qe=f!==Z.current.items,ve=t({active:T,containerId:d,isDragging:B,isSorting:$,id:o,index:k,items:f,newIndex:Z.current.newIndex,previousItems:Z.current.items,previousContainerId:Z.current.containerId,transition:u,wasDragging:Z.current.activeId!=null}),ne=Xy({disabled:!ve,index:k,node:C,rect:w});return p.useEffect(()=>{$&&Z.current.newIndex!==Ce&&(Z.current.newIndex=Ce),d!==Z.current.containerId&&(Z.current.containerId=d),f!==Z.current.items&&(Z.current.items=f)},[$,Ce,d,f]),p.useEffect(()=>{if(ye===Z.current.activeId)return;if(ye&&!Z.current.activeId){Z.current.activeId=ye;return}const ee=setTimeout(()=>{Z.current.activeId=ye},50);return()=>clearTimeout(ee)},[ye]),{active:T,activeIndex:y,attributes:V,data:j,rect:w,index:k,newIndex:Ce,items:f,isOver:_,isSorting:$,isDragging:B,listeners:M,node:C,overIndex:S,over:F,setNodeRef:P,setActivatorNodeRef:D,setDroppableNodeRef:E,setDraggableNodeRef:Y,transform:ne??fe,transition:R()};function R(){if(ne||Qe&&Z.current.newIndex===k)return Qy;if(!(K&&!Vl(L)||!u)&&($||ve))return Un.Transition.toString({...u,property:ph})}}function Jy(e,t){var n,s;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(s=e==null?void 0:e.droppable)!=null?s:t.droppable}}function Nl(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const Zy=[le.Down,le.Right,le.Up,le.Left],ev=(e,t)=>{let{context:{active:n,collisionRect:s,droppableRects:a,droppableContainers:l,over:o,scrollableAncestors:i}}=t;if(Zy.includes(e.code)){if(e.preventDefault(),!n||!s)return;const c=[];l.getEnabled().forEach(d=>{if(!d||d!=null&&d.disabled)return;const y=a.get(d.id);if(y)switch(e.code){case le.Down:s.top<y.top&&c.push(d);break;case le.Up:s.top>y.top&&c.push(d);break;case le.Left:s.left>y.left&&c.push(d);break;case le.Right:s.left<y.left&&c.push(d);break}});const u=Qf({collisionRect:s,droppableRects:a,droppableContainers:c});let f=Kf(u,"id");if(f===(o==null?void 0:o.id)&&u.length>1&&(f=u[1].id),f!=null){const d=l.get(n.id),y=l.get(f),g=y?a.get(y.id):null,b=y==null?void 0:y.node.current;if(b&&g&&d&&y){const S=Yl(b).some((N,w)=>i[w]!==N),x=gh(d,y),h=tv(d,y),m=S||!x?{x:0,y:0}:{x:h?s.width-g.width:0,y:h?s.height-g.height:0},k={x:g.left,y:g.top};return m.x&&m.y?k:Xs(k,m)}}}};function gh(e,t){return!Nl(e)||!Nl(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function tv(e,t){return!Nl(e)||!Nl(t)||!gh(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const yh=({lead:e,onClick:t,isDragging:n=!1})=>{const{attributes:s,listeners:a,setNodeRef:l,transform:o,transition:i,isDragging:c}=qy({id:e.id}),u={transform:Un.Transform.toString(o),transition:i},f=b=>new Date(b).toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit"}),d=b=>b.split(" ").map(v=>v.charAt(0)).join("").substring(0,2).toUpperCase(),y=b=>{const v=["bg-red-100 text-red-700","bg-blue-100 text-blue-700","bg-green-100 text-green-700","bg-yellow-100 text-yellow-700","bg-purple-100 text-purple-700","bg-pink-100 text-pink-700","bg-indigo-100 text-indigo-700","bg-orange-100 text-orange-700"],S=b.length%v.length;return v[S]},g=b=>{if(c||n){b.preventDefault();return}t()};return r.jsxs("div",{ref:l,style:u,...s,...a,className:`
        bg-white rounded-lg border border-gray-200 p-3 cursor-pointer 
        transition-all duration-200 hover:shadow-md hover:border-gray-300
        ${c||n?"opacity-50 rotate-2 shadow-lg":""}
        ${n?"z-50":""}
      `,onClick:g,children:[r.jsxs("div",{className:"flex items-start justify-between mb-3",children:[r.jsx("div",{className:`
          flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center
          text-sm font-semibold ${y(e.name)}
        `,children:d(e.name)}),r.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[r.jsx(it,{className:"w-3 h-3 mr-1"}),f(e.created_at)]})]}),r.jsxs("div",{className:"space-y-2",children:[r.jsxs("div",{className:"flex items-start",children:[r.jsx(Ee,{className:"w-4 h-4 text-gray-400 mt-0.5 mr-2 flex-shrink-0"}),r.jsx("h4",{className:"text-sm font-medium text-gray-900 line-clamp-2 leading-tight",children:e.name})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx(zl,{className:"w-4 h-4 text-gray-400 mr-2 flex-shrink-0"}),r.jsx("span",{className:"text-xs text-gray-600 truncate",children:e.email})]}),e.telegram&&r.jsxs("div",{className:"flex items-center",children:[r.jsx(zn,{className:"w-4 h-4 text-blue-400 mr-2 flex-shrink-0"}),r.jsx("span",{className:"text-xs text-blue-600 truncate",children:e.telegram})]})]}),r.jsx("div",{className:"mt-3 pt-2 border-t border-gray-100",children:r.jsxs("div",{className:"flex items-center justify-end text-xs text-gray-400",children:[r.jsx($f,{className:"w-3 h-3 mr-1"}),r.jsx("span",{children:"Открыть карточку"})]})})]})},nv=({id:e,title:t,count:n,leads:s=[],onCardClick:a})=>{const{isOver:l,setNodeRef:o}=dh({id:e}),i=u=>({CREATED:"border-blue-200 bg-blue-50",DISTRIBUTION:"border-indigo-200 bg-indigo-50",GIVE_ACCESS:"border-emerald-200 bg-emerald-50"})[u]||"border-gray-200 bg-gray-50",c=u=>({CREATED:"bg-blue-100 text-blue-700",DISTRIBUTION:"bg-indigo-100 text-indigo-700",GIVE_ACCESS:"bg-emerald-100 text-emerald-700"})[u]||"bg-gray-100 text-gray-700";return r.jsxs("div",{ref:o,className:`
        min-w-80 w-80 border-2 rounded-lg transition-all duration-200 flex flex-col h-full
        ${i(e)}
        ${l?"border-blue-400 bg-blue-100":""}
      `,children:[r.jsx("div",{className:"p-4 border-b border-white/50 flex-shrink-0",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"font-medium text-gray-900 truncate pr-2",children:t}),r.jsx("span",{className:`
            px-2.5 py-1 rounded-full text-sm font-medium
            ${c(e)}
          `,children:n})]})}),r.jsxs("div",{className:"p-3 space-y-3 flex-1 overflow-y-auto custom-scrollbar",children:[r.jsx(Hy,{items:s.map(u=>u.id),strategy:By,children:s.map(u=>r.jsx(yh,{lead:u,onClick:()=>a(u)},u.id))}),s.length===0&&r.jsxs("div",{className:"text-center py-8 text-gray-500",children:[r.jsx("div",{className:"text-3xl mb-2",children:"📋"}),r.jsx("p",{className:"text-sm",children:"Перетащите карточку сюда"})]})]})]})},rv=({leads:e=[],loading:t=!1,onCardClick:n,onUpdateStatus:s,onAddLead:a,searchTerm:l="",onSearch:o})=>{const[i,c]=p.useState(null),[u,f]=p.useState({}),[d,y]=p.useState(!1),[g,b]=p.useState({name:"",nameFilter:"any",telegram:"",telegramFilter:"any",phone:"",phoneFilter:"any",flow:"",direction:"",group:"",status:""}),v=p.useMemo(()=>e.filter(_=>{var E,T,L;return!(g.name.trim()&&!(_.name&&_.name.toLowerCase().includes(g.name.toLowerCase()))||g.nameFilter==="filled"&&(!_.name||!_.name.trim())||g.nameFilter==="empty"&&_.name&&_.name.trim()||g.telegram.trim()&&!(_.telegram&&_.telegram.toLowerCase().includes(g.telegram.toLowerCase()))||g.telegramFilter==="filled"&&(!_.telegram||!_.telegram.trim())||g.telegramFilter==="empty"&&_.telegram&&_.telegram.trim()||g.phone.trim()&&!(_.phone&&_.phone.includes(g.phone))||g.phoneFilter==="filled"&&(!_.phone||!_.phone.trim())||g.phoneFilter==="empty"&&_.phone&&_.phone.trim()||g.flow&&((E=_.data)==null?void 0:E.flow)!==g.flow||g.direction&&((T=_.data)==null?void 0:T.direction)!==g.direction||g.group&&((L=_.data)==null?void 0:L.group)!==g.group||g.status&&_.status!==g.status)}),[e,g]),S=jg(ed(Ic,{activationConstraint:{distance:8}}),ed(Ac,{coordinateGetter:ev}));p.useEffect(()=>{const _=Fr.reduce((E,T)=>(E[T]=v.filter(L=>L.status===T),E),{});f(_)},[v]);const x=_=>{c(_.active.id)},h=async _=>{const{active:E,over:T}=_;if(!T){c(null);return}const L=E.id,U=T.id,V=e.find(M=>M.id===L);if(!V){c(null);return}let Y=null;if(Fr.includes(U))Y=U;else{const M=e.find(B=>B.id===U);M&&(Y=M.status)}if(Y&&Y!==V.status)try{await s(L,Y)}catch(M){console.error("Ошибка обновления статуса:",M)}c(null)},m=()=>{c(null)},k=i?e.find(_=>_.id===i):null,j=_=>{if(!l)return _;const E=l.toLowerCase();return _.filter(T=>T.name.toLowerCase().includes(E)||T.email.toLowerCase().includes(E)||T.telegram&&T.telegram.toLowerCase().includes(E))},N=()=>{y(!0)},w=()=>{y(!1)},C=_=>{b(_)};return t?r.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:r.jsxs("div",{className:"flex justify-center items-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),r.jsx("span",{className:"ml-3 text-gray-600",children:"Загрузка канбан доски..."})]})}):r.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 flex flex-col h-full",children:[r.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center flex-shrink-0",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(Ur,{className:"w-6 h-6 text-blue-600 mr-3"}),r.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Новые ученики",r.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-500",children:["(",v.length," ",v.length===1?"лид":v.length<5?"ученика":"учеников",")"]})]})]}),r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsxs("button",{onClick:N,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 flex items-center space-x-2 transition-colors",children:[r.jsx(or,{className:"w-4 h-4"}),r.jsx("span",{})]}),r.jsxs("button",{onClick:a,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2 transition-colors",children:[r.jsx(un,{className:"w-4 h-4"}),r.jsx("span",{children:"Добавить ученика"})]})]})]}),r.jsx("div",{className:"flex-1 flex flex-col p-6 overflow-hidden",children:r.jsxs(by,{sensors:S,collisionDetection:Qf,onDragStart:x,onDragEnd:h,onDragCancel:m,children:[r.jsx("div",{className:"flex-1 flex space-x-6 overflow-x-auto overflow-y-hidden",children:Fr.map(_=>{const E=j(u[_]||[]);return r.jsx(nv,{id:_,title:_t[_],count:E.length,leads:E,onCardClick:n},_)})}),r.jsx($y,{children:k?r.jsx(yh,{lead:k,isDragging:!0,onClick:()=>{}}):null})]})}),v.length===0&&r.jsxs("div",{className:"text-center py-12",children:[r.jsx(Ur,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:e.length===0?"Нет лидов":"Лиды не найдены"}),r.jsx("p",{className:"text-gray-500 mb-6",children:e.length===0?"Добавьте первого ученика, чтобы начать работу с канбан доской":"Попробуйте изменить параметры фильтрации."}),e.length===0&&r.jsxs("button",{onClick:a,className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg flex items-center space-x-2 mx-auto transition-colors",children:[r.jsx(un,{className:"w-5 h-5"}),r.jsx("span",{children:"Добавить первого ученика"})]})]}),r.jsx(Wf,{isOpen:d,onClose:w,onApplyFilters:C,clients:e,initialFilters:g})]})},sv=({workers:e=[],loading:t=!1,searchTerm:n="",onSearchChange:s,onAddWorker:a,onEditWorker:l,onDeleteWorker:o,onViewWorkerStats:i,onViewWorkerFinances:c})=>{const{user:u}=Rt(),[f,d]=p.useState(Ca.NAME),y=m=>m?new Date(m).toLocaleDateString("ru-RU"):"—",g=(m,k=null)=>{const j=new Date(m),N=k?new Date(k):new Date,w=Math.abs(N-j),C=Math.ceil(w/(1e3*60*60*24)),_=Math.floor(C/365),E=Math.floor(C%365/30);return _>0?`${_} лет ${E} мес.`:E>0?`${E} мес.`:`${C} дн.`},b=m=>`${Number(m).toLocaleString("ru-RU")} ₽`,v=m=>m.is_active?r.jsxs("span",{className:"inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800",children:[r.jsx(On,{className:"w-3 h-3 mr-1"}),"Активен"]}):r.jsxs("span",{className:"inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800",children:[r.jsx(gl,{className:"w-3 h-3 mr-1"}),"Уволен"]}),S=(u==null?void 0:u.role)==="admin"||(u==null?void 0:u.role)==="manager",x=(u==null?void 0:u.role)==="admin",h=m=>{if(m.transactions_count>0){alert(`Невозможно удалить работника ${m.full_name}. У него есть ${m.transactions_count} связанных финансовых операций.`);return}confirm(`Вы уверены, что хотите удалить работника "${m.full_name}"?`)&&o(m.id)};return t?r.jsxs("div",{className:"flex items-center justify-center py-12",children:[r.jsx(Pe,{className:"w-8 h-8 animate-spin text-blue-600"}),r.jsx("span",{className:"ml-2 text-gray-600",children:"Загрузка работников..."})]}):r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-between",children:[r.jsxs("div",{className:"flex flex-1 items-center space-x-4",children:[r.jsxs("div",{className:"relative flex-1 max-w-md",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:r.jsx(_i,{className:"h-5 w-5 text-gray-400"})}),r.jsx("input",{type:"text",placeholder:"Поиск работников...",value:n,onChange:m=>s(m.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),r.jsxs("div",{className:"relative",children:[r.jsxs("select",{value:f,onChange:m=>d(m.target.value),className:"appearance-none bg-white border border-gray-300 rounded-md px-4 py-2 pr-8 focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",children:[r.jsx("option",{value:Ca.NAME,children:"По имени"}),r.jsx("option",{value:Ca.POSITION,children:"По должности"}),r.jsx("option",{value:Ca.TELEGRAM,children:"По Telegram"})]}),r.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:r.jsx(or,{className:"h-4 w-4 text-gray-400"})})]})]}),S&&r.jsxs("button",{onClick:a,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:[r.jsx(un,{className:"w-4 h-4 mr-2"}),"Добавить работника"]})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:r.jsx("div",{className:"p-5",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx(Ee,{className:"h-6 w-6 text-gray-400"})}),r.jsx("div",{className:"ml-5 w-0 flex-1",children:r.jsxs("dl",{children:[r.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Всего работников"}),r.jsx("dd",{className:"text-lg font-medium text-gray-900",children:e.length})]})})]})})}),r.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:r.jsx("div",{className:"p-5",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx(On,{className:"h-6 w-6 text-green-400"})}),r.jsx("div",{className:"ml-5 w-0 flex-1",children:r.jsxs("dl",{children:[r.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Активных"}),r.jsx("dd",{className:"text-lg font-medium text-gray-900",children:e.filter(m=>m.is_active).length})]})})]})})}),r.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:r.jsx("div",{className:"p-5",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx(Xe,{className:"h-6 w-6 text-blue-400"})}),r.jsx("div",{className:"ml-5 w-0 flex-1",children:r.jsxs("dl",{children:[r.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Общая зарплата"}),r.jsx("dd",{className:"text-lg font-medium text-gray-900",children:b(e.reduce((m,k)=>m+(k.total_salary_paid||0),0))})]})})]})})})]}),e.length===0?r.jsxs("div",{className:"text-center py-12",children:[r.jsx(Ee,{className:"mx-auto h-12 w-12 text-gray-400"}),r.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Нет работников"}),r.jsx("p",{className:"mt-1 text-sm text-gray-500",children:n?"По вашему запросу ничего не найдено.":"Начните с добавления первого работника."}),S&&!n&&r.jsx("div",{className:"mt-6",children:r.jsxs("button",{onClick:a,className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[r.jsx(un,{className:"w-4 h-4 mr-2"}),"Добавить работника"]})})]}):r.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsxs("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Работник"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Должность"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Контакты"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Банк"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Стаж"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Статус"}),r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Финансы"}),r.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Действия"})]})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(m=>r.jsxs("tr",{className:"hover:bg-gray-50",children:[r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:r.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:r.jsx(Ee,{className:"h-5 w-5 text-blue-600"})})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:m.full_name}),r.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",m.id]})]})]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsx("div",{className:"text-sm text-gray-900",children:m.position})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsxs("div",{className:"space-y-1",children:[m.phone&&r.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[r.jsx(Jn,{className:"w-3 h-3 mr-1"}),m.phone]}),m.telegram_username&&r.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[r.jsx(zn,{className:"w-3 h-3 mr-1"}),m.telegram_username]})]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsxs("div",{className:"space-y-1",children:[m.bank&&r.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[r.jsx(Ns,{className:"w-3 h-3 mr-1"}),m.bank]}),m.masked_card_number&&r.jsxs("div",{className:"flex items-center text-sm text-gray-400",children:[r.jsx(Qs,{className:"w-3 h-3 mr-1"}),m.masked_card_number]})]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[r.jsx(it,{className:"w-3 h-3 mr-1"}),y(m.hire_date)]}),r.jsx("div",{className:"text-xs text-gray-400",children:g(m.hire_date,m.fire_date)}),m.fire_date&&r.jsxs("div",{className:"text-xs text-red-500",children:["Уволен: ",y(m.fire_date)]})]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:v(m)}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"text-sm text-gray-900",children:[m.transactions_count||0," операций"]}),m.total_salary_paid>0&&r.jsxs("div",{className:"text-xs text-red-600",children:["Выплачено: ",b(m.total_salary_paid)]}),m.total_income_brought>0&&r.jsxs("div",{className:"text-xs text-green-600",children:["Принес: ",b(m.total_income_brought)]})]})}),r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:r.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[r.jsx("button",{onClick:()=>i(m),className:"text-blue-600 hover:text-blue-900 transition-colors",title:"Статистика работника",children:r.jsx(Gt,{className:"w-4 h-4"})}),r.jsx("button",{onClick:()=>c(m),className:"text-green-600 hover:text-green-900 transition-colors",title:"Финансовые операции",children:r.jsx(Xe,{className:"w-4 h-4"})}),S&&r.jsx("button",{onClick:()=>l(m),className:"text-indigo-600 hover:text-indigo-900 transition-colors",title:"Редактировать",children:r.jsx(Ec,{className:"w-4 h-4"})}),x&&r.jsx("button",{onClick:()=>h(m),className:"text-red-600 hover:text-red-900 transition-colors",title:"Удалить",children:r.jsx(Yr,{className:"w-4 h-4"})})]})})]},m.id))})]})})})]})},vh=({initialData:e=null,onSubmit:t,onCancel:n,loading:s=!1,submitText:a="Сохранить",context:l=ce.ALL})=>{const o=()=>({fullName:"",email:"",phone:"",status:Bf(l)}),[i,c]=p.useState(e||o()),[u,f]=p.useState({}),d=p.useRef(!1),y=W0(l),g=B0(l),b=()=>{var m,k,j;return((m=i.fullName)==null?void 0:m.trim())&&((k=i.email)==null?void 0:k.trim())&&((j=i.phone)==null?void 0:j.trim())},v=()=>{var k,j,N;const m={};return(k=i.fullName)!=null&&k.trim()||(m.fullName="Введите ФИО"),(j=i.email)!=null&&j.trim()?/\S+@\S+\.\S+/.test(i.email)||(m.email="Некорректный email"):m.email="Введите email",(N=i.phone)!=null&&N.trim()||(m.phone="Введите телефон"),f(m),Object.keys(m).length===0},S=m=>{if(m.preventDefault(),d.current||s){console.log("🛑 Форма уже отправляется, игнорируем...");return}if(v()){console.log("✅ ClientForm валидна, отправляем данные:",{formData:i,context:l}),d.current=!0;try{t(i)}catch(k){console.error("❌ Ошибка при вызове onSubmit:",k),d.current=!1}setTimeout(()=>{d.current=!1},2e3)}},x=(m,k)=>{c(j=>({...j,[m]:k})),u[m]&&f(j=>({...j,[m]:""}))},h=()=>{switch(l){case ce.LEADS:return"Статус лида";case ce.CLIENTS:return"Статус клиента";default:return"Статус"}};return r.jsxs("form",{onSubmit:S,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ФИО *"}),r.jsx("input",{type:"text",value:i.fullName,onChange:m=>x("fullName",m.target.value),placeholder:"Иванов Иван Иванович",disabled:s,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed ${u.fullName?"border-red-500":"border-gray-300"}`}),u.fullName&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.fullName})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),r.jsx("input",{type:"email",value:i.email,onChange:m=>x("email",m.target.value),placeholder:"example@email.com",disabled:s,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed ${u.email?"border-red-500":"border-gray-300"}`}),u.email&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.email})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Телефон *"}),r.jsx("input",{type:"tel",value:i.phone,onChange:m=>x("phone",m.target.value),placeholder:"+7 (999) 123-45-67",disabled:s,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed ${u.phone?"border-red-500":"border-gray-300"}`}),u.phone&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.phone})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:h()}),r.jsx("select",{value:i.status,onChange:m=>x("status",m.target.value),disabled:s,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-100 disabled:cursor-not-allowed",children:y.map(m=>r.jsx("option",{value:m,children:g[m]||m},m))}),l!==ce.ALL&&r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:l===ce.LEADS?"Показаны только статусы для лидов":"Показаны только статусы для клиентов"})]}),r.jsxs("div",{className:"flex space-x-3 pt-4",children:[r.jsx("button",{type:"button",onClick:n,disabled:s,className:"flex-1 px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Отмена"}),r.jsx("button",{type:"submit",disabled:!b()||s||d.current,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors flex items-center justify-center",children:s?r.jsxs(r.Fragment,{children:[r.jsx(Pe,{className:"w-4 h-4 mr-2 animate-spin"}),"Сохранение..."]}):a})]})]})},av=({isOpen:e,onClose:t,onSuccess:n,onError:s,context:a=ce.ALL})=>{const[l,o]=p.useState(!1);p.useEffect(()=>{e||o(!1)},[e]);const c=(()=>{switch(a){case ce.LEADS:return{title:"Добавить лида",icon:Ur,iconColor:"text-blue-600",submitText:"Добавить лида"};case ce.CLIENTS:return{title:"Добавить клиента",icon:Jt,iconColor:"text-green-600",submitText:"Добавить клиента"};default:return{title:"Добавить запись",icon:Jt,iconColor:"text-gray-600",submitText:"Добавить запись"}}})(),u=c.icon,f=()=>({fullName:"",email:"",phone:"",status:Bf(a)}),d=async y=>{console.log("🟢 AddClientModal.handleSubmit - передаем данные наверх:",{formData:y,context:a}),o(!0);try{n(y),t()}catch(g){console.error("❌ Ошибка в AddClientModal:",g),s("Ошибка при обработке данных формы")}finally{o(!1)}};return e?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:[r.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(u,{className:`w-6 h-6 ${c.iconColor}`}),r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:c.title})]}),r.jsx("button",{onClick:t,disabled:l,className:"text-gray-400 hover:text-gray-600 transition-colors disabled:cursor-not-allowed",children:r.jsx(Fe,{className:"w-6 h-6"})})]}),r.jsx("div",{className:"p-6",children:r.jsx(vh,{initialData:f(),onSubmit:d,onCancel:t,loading:l,submitText:c.submitText,context:a})})]})}):null},lv=({isOpen:e,onClose:t,onSuccess:n,onError:s,client:a})=>{const[l,o]=p.useState(!1),[i,c]=p.useState(0),u=ce.ALL,f=a?Uf(a.status):"Запись",y=(()=>{if(!a)return{title:"Редактировать запись",icon:Xu,iconColor:"text-gray-600",submitText:"Сохранить изменения"};switch(zf(a.status)){case"lead":return{title:"Редактировать лида",subtitle:"Можно перевести в статус клиента",icon:Ur,iconColor:"text-blue-600",submitText:"Сохранить изменения"};case"client":return{title:"Редактировать клиента",subtitle:"Можно изменить статус обучения",icon:Jt,iconColor:"text-green-600",submitText:"Сохранить изменения"};default:return{title:"Редактировать запись",subtitle:"Можно выбрать любой статус",icon:Xu,iconColor:"text-gray-600",submitText:"Сохранить изменения"}}})(),g=y.icon,b=()=>a?{fullName:a.name||"",email:a.email||"",phone:a.phone||"",status:a.status||"CREATED"}:{fullName:"",email:"",phone:"",status:"CREATED"},v=async S=>{o(!0);try{console.log("🔄 Сохранение клиента:",{id:a.id,formData:S});const x=await fetch(`/api/clients/${a.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("crm_access_token")}`},body:JSON.stringify({name:S.fullName,email:S.email,phone:S.phone,status:S.status})});if(!x.ok){const m=await x.json();throw new Error(m.error||"Ошибка при сохранении")}const h=await x.json();console.log("✅ Клиент обновлен:",h),n(h,`${f} успешно обновлен`),t()}catch(x){console.error("❌ Ошибка при обновлении клиента:",x),s(`Ошибка при обновлении: ${x.message}`)}finally{o(!1)}};return p.useEffect(()=>{e&&a&&c(S=>S+1)},[e,a==null?void 0:a.id]),e?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:`p-2 rounded-lg bg-gray-100 ${y.iconColor}`,children:r.jsx(g,{className:"w-5 h-5"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:y.title}),y.subtitle&&r.jsx("p",{className:"text-sm text-gray-500 mt-1",children:y.subtitle})]})]}),r.jsx("button",{onClick:t,disabled:l,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50",children:r.jsx(Fe,{className:"w-5 h-5 text-gray-500"})})]}),r.jsx("div",{className:"p-6",children:r.jsx(vh,{initialData:b(),onSubmit:v,onCancel:t,loading:l,submitText:y.submitText,context:u},i)}),r.jsx("div",{className:"px-6 pb-6",children:r.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-start space-x-3",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center",children:r.jsx("span",{className:"text-blue-600 text-xs font-medium",children:"💡"})})}),r.jsxs("div",{className:"text-sm text-blue-800",children:[r.jsx("p",{className:"font-medium mb-1",children:"Подсказка:"}),r.jsxs("ul",{className:"text-xs space-y-1",children:[r.jsx("li",{children:"• Можно изменить любой статус"}),r.jsx("li",{children:"• Лидов можно переводить в клиенты"}),r.jsx("li",{children:"• Клиенты могут менять статус обучения"})]})]})]})})})]})}):null},bh=({value:e="income",onChange:t,disabled:n=!1})=>{const s=()=>{if(n)return;const a=e==="income"?"expense":"income";t==null||t(a)};return r.jsx("div",{className:"flex justify-center",children:r.jsx("div",{className:"relative",style:{width:"400px"},children:r.jsxs("div",{className:`relative w-full border-4 border-gray-200 bg-gray-100 cursor-pointer overflow-hidden transition-all duration-300 ${n?"opacity-50 cursor-not-allowed":"hover:border-gray-300"}`,style:{width:"400px",height:"60px",borderRadius:"16px",border:"2px solid #E5E7EB",background:"#F3F4F6"},onClick:s,children:[r.jsx("div",{className:`absolute top-1 transition-all duration-300 shadow-xl flex items-center justify-center ${e==="income"?"left-1 bg-green-500":"bg-red-600"}`,style:{width:"190px",height:"48px",borderRadius:"10px",left:e==="income"?"5px":"200px",background:e==="income"?"#16A34A":"#DC2626",boxShadow:"2px 2px 8px 0px rgba(0, 0, 0, 0.25)"}}),r.jsxs("div",{className:"absolute inset-0 flex pointer-events-none",children:[r.jsx("div",{className:"flex-1 flex items-center justify-center",children:r.jsx("span",{className:`text-4xl font-semibold transition-colors duration-300 ${e==="income"?"text-white":"text-gray-400"}`,style:{fontFamily:'"Noto Sans Devanagari", sans-serif',fontSize:"16px",fontWeight:"600",lineHeight:"100%"},children:"Доход"})}),r.jsx("div",{className:"flex-1 flex items-center justify-center",children:r.jsx("span",{className:`text-4xl font-semibold transition-colors duration-300 ${e==="expense"?"text-white":"text-gray-400"}`,style:{fontFamily:'"Noto Sans Devanagari", sans-serif',fontSize:"16px",fontWeight:"600",lineHeight:"100%"},children:"Расход"})})]})]})})})},wh=({value:e="actual",onChange:t,disabled:n=!1})=>{const s=()=>{if(n)return;const a=e==="actual"?"planned":"actual";t==null||t(a)};return r.jsx("div",{className:"flex justify-center",children:r.jsx("div",{className:"relative",style:{width:"400px"},children:r.jsxs("div",{className:`relative w-full border-4 border-gray-200 bg-gray-100 cursor-pointer overflow-hidden transition-all duration-300 ${n?"opacity-50 cursor-not-allowed":"hover:border-gray-300"}`,style:{width:"400px",height:"60px",borderRadius:"16px",border:"2px solid #E5E7EB",background:"#F3F4F6"},onClick:s,children:[r.jsx("div",{className:`absolute top-1 transition-all duration-300 shadow-xl flex items-center justify-center ${e==="actual"?"left-1 bg-blue-500":"bg-orange-500"}`,style:{width:"190px",height:"48px",borderRadius:"10px",left:e==="actual"?"5px":"200px",background:e==="actual"?"#2563EB":"#FF8A36",boxShadow:"2px 2px 8px 0px rgba(0, 0, 0, 0.25)"}}),r.jsxs("div",{className:"absolute inset-0 flex pointer-events-none",children:[r.jsx("div",{className:"flex-1 flex items-center justify-center",children:r.jsx("span",{className:`text-4xl font-semibold transition-colors duration-300 ${e==="actual"?"text-white":"text-gray-400"}`,style:{fontFamily:'"Noto Sans Devanagari", sans-serif',fontSize:"16px",fontWeight:"600",lineHeight:"100%"},children:"Факт"})}),r.jsx("div",{className:"flex-1 flex items-center justify-center",children:r.jsx("span",{className:`text-4xl font-semibold transition-colors duration-300 ${e==="planned"?"text-white":"text-gray-400"}`,style:{fontFamily:'"Noto Sans Devanagari", sans-serif',fontSize:"16px",fontWeight:"600",lineHeight:"100%"},children:"План"})})]})]})})})},ov=({value:e=!1,onChange:t,disabled:n=!1})=>{const s=()=>{n||t==null||t(!e)};return r.jsxs("div",{className:"flex items-center gap-16",children:[r.jsxs("label",{className:`relative inline-block cursor-pointer ${n?"opacity-50 cursor-not-allowed":""}`,children:[r.jsx("input",{type:"checkbox",checked:e,onChange:s,disabled:n,className:"opacity-0 w-0 h-0"}),r.jsx("span",{className:`absolute cursor-pointer top-0 left-0 right-0 bottom-0 transition-colors duration-400 ${e?"bg-blue-600":"bg-gray-300"}`,style:{width:"51px",height:"31px",borderRadius:"34px"},children:r.jsx("span",{className:`absolute bg-white transition-transform duration-400 shadow-md ${e?"transform translate-x-5":""}`,style:{height:"27px",width:"27px",left:"2px",bottom:"2px",borderRadius:"50%",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"}})})]}),r.jsx("span",{className:"text-lg font-medium mt-1",style:{fontFamily:'"Noto Sans Devanagari", sans-serif',fontSize:"16px",fontWeight:"500",color:"#374151"},children:"Перевод между кассами"})]})},iv=({value:e=!1,onChange:t,disabled:n=!1})=>{const s=()=>{n||t==null||t(!e)};return r.jsxs("div",{className:"flex items-center gap-16",children:[r.jsxs("label",{className:`relative inline-block cursor-pointer ${n?"opacity-50 cursor-not-allowed":""}`,children:[r.jsx("input",{type:"checkbox",checked:e,onChange:s,disabled:n,className:"opacity-0 w-0 h-0"}),r.jsx("span",{className:`absolute cursor-pointer top-0 left-0 right-0 bottom-0 transition-colors duration-400 ${e?"bg-blue-600":"bg-gray-300"}`,style:{width:"51px",height:"31px",borderRadius:"34px"},children:r.jsx("span",{className:`absolute bg-white transition-transform duration-400 shadow-md ${e?"transform translate-x-5":""}`,style:{height:"27px",width:"27px",left:"2px",bottom:"2px",borderRadius:"50%",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"}})})]}),r.jsx("span",{className:"text-lg font-medium mt-1",style:{fontFamily:'"Noto Sans Devanagari", sans-serif',fontSize:"16px",fontWeight:"500",color:"#374151"},children:"Зарплата"})]})},Ts=({label:e="Дата",value:t="",onChange:n,disabled:s=!1,error:a=""})=>{const[l,o]=p.useState(!1),[i,c]=p.useState(new Date),[u,f]=p.useState(t?new Date(t):new Date),d=p.useRef(null),y=["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"];p.useEffect(()=>{const k=j=>{d.current&&!d.current.contains(j.target)&&o(!1)};return document.addEventListener("mousedown",k),()=>{document.removeEventListener("mousedown",k)}},[]);const g=()=>{s||(o(!l),!l&&t&&c(new Date(t)))},b=k=>{if(!k)return"";const j=String(k.getDate()).padStart(2,"0"),N=String(k.getMonth()+1).padStart(2,"0"),w=k.getFullYear();return`${j}/${N}/${w}`},v=k=>{f(k);const j=k.toISOString().split("T")[0];n==null||n(j),o(!1)},S=()=>{c(new Date(i.getFullYear(),i.getMonth()-1,1))},x=()=>{c(new Date(i.getFullYear(),i.getMonth()+1,1))},h=(k,j=!1)=>{const N=new Date(i.getFullYear(),i.getMonth(),k),w=N.toDateString()===new Date().toDateString(),C=t&&N.toDateString()===new Date(t).toDateString();return r.jsx("div",{className:`aspect-square flex items-center justify-center text-sm cursor-pointer rounded-lg transition-all duration-200 ${j?"text-gray-300":C?"bg-blue-600 text-white font-semibold":w?"bg-blue-500 text-white font-semibold":"text-gray-700 hover:bg-blue-100"}`,onClick:()=>!j&&v(N),children:k},`${k}-${j}`)},m=()=>{const k=new Date(i.getFullYear(),i.getMonth(),1),j=new Date(i.getFullYear(),i.getMonth()+1,0);let N=k.getDay();N=N===0?6:N-1;const w=[],C=new Date(i.getFullYear(),i.getMonth(),0);for(let E=N-1;E>=0;E--)w.push(h(C.getDate()-E,!0));for(let E=1;E<=j.getDate();E++)w.push(h(E,!1));const _=42-w.length;for(let E=1;E<=_;E++)w.push(h(E,!0));return w};return r.jsxs("div",{className:"relative",ref:d,children:[r.jsx("label",{className:"absolute -top-3 left-4 bg-white px-2 text-gray-500 z-20",style:{fontFamily:'"Noto Sans Devanagari", sans-serif',fontSize:"14px",fontWeight:"500",color:"#6B7280"},children:e}),r.jsxs("div",{className:`w-full border-2 bg-gray-50 rounded-full px-10 flex items-center justify-between cursor-pointer outline-none transition-colors duration-200 ${a?"border-red-500":l?"border-blue-600":"border-gray-300 hover:border-gray-400"} ${s?"opacity-50 cursor-not-allowed":""}`,style:{width:"400px",height:"56px",borderRadius:"12px",border:a?"2px solid #EF4444":l?"2px solid #3B82F6":"2px solid #E5E7EB",background:"#FDFDFD",paddingLeft:"16px",paddingRight:"16px"},onClick:g,children:[r.jsx("span",{className:"text-gray-900",style:{fontSize:"16px",fontWeight:"400",fontFamily:'"Noto Sans Devanagari", sans-serif'},children:t?b(new Date(t)):"Выберите дату"}),r.jsx("svg",{className:"w-6 h-6 text-gray-500",viewBox:"0 0 24 24",fill:"currentColor",children:r.jsx("path",{d:"M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"})})]}),l&&!s&&r.jsxs("div",{className:"absolute top-full left-0 mt-2 bg-white border-2 border-gray-300 rounded-2xl shadow-lg z-30 p-4",style:{borderRadius:"12px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",width:"280px"},children:[r.jsxs("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("button",{className:"text-gray-600 hover:bg-gray-100 p-1 rounded-lg transition-colors text-lg",onClick:S,type:"button",children:"‹"}),r.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:[y[i.getMonth()]," ",i.getFullYear()]}),r.jsx("button",{className:"text-gray-600 hover:bg-gray-100 p-1 rounded-lg transition-colors text-lg",onClick:x,type:"button",children:"›"})]}),r.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[["Пн","Вт","Ср","Чт","Пт","Сб","Вс"].map(k=>r.jsx("div",{className:"text-center text-xs font-medium text-gray-500 p-1",children:k},k)),m()]})]}),a&&r.jsx("p",{className:"mt-2 text-red-600 px-4",style:{fontFamily:'"Noto Sans Devanagari", sans-serif',fontSize:"14px",fontWeight:"400"},children:a})]})},cv=({isOpen:e,onClose:t,onSuccess:n,onError:s})=>{const{getAuthHeader:a}=Rt(),[l,o]=p.useState({type:"income",status:"actual",isTransfer:!1,isSalary:!1,amount:"",category:"",email:"",employee:"",cashDesk:"",cashDeskFrom:"",cashDeskTo:"",date:new Date().toISOString().split("T")[0],description:""}),[i,c]=p.useState("inactive"),[u,f]=p.useState(!1),[d,y]=p.useState({}),[g,b]=p.useState([]);p.useEffect(()=>{e&&(async()=>{try{const k=await a();if(console.log("🔍 Auth headers:",k),!k.Authorization){console.warn("⚠️ Токен авторизации недоступен"),b([{value:"1",label:"Основная касса"},{value:"2",label:"Касса №2"},{value:"3",label:"Наличные"},{value:"4",label:"Банковская карта"},{value:"5",label:"Онлайн касса"},{value:"6",label:"Резервная касса"}]);return}const j=await fetch(`${xt}/cash-desks`,{method:"GET",headers:k});if(console.log("🔍 API response status:",j.status),j.ok){const N=await j.json();console.log("✅ Кассы загружены:",N);const w=N.map(C=>({value:C.id.toString(),label:C.name}));b(w)}else{const N=await j.text();throw console.error("❌ Ошибка API:",j.status,N),j.status===403&&console.error("❌ Токен недействителен, используем fallback данные"),new Error(`API Error: ${j.status}`)}}catch(k){console.error("❌ Ошибка загрузки касс:",k),b([{value:"1",label:"Основная касса"},{value:"2",label:"Касса №2"},{value:"3",label:"Наличные"},{value:"4",label:"Банковская карта"},{value:"5",label:"Онлайн касса"},{value:"6",label:"Резервная касса"}])}})()},[e]),p.useEffect(()=>{let m=!1;l.isTransfer?m=l.cashDeskFrom&&l.cashDeskTo&&l.amount&&l.date:l.isSalary?m=l.employee&&l.cashDesk&&l.amount&&l.date:m=l.amount&&l.category&&l.cashDesk&&l.date,c(u?"loading":m?"active":"inactive")},[l,u]);const v=(m,k)=>{o(m==="isTransfer"&&k===!0?j=>({...j,[m]:k,isSalary:!1}):m==="isSalary"&&k===!0?j=>({...j,[m]:k,isTransfer:!1}):j=>({...j,[m]:k})),d[m]&&y(j=>({...j,[m]:""}))},S=()=>{const m={};return(!l.amount||isNaN(l.amount)||Number(l.amount)<=0)&&(m.amount="Введите корректную сумму"),l.isTransfer?(l.cashDeskFrom||(m.cashDeskFrom="Выберите кассу отправителя"),l.cashDeskTo||(m.cashDeskTo="Выберите кассу получателя"),l.cashDeskFrom===l.cashDeskTo&&l.cashDeskFrom&&(m.cashDeskTo="Касса получатель должна отличаться от кассы отправителя")):l.isSalary?(l.employee.trim()||(m.employee="Укажите сотрудника"),l.cashDesk||(m.cashDesk="Выберите кассу")):(l.category.trim()||(m.category="Категория обязательна"),l.cashDesk||(m.cashDesk="Выберите кассу")),l.date||(m.date="Дата обязательна"),y(m),Object.keys(m).length===0},x=async()=>{if(!(i==="inactive"||u)){if(!S()){c("error"),setTimeout(()=>c("active"),2e3);return}try{f(!0),c("loading");let m={};l.isTransfer?m={isTransfer:!0,amount:Math.abs(Number(l.amount)),cashDeskFromId:Number(l.cashDeskFrom),cashDeskToId:Number(l.cashDeskTo),date:l.date,description:l.description||"Перевод между кассами"}:l.isSalary?m={type:"expense",status:l.status,amount:Math.abs(Number(l.amount)),employee:l.employee,cash_desk_id:Number(l.cashDesk),date:l.date,description:l.description,category:"Зарплата"}:(m={type:l.type,status:l.status,amount:Math.abs(Number(l.amount)),category:l.category,cash_desk_id:Number(l.cashDesk),date:l.date,description:l.description},l.email&&l.email.trim()&&(m.email=l.email.trim())),console.log("🔍 Отправляемые данные:",m),await(n==null?void 0:n(m)),c("success"),setTimeout(()=>{h()},1e3)}catch(m){console.error("❌ Ошибка при создании операции:",m),c("error"),s==null||s(m.message||"Ошибка при создании операции"),setTimeout(()=>{S()?c("active"):c("inactive")},2e3)}finally{f(!1)}}},h=()=>{o({type:"income",status:"actual",isTransfer:!1,isSalary:!1,amount:"",category:"",email:"",employee:"",cashDesk:"",cashDeskFrom:"",cashDeskTo:"",date:new Date().toISOString().split("T")[0],description:""}),b([]),c("inactive"),y({}),f(!1),t==null||t()};return e?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-3xl shadow-xl w-450 max-w-5xl max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[r.jsx("h2",{className:"text-2xl font-semibold text-gray-800",style:{fontFamily:'"Noto Sans Devanagari", sans-serif'},children:"Добавить операцию"}),r.jsx("button",{onClick:h,className:"text-gray-400 hover:text-gray-600 transition-colors p-2",disabled:u,children:r.jsx(Fe,{className:"w-6 h-6"})})]}),r.jsxs("div",{className:"p-8 space-y-8",children:[r.jsxs("div",{className:"flex flex-col gap-4",children:[r.jsx(ov,{value:l.isTransfer,onChange:m=>v("isTransfer",m),disabled:u}),r.jsx(iv,{value:l.isSalary,onChange:m=>v("isSalary",m),disabled:u})]}),!l.isTransfer&&!l.isSalary&&r.jsx(bh,{value:l.type,onChange:m=>v("type",m),disabled:u}),!l.isTransfer&&r.jsx(wh,{value:l.status,onChange:m=>v("status",m),disabled:u}),l.isTransfer?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"flex justify-center",children:r.jsx(qe,{label:"Касса отправитель",placeholder:"Выберите кассу отправителя",value:l.cashDeskFrom,onChange:m=>v("cashDeskFrom",m),options:g,disabled:u,error:d.cashDeskFrom})}),r.jsx("div",{className:"flex justify-center",children:r.jsx(qe,{label:"Касса получатель",placeholder:"Выберите кассу получателя",value:l.cashDeskTo,onChange:m=>v("cashDeskTo",m),options:g,disabled:u,error:d.cashDeskTo})}),r.jsx("div",{className:"flex justify-center",children:r.jsx(ue,{label:"Сумма",placeholder:"Введите сумму",type:"number",value:l.amount,onChange:m=>v("amount",m),disabled:u,error:d.amount})}),r.jsx("div",{className:"flex justify-center",children:r.jsx(Ts,{label:"Дата",value:l.date,onChange:m=>v("date",m),disabled:u,error:d.date})}),r.jsx("div",{className:"flex justify-center",children:r.jsx(ue,{label:"Описание",placeholder:"Введите описание перевода",value:l.description,onChange:m=>v("description",m),disabled:u,error:d.description})})]}):l.isSalary?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"flex justify-center",children:r.jsx(ue,{label:"Telegram ID",placeholder:"@username",value:l.employee,onChange:m=>v("employee",m),disabled:u,error:d.employee})}),r.jsx("div",{className:"flex justify-center",children:r.jsx(qe,{label:"Касса",placeholder:"Выберите кассу",value:l.cashDesk,onChange:m=>v("cashDesk",m),options:g,disabled:u,error:d.cashDesk})}),r.jsx("div",{className:"flex justify-center",children:r.jsx(ue,{label:"Сумма",placeholder:"Введите сумму зарплаты",type:"number",value:l.amount,onChange:m=>v("amount",m),disabled:u,error:d.amount})}),r.jsx("div",{className:"flex justify-center",children:r.jsx(Ts,{label:"Дата",value:l.date,onChange:m=>v("date",m),disabled:u,error:d.date})}),r.jsx("div",{className:"flex justify-center",children:r.jsx(ue,{label:"Описание",placeholder:"Дополнительное описание",value:l.description,onChange:m=>v("description",m),disabled:u,error:d.description})})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"flex justify-center",children:r.jsx(ue,{label:"Категория",placeholder:"Введите категорию",value:l.category,onChange:m=>v("category",m),disabled:u,error:d.category})}),r.jsx("div",{className:"flex justify-center",children:r.jsx(ue,{label:"Почта",placeholder:"example@email.ru",value:l.email,onChange:m=>v("email",m),disabled:u,error:d.email})}),r.jsx("div",{className:"flex justify-center",children:r.jsx(qe,{label:"Касса",placeholder:"Выберите кассу",value:l.cashDesk,onChange:m=>v("cashDesk",m),options:g,disabled:u,error:d.cashDesk})}),r.jsx("div",{className:"flex justify-center",children:r.jsx(ue,{label:"Сумма",placeholder:"Введите сумму",type:"number",value:l.amount,onChange:m=>v("amount",m),disabled:u,error:d.amount})}),r.jsx("div",{className:"flex justify-center",children:r.jsx(Ts,{label:"Дата",value:l.date,onChange:m=>v("date",m),disabled:u,error:d.date})}),r.jsx("div",{className:"flex justify-center",children:r.jsx(ue,{label:"Описание",placeholder:"Введите описание операции",value:l.description,onChange:m=>v("description",m),disabled:u,error:d.description})})]}),r.jsxs("div",{className:"flex justify-center gap-12",children:[r.jsx(Bl,{onClick:h,disabled:u}),r.jsx(Ul,{state:i,onClick:x,text:"Добавить",loadingText:"Отправка...",successText:"Успешно!",errorText:"Повторить",disabled:u})]})]})]})}):null},uv=({isOpen:e,onClose:t,onSuccess:n,onError:s,finance:a})=>{const{getAuthHeader:l}=Rt(),o=(a==null?void 0:a.category)==="Зарплата",[i,c]=p.useState({type:"income",status:"actual",amount:"",category:"",email:"",employee:"",cashDesk:"",date:new Date().toISOString().split("T")[0],description:""}),[u,f]=p.useState("inactive"),[d,y]=p.useState(!1),[g,b]=p.useState({}),[v,S]=p.useState([]);p.useEffect(()=>{(async()=>{var C,_;if(!e||!a)return;console.log("🔍 Инициализация формы с данными:",a),console.log("🔍 client_id:",a.client_id),console.log("🔍 worker_id:",a.worker_id),console.log("🔍 category:",a.category);let N="",w="";try{const E=await l();if(console.log("🔍 Auth headers available:",!!E.Authorization),a.client_id)if(console.log("🔄 Загружаем клиента с ID:",a.client_id),!E.Authorization)console.error("❌ Нет токена авторизации для загрузки клиента");else try{const T=await fetch(`${xt}/clients/${a.client_id}`,{headers:E});if(console.log("🔍 Client response status:",T.status),T.ok){const L=await T.json();console.log("🔍 Client response data:",L),N=L.email||"",console.log("✅ Email клиента загружен:",N)}else{const L=await T.text();console.error("❌ Client API error:",T.status,L)}}catch(T){console.warn("⚠️ Не удалось загрузить email клиента:",T)}else console.log("⚠️ client_id отсутствует в объекте finance");if(a.worker_id)if(console.log("🔄 Загружаем работника с ID:",a.worker_id),!E.Authorization)console.error("❌ Нет токена авторизации для загрузки работника");else try{const T=await fetch(`${xt}/workers/${a.worker_id}`,{headers:E});if(console.log("🔍 Worker response status:",T.status),T.ok){const L=await T.json();console.log("🔍 Worker response data:",L),w=L.telegram_username||"",console.log("✅ Telegram работника загружен:",w)}else{const L=await T.text();console.error("❌ Worker API error:",T.status,L)}}catch(T){console.warn("⚠️ Не удалось загрузить telegram работника:",T)}else console.log("⚠️ worker_id отсутствует в объекте finance")}catch(E){console.warn("⚠️ Ошибка при загрузке дополнительных данных:",E)}c({type:Number(a.amount)>=0?"income":"expense",status:a.status||"actual",amount:Math.abs(Number(a.amount)).toString(),category:a.category||"",email:N,employee:w,cashDesk:((C=a.cash_desk_id)==null?void 0:C.toString())||((_=a.cashDeskId)==null?void 0:_.toString())||"",date:a.date?a.date.split("T")[0]:new Date().toISOString().split("T")[0],description:a.description||""}),console.log("✅ Форма инициализирована:",{email:N,employee:w,category:a.category,client_id:a.client_id,worker_id:a.worker_id,formData:{email:N,employee:w}})})()},[e,a]),p.useEffect(()=>{e&&(async()=>{try{const N=await l();if(console.log("🔍 Auth headers:",N),!N.Authorization){console.warn("⚠️ Токен авторизации недоступен"),S([{value:"1",label:"Основная касса"},{value:"2",label:"Касса №2"},{value:"3",label:"Наличные"},{value:"4",label:"Банковская карта"},{value:"5",label:"Онлайн касса"},{value:"6",label:"Резервная касса"}]);return}const w=await fetch(`${xt}/cash-desks`,{method:"GET",headers:N});if(console.log("🔍 API response status:",w.status),w.ok){const C=await w.json();console.log("✅ Кассы загружены:",C);const _=C.map(E=>({value:E.id.toString(),label:E.name}));S(_)}else{const C=await w.text();throw console.error("❌ Ошибка API:",w.status,C),w.status===403&&console.error("❌ Токен недействителен, используем fallback данные"),new Error(`API Error: ${w.status}`)}}catch(N){console.error("❌ Ошибка загрузки касс:",N),S([{value:"1",label:"Основная касса"},{value:"2",label:"Касса №2"},{value:"3",label:"Наличные"},{value:"4",label:"Банковская карта"},{value:"5",label:"Онлайн касса"},{value:"6",label:"Резервная касса"}])}})()},[e]),p.useEffect(()=>{let j=!1;o?j=i.employee&&i.cashDesk&&i.amount&&i.date:j=i.amount&&i.category&&i.cashDesk&&i.date,f(d?"loading":j?"active":"inactive")},[i,d,o]);const x=(j,N)=>{c(w=>({...w,[j]:N})),g[j]&&b(w=>({...w,[j]:""}))},h=()=>{const j={};return(!i.amount||isNaN(i.amount)||Number(i.amount)<=0)&&(j.amount="Введите корректную сумму"),o?(i.employee.trim()||(j.employee="Укажите Telegram ID сотрудника"),i.cashDesk||(j.cashDesk="Выберите кассу")):(i.category.trim()||(j.category="Категория обязательна"),i.cashDesk||(j.cashDesk="Выберите кассу")),i.date||(j.date="Дата обязательна"),b(j),Object.keys(j).length===0},m=async()=>{if(!(u==="inactive"||d)){if(!h()){f("error"),setTimeout(()=>f("active"),2e3);return}try{y(!0),f("loading");const j=await l();let N=null,w=null;if(i.email&&i.email.trim()){console.log("🔍 Поиск клиента по email:",i.email);const _=`${xt}/clients?search=${encodeURIComponent(i.email)}&filter=email`;console.log("🔍 Search URL:",_);try{const E=await fetch(_,{headers:j});if(console.log("🔍 Clients search response status:",E.status),E.ok){const T=await E.json();console.log("🔍 Clients search result (RAW):",T);const L=T.data||T;if(console.log("🔍 Final clients data array:",L),Array.isArray(L)&&L.length>0){console.log("🔍 All found clients:",L.map(V=>({id:V.id,email:V.email,name:V.name})));const U=L.find(V=>{var B,F;const Y=(F=(B=V.email)==null?void 0:B.toLowerCase)==null?void 0:F.call(B),M=i.email.toLowerCase();return console.log("🔍 Comparing emails:",{clientEmail:Y,searchEmail:M,match:Y===M}),Y===M});U?(N=U.id,console.log("✅ Клиент найден по email:",{email:i.email,clientId:N,clientName:U.name})):console.log("⚠️ Клиент с точным email не найден в результатах поиска")}else console.log("⚠️ Нет клиентов в ответе")}else{const T=await E.text();console.error("❌ Clients search API error:",E.status,T)}}catch(E){console.warn("⚠️ Ошибка поиска клиента:",E)}}else console.log("⚠️ Email не указан или пустой:",i.email);if(o&&i.employee&&i.employee.trim()){console.log("🔍 Поиск работника по telegram:",i.employee);const _=`${xt}/workers?search=${encodeURIComponent(i.employee)}&filter=telegram`;console.log("🔍 Worker search URL:",_);try{const E=await fetch(_,{headers:j});if(console.log("🔍 Workers search response status:",E.status),E.ok){const T=await E.json();console.log("🔍 Workers search result (RAW):",T);const L=T.data||T;if(Array.isArray(L)&&L.length>0){console.log("🔍 All found workers:",L.map(V=>({id:V.id,telegram_username:V.telegram_username,full_name:V.full_name})));const U=L.find(V=>{if(!V.telegram_username)return!1;const Y=V.telegram_username.replace(/^@/,"").toLowerCase(),M=i.employee.replace(/^@/,"").toLowerCase();return console.log("🔍 Comparing telegrams:",{workerTelegram:Y,searchTelegram:M,match:Y===M}),Y===M});U?(w=U.id,console.log("✅ Работник найден по telegram:",{employee:i.employee,workerId:w,workerName:U.full_name})):console.log("⚠️ Работник с точным telegram не найден в результатах поиска")}else console.log("⚠️ Нет работников в ответе")}else{const T=await E.text();console.error("❌ Workers search API error:",E.status,T)}}catch(E){console.warn("⚠️ Ошибка поиска работника:",E)}}console.log("🔍 Финальные найденные ID:",{finalClientId:N,finalWorkerId:w});let C={};o?(C={type:"expense",status:i.status,amount:Math.abs(Number(i.amount)),cash_desk_id:Number(i.cashDesk),cashDeskId:Number(i.cashDesk),date:i.date,description:i.description,category:"Зарплата"},w&&(C.worker_id=w,C.workerId=w,console.log("✅ Добавлен worker_id в данные:",w))):(C={type:i.type,status:i.status,amount:Math.abs(Number(i.amount)),category:i.category,cash_desk_id:Number(i.cashDesk),date:i.date,description:i.description},N&&(C.client_id=N,console.log("✅ Добавлен client_id в данные:",N))),console.log("🔍 Отправляемые данные для редактирования:",C),console.log("🔍 submitData.client_id:",C.client_id),console.log("🔍 Полная структура submitData:",JSON.stringify(C,null,2)),await(n==null?void 0:n(C)),f("success"),setTimeout(()=>{k()},1e3)}catch(j){console.error("❌ Ошибка при редактировании операции:",j),f("error"),s==null||s(j.message||"Ошибка при редактировании операции"),setTimeout(()=>{h()?f("active"):f("inactive")},2e3)}finally{y(!1)}}},k=()=>{c({type:"income",status:"actual",amount:"",category:"",email:"",employee:"",cashDesk:"",date:new Date().toISOString().split("T")[0],description:""}),S([]),f("inactive"),b({}),y(!1),t==null||t()};return!e||!a?null:r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-white rounded-3xl shadow-xl w-full max-w-md max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[r.jsx("h2",{className:"text-2xl font-semibold text-gray-800",style:{fontFamily:'"Noto Sans Devanagari", sans-serif'},children:"Редактировать"}),r.jsx("button",{onClick:k,className:"text-gray-400 hover:text-gray-600 transition-colors p-2",disabled:d,children:r.jsx(Fe,{className:"w-6 h-6"})})]}),r.jsxs("div",{className:"p-8 space-y-8",children:[!o&&r.jsx(bh,{value:i.type,onChange:j=>x("type",j),disabled:d}),r.jsx(wh,{value:i.status,onChange:j=>x("status",j),disabled:d}),o?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"flex justify-center",children:r.jsx(ue,{label:"TelegramID",placeholder:"@username",value:i.employee,onChange:j=>x("employee",j),disabled:d,error:g.employee})}),r.jsx("div",{className:"flex justify-center",children:r.jsx(qe,{label:"Касса",placeholder:"Выберите кассу",value:i.cashDesk,onChange:j=>x("cashDesk",j),options:v,disabled:d,error:g.cashDesk})}),r.jsx("div",{className:"flex justify-center",children:r.jsx(ue,{label:"Сумма",placeholder:"Введите сумму",type:"number",value:i.amount,onChange:j=>x("amount",j),disabled:d,error:g.amount})}),r.jsx("div",{className:"flex justify-center",children:r.jsx(Ts,{label:"Дата",value:i.date,onChange:j=>x("date",j),disabled:d,error:g.date})}),r.jsx("div",{className:"flex justify-center",children:r.jsx(ue,{label:"Описание",placeholder:"Введите описание",value:i.description,onChange:j=>x("description",j),disabled:d,error:g.description})})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"flex justify-center",children:r.jsx(ue,{label:"Категория",placeholder:"Введите категорию",value:i.category,onChange:j=>x("category",j),disabled:d,error:g.category})}),r.jsx("div",{className:"flex justify-center",children:r.jsx(ue,{label:"Почта",placeholder:"Введите почту",value:i.email,onChange:j=>x("email",j),disabled:d,error:g.email})}),r.jsx("div",{className:"flex justify-center",children:r.jsx(qe,{label:"Касса",placeholder:"Выберите кассу",value:i.cashDesk,onChange:j=>x("cashDesk",j),options:v,disabled:d,error:g.cashDesk})}),r.jsx("div",{className:"flex justify-center",children:r.jsx(ue,{label:"Сумма",placeholder:"Введите сумму",type:"number",value:i.amount,onChange:j=>x("amount",j),disabled:d,error:g.amount})}),r.jsx("div",{className:"flex justify-center",children:r.jsx(Ts,{label:"Дата",value:i.date,onChange:j=>x("date",j),disabled:d,error:g.date})}),r.jsx("div",{className:"flex justify-center",children:r.jsx(ue,{label:"Описание",placeholder:"Введите описание",value:i.description,onChange:j=>x("description",j),disabled:d,error:g.description})})]}),r.jsxs("div",{className:"flex justify-center gap-12",children:[r.jsx(Bl,{onClick:k,disabled:d}),r.jsx(Ul,{state:u,onClick:m,text:"Сохранить",loadingText:"Сохранение...",successText:"Сохранено!",errorText:"Повторить",disabled:d})]}),r.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200",children:[r.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Информация об операции:"}),r.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[r.jsxs("div",{children:["ID: ",a.id]}),r.jsxs("div",{children:["Создана: ",new Date(a.created_at).toLocaleDateString("ru-RU")]}),a.updated_at&&a.updated_at!==a.created_at&&r.jsxs("div",{children:["Изменена: ",new Date(a.updated_at).toLocaleDateString("ru-RU")]}),a.cash_desk_name&&r.jsxs("div",{children:["Текущая касса: ",a.cash_desk_name]}),a.client_name&&r.jsxs("div",{children:["Текущий клиент: ",a.client_name]})]})]})]})]})})},dv=({isOpen:e,onClose:t,onSuccess:n,onError:s})=>{const[a,l]=p.useState({name:"",current_balance:"0",description:"",is_active:!0}),[o,i]=p.useState(!1),[c,u]=p.useState({}),f=async g=>{var v;g.preventDefault();const b={};if(a.name.trim()||(b.name="Название кассы обязательно"),(isNaN(a.current_balance)||Number(a.current_balance)<0)&&(b.current_balance="Начальный баланс должен быть положительным числом"),Object.keys(b).length>0){u(b);return}try{i(!0),u({});const S={name:a.name.trim(),current_balance:parseFloat(a.current_balance),description:a.description.trim(),is_active:a.is_active};await n(S),d()}catch(S){console.error("Ошибка создания кассы:",S),(v=S.message)!=null&&v.includes("уже существует")?u({name:"Касса с таким названием уже существует"}):s(S.message||"Ошибка при создании кассы")}finally{i(!1)}},d=()=>{l({name:"",current_balance:"0",description:"",is_active:!0}),u({}),i(!1),t()},y=(g,b)=>{l(v=>({...v,[g]:b})),c[g]&&u(v=>({...v,[g]:""}))};return e?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:[r.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:r.jsx(dn,{className:"w-5 h-5 text-blue-600"})}),r.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Создать кассу"})]}),r.jsx("button",{onClick:d,className:"text-gray-400 hover:text-gray-500 transition-colors",disabled:o,children:r.jsx(Fe,{className:"w-6 h-6"})})]}),r.jsxs("form",{onSubmit:f,className:"p-6 space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Название кассы *"}),r.jsx("input",{type:"text",id:"name",value:a.name,onChange:g=>y("name",g.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${c.name?"border-red-300":"border-gray-300"}`,placeholder:"Введите название кассы",disabled:o}),c.name&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.name})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"current_balance",className:"block text-sm font-medium text-gray-700 mb-1",children:"Начальный баланс"}),r.jsxs("div",{className:"relative",children:[r.jsx(Xe,{className:"absolute left-3 top-2.5 w-4 h-4 text-gray-400"}),r.jsx("input",{type:"number",id:"current_balance",value:a.current_balance,onChange:g=>y("current_balance",g.target.value),step:"0.01",min:"0",className:`w-full pl-9 pr-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${c.current_balance?"border-red-300":"border-gray-300"}`,placeholder:"0.00",disabled:o})]}),c.current_balance&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.current_balance})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Описание"}),r.jsx("textarea",{id:"description",value:a.description,onChange:g=>y("description",g.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Опишите назначение кассы (необязательно)",disabled:o})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",id:"is_active",checked:a.is_active,onChange:g=>y("is_active",g.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500",disabled:o}),r.jsx("label",{htmlFor:"is_active",className:"ml-2 text-sm text-gray-700",children:"Активная касса"})]}),r.jsxs("div",{className:"flex space-x-3 pt-4",children:[r.jsx("button",{type:"button",onClick:d,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",disabled:o,children:"Отмена"}),r.jsx("button",{type:"submit",disabled:o,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center transition-colors",children:o?r.jsxs(r.Fragment,{children:[r.jsx(Pe,{className:"w-4 h-4 animate-spin mr-2"}),"Создание..."]}):"Создать кассу"})]})]})]})}):null},mv=({isOpen:e,onClose:t,onSuccess:n,onError:s,cashDesk:a})=>{const[l,o]=p.useState({name:"",current_balance:"0",description:"",is_active:!0}),[i,c]=p.useState(!1),[u,f]=p.useState({});p.useEffect(()=>{var b;e&&a&&(o({name:a.name||"",current_balance:((b=a.current_balance)==null?void 0:b.toString())||"0",description:a.description||"",is_active:a.is_active??!0}),f({}))},[e,a]);const d=async b=>{var S;b.preventDefault();const v={};if(l.name.trim()||(v.name="Название кассы обязательно"),(isNaN(l.current_balance)||Number(l.current_balance)<0)&&(v.current_balance="Баланс должен быть положительным числом"),Object.keys(v).length>0){f(v);return}try{c(!0),f({});const x={name:l.name.trim(),current_balance:parseFloat(l.current_balance),description:l.description.trim(),is_active:l.is_active};await n(x),y()}catch(x){console.error("Ошибка обновления кассы:",x),(S=x.message)!=null&&S.includes("уже существует")?f({name:"Касса с таким названием уже существует"}):s(x.message||"Ошибка при обновлении кассы")}finally{c(!1)}},y=()=>{o({name:"",current_balance:"0",description:"",is_active:!0}),f({}),c(!1),t()},g=(b,v)=>{o(S=>({...S,[b]:v})),u[b]&&f(S=>({...S,[b]:""}))};return!e||!a?null:r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:[r.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:r.jsx(dn,{className:"w-5 h-5 text-blue-600"})}),r.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Редактировать кассу"})]}),r.jsx("button",{onClick:y,className:"text-gray-400 hover:text-gray-500 transition-colors",disabled:i,children:r.jsx(Fe,{className:"w-6 h-6"})})]}),r.jsxs("form",{onSubmit:d,className:"p-6 space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Название кассы *"}),r.jsx("input",{type:"text",id:"name",value:l.name,onChange:b=>g("name",b.target.value),className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${u.name?"border-red-300":"border-gray-300"}`,placeholder:"Введите название кассы",disabled:i}),u.name&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.name})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"current_balance",className:"block text-sm font-medium text-gray-700 mb-1",children:"Текущий баланс"}),r.jsxs("div",{className:"relative",children:[r.jsx(Xe,{className:"absolute left-3 top-2.5 w-4 h-4 text-gray-400"}),r.jsx("input",{type:"number",id:"current_balance",value:l.current_balance,onChange:b=>g("current_balance",b.target.value),step:"0.01",min:"0",className:`w-full pl-9 pr-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${u.current_balance?"border-red-300":"border-gray-300"}`,placeholder:"0.00",disabled:i})]}),u.current_balance&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.current_balance})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Описание"}),r.jsx("textarea",{id:"description",value:l.description,onChange:b=>g("description",b.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Опишите назначение кассы (необязательно)",disabled:i})]}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",id:"is_active",checked:l.is_active,onChange:b=>g("is_active",b.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500",disabled:i}),r.jsx("label",{htmlFor:"is_active",className:"ml-2 text-sm text-gray-700",children:"Активная касса"})]}),a&&r.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg text-xs text-gray-600 space-y-1",children:[r.jsxs("div",{children:["Создана: ",new Date(a.created_at).toLocaleDateString("ru-RU")]}),r.jsxs("div",{children:["Операций: ",a.transactions_count||0]}),a.calculated_balance!==void 0&&r.jsxs("div",{children:["Расчетный баланс: ",Number(a.calculated_balance).toLocaleString("ru-RU")," ₽"]})]}),r.jsxs("div",{className:"flex space-x-3 pt-4",children:[r.jsx("button",{type:"button",onClick:y,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",disabled:i,children:"Отмена"}),r.jsx("button",{type:"submit",disabled:i,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center transition-colors",children:i?r.jsxs(r.Fragment,{children:[r.jsx(Pe,{className:"w-4 h-4 animate-spin mr-2"}),"Сохранение..."]}):"Сохранить изменения"})]})]})]})})},fv=({selectedPeriod:e,onPeriodChange:t,loading:n=!1})=>{const s=[{value:"7",label:"7 дней"},{value:"30",label:"30 дней"},{value:"90",label:"90 дней"}],a=l=>{n||l===e||t(l)};return r.jsx("div",{className:"flex justify-center",children:r.jsx("div",{className:"flex bg-gray-100 rounded-full p-1 space-x-1",children:s.map(l=>r.jsx("button",{onClick:()=>a(l.value),disabled:n,className:`
              px-5 py-2 rounded-full text-sm font-medium transition-all duration-200 
              ${e===l.value?"bg-blue-500 text-white shadow-sm":"text-gray-600 hover:text-gray-900 hover:bg-gray-200"}
              ${n?"opacity-50 cursor-not-allowed":"cursor-pointer"}
            `,children:l.label},l.value))})})},hv=({statistics:e,cashDeskName:t})=>{var c,u,f;if(!e)return null;const n=d=>Math.abs(d)>=1e6?`${(d/1e6).toFixed(1)}M`:Math.abs(d)>=1e3?`${(d/1e3).toFixed(1)}K`:d.toLocaleString("ru-RU"),s=d=>`${d>0?"+":""}${d.toFixed(1)}%`,l=((d,y)=>{switch(d){case"growing":return{icon:sr,color:"text-green-600",bgColor:"bg-green-50",text:"Рост"};case"declining":return{icon:Br,color:"text-red-600",bgColor:"bg-red-50",text:"Снижение"};default:return{icon:E0,color:"text-gray-600",bgColor:"bg-gray-50",text:"Стабильно"}}})(e.trend,e.total_change),o=l.icon,i=[{label:"Баланс",value:`${(c=e.last_balance)==null?void 0:c.toLocaleString("ru-RU")} ₽`,subValue:null,icon:null,highlight:!0},{label:"Изменение",value:s(e.change_percentage),subValue:`${e.total_change>0?"+":""}${(u=e.total_change)==null?void 0:u.toLocaleString("ru-RU")} ₽`,icon:o,iconColor:l.color,highlight:Math.abs(e.change_percentage)>10},{label:"Операций",value:(f=e.total_transactions)==null?void 0:f.toString(),subValue:`за ${e.period_days} дн.`,icon:b0,iconColor:"text-blue-600"},{label:"Среднее",value:`${n(e.average_balance)} ₽`,subValue:"за период",icon:null}];return r.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 stats-grid",children:i.map((d,y)=>r.jsxs("div",{className:`
            stats-card bg-gray-50 rounded-xl p-4 text-center cursor-default fade-in-up
            ${d.highlight?"ring-2 ring-blue-100 bg-blue-50":""}
            hover:shadow-lg transition-all duration-200
          `,style:{animationDelay:`${y*100}ms`},children:[d.icon&&r.jsx("div",{className:"flex justify-center mb-2",children:r.jsx(d.icon,{className:`w-5 h-5 ${d.iconColor||"text-gray-600"}`})}),r.jsx("div",{className:`
            text-lg font-semibold mb-1
            ${d.highlight?"text-blue-700":"text-gray-900"}
          `,children:d.value}),d.subValue&&r.jsx("div",{className:"text-xs text-gray-500 font-medium",children:d.subValue}),r.jsx("div",{className:"text-xs text-gray-500 font-medium uppercase tracking-wide mt-1",children:d.label})]},y))})},xv=({cashDeskId:e,cashDeskName:t})=>{var N,w,C,_,E,T,L,U,V,Y,M,B;const[n,s]=p.useState([]),[a,l]=p.useState(null),[o,i]=p.useState("30"),[c,u]=p.useState(!1),[f,d]=p.useState(null),[y,g]=p.useState(null),b=p.useRef(null),{fetchCashDeskBalanceHistory:v}=Cc(),S=async(F=o)=>{try{u(!0),d(null);const D=await v(e,{period:F});if(D!=null&&D.balance_history&&(D!=null&&D.statistics)){const I=D.balance_history.map(P=>({date:P.date,balance:P.balance,dailyChange:P.daily_change,transactionsCount:P.transactions_count,displayDate:new Date(P.date).toLocaleDateString("ru-RU",{month:"short",day:"numeric"})}));s(I),l(D.statistics)}else throw new Error("Неверный формат данных")}catch(D){console.error("Ошибка загрузки данных графика:",D),d(D.message||"Ошибка загрузки данных")}finally{u(!1)}};p.useEffect(()=>{e&&S(o)},[e,o]),p.useEffect(()=>{n.length>0&&b.current&&m()},[n,y]);const x=F=>{i(F)},h=()=>{if(!a)return"#007aff";switch(a.trend){case"growing":return"#30d158";case"declining":return"#ff3b30";default:return"#007aff"}},m=()=>{const F=b.current;if(!F)return;const D=F.getContext("2d"),I=F.getBoundingClientRect(),P=window.devicePixelRatio||1;F.width=I.width*P,F.height=I.height*P,D.scale(P,P),D.clearRect(0,0,I.width,I.height);const $={top:20,right:20,bottom:40,left:60},A=I.width-$.left-$.right,K=I.height-$.top-$.bottom;if(n.length===0)return;const J=n.map(ne=>ne.balance),te=Math.min(...J),fe=Math.max(...J),Ce=fe-te||1,ye=ne=>$.left+ne/(n.length-1)*A,Z=ne=>$.top+(fe-ne)/Ce*K;D.strokeStyle="#f2f2f7",D.lineWidth=1,D.beginPath();for(let ne=0;ne<=5;ne++){const R=$.top+ne/5*K;D.moveTo($.left,R),D.lineTo($.left+A,R)}D.stroke();const Qe=D.createLinearGradient(0,$.top,0,$.top+K),ve=h();if(Qe.addColorStop(0,ve+"33"),Qe.addColorStop(1,ve+"05"),D.fillStyle=Qe,D.beginPath(),D.moveTo(ye(0),Z(n[0].balance)),n.forEach((ne,R)=>{D.lineTo(ye(R),Z(ne.balance))}),D.lineTo(ye(n.length-1),$.top+K),D.lineTo(ye(0),$.top+K),D.closePath(),D.fill(),D.shadowColor=ve+"40",D.shadowBlur=10,D.shadowOffsetY=3,D.strokeStyle=ve,D.lineWidth=3,D.lineCap="round",D.lineJoin="round",D.beginPath(),n.forEach((ne,R)=>{const ee=ye(R),ae=Z(ne.balance);R===0?D.moveTo(ee,ae):D.lineTo(ee,ae)}),D.stroke(),n.forEach((ne,R)=>{const ee=ye(R),ae=Z(ne.balance);y!==R&&(D.fillStyle=ve,D.shadowColor="transparent",D.beginPath(),D.arc(ee,ae,2,0,2*Math.PI),D.fill())}),D.shadowColor="transparent",y!==null){const ne=ye(y),R=Z(n[y].balance);D.fillStyle="#ffffff",D.beginPath(),D.arc(ne,R,8,0,2*Math.PI),D.fill(),D.strokeStyle=ve,D.lineWidth=3,D.beginPath(),D.arc(ne,R,8,0,2*Math.PI),D.stroke()}D.fillStyle="#8e8e93",D.font="12px -apple-system, BlinkMacSystemFont, sans-serif",D.textAlign="center",n.forEach((ne,R)=>{if(R%Math.max(1,Math.floor(n.length/5))===0||R===n.length-1){const ee=ye(R);D.fillText(ne.displayDate,ee,I.height-10)}}),D.textAlign="right";for(let ne=0;ne<=5;ne++){const R=fe-ne/5*Ce,ee=$.top+ne/5*K+4;let ae;R>=1e6?ae=`${(R/1e6).toFixed(1)}M`:R>=1e3?ae=`${(R/1e3).toFixed(0)}K`:ae=R.toFixed(0),D.fillText(ae+" ₽",$.left-10,ee)}},k=F=>{if(!b.current||n.length===0)return;const D=b.current.getBoundingClientRect(),I=F.clientX-D.left,P=F.clientY-D.top,$={left:60,right:20,top:20,bottom:40},A=D.width-$.left-$.right;if(D.height-$.top-$.bottom,I<$.left||I>D.width-$.right||P<$.top||P>D.height-$.bottom){g(null);return}const K=(I-$.left)/A,J=Math.round(K*(n.length-1));J>=0&&J<n.length?g(J):g(null)},j=()=>{g(null)};return f?r.jsxs("div",{className:"text-center py-12",children:[r.jsx("div",{className:"text-red-500 text-sm font-medium mb-2",children:"Ошибка загрузки графика"}),r.jsx("div",{className:"text-gray-500 text-xs mb-4",children:f}),r.jsx("button",{onClick:()=>S(o),className:"px-4 py-2 bg-blue-500 text-white rounded-lg text-sm font-medium hover:bg-blue-600 transition-colors",children:"Повторить"})]}):r.jsxs("div",{className:"space-y-6",children:[r.jsx(fv,{selectedPeriod:o,onPeriodChange:x,loading:c}),r.jsxs("div",{className:"relative",children:[c&&r.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-70 flex items-center justify-center z-10 rounded-xl backdrop-blur-sm",children:r.jsxs("div",{className:"flex items-center space-x-3 text-gray-600",children:[r.jsx("div",{className:"w-5 h-5 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),r.jsx("span",{className:"text-sm font-medium",children:"Обновление графика..."})]})}),r.jsx("div",{className:`
          bg-white rounded-xl p-3 md:p-5 border border-gray-100 shadow-sm relative
          transition-all duration-300
          ${c?"opacity-50":"opacity-100"}
        `,style:{height:window.innerWidth<640?"200px":"280px"},children:n.length>0?r.jsxs(r.Fragment,{children:[r.jsx("canvas",{ref:b,className:"w-full h-full cursor-crosshair",onMouseMove:k,onMouseLeave:j,style:{width:"100%",height:"100%"}}),y!==null&&r.jsxs("div",{className:"absolute bg-black bg-opacity-90 text-white p-3 rounded-xl text-sm font-medium backdrop-blur-sm border border-gray-600 shadow-lg pointer-events-none z-10 max-w-xs",style:{left:`${Math.min(Math.max(y/(n.length-1)*100,10),90)}%`,top:"10px",transform:"translateX(-50%)"},children:[r.jsxs("div",{className:"font-semibold mb-1 text-base",children:[(w=(N=n[y])==null?void 0:N.balance)==null?void 0:w.toLocaleString("ru-RU")," ₽"]}),r.jsx("div",{className:"text-gray-300 text-xs mb-2",children:new Date((C=n[y])==null?void 0:C.date).toLocaleDateString("ru-RU",{weekday:"long",month:"long",day:"numeric"})}),((_=n[y])==null?void 0:_.dailyChange)!==0&&r.jsxs("div",{className:`text-xs flex items-center ${((E=n[y])==null?void 0:E.dailyChange)>0?"text-green-400":"text-red-400"}`,children:[((T=n[y])==null?void 0:T.dailyChange)>0?"↗":"↘",((L=n[y])==null?void 0:L.dailyChange)>0?"+":"",(V=(U=n[y])==null?void 0:U.dailyChange)==null?void 0:V.toLocaleString("ru-RU")," ₽"]}),((Y=n[y])==null?void 0:Y.transactionsCount)>0&&r.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:[(M=n[y])==null?void 0:M.transactionsCount," операц",((B=n[y])==null?void 0:B.transactionsCount)===1?"ия":"ий"]})]})]}):!c&&r.jsx("div",{className:"flex items-center justify-center h-full",children:r.jsxs("div",{className:"text-center text-gray-500",children:[r.jsx("div",{className:"w-12 md:w-16 h-12 md:h-16 mx-auto mb-4 opacity-30",children:r.jsx(Gt,{className:"w-full h-full"})}),r.jsx("p",{className:"text-sm font-medium",children:"Нет данных для отображения"}),r.jsx("p",{className:"text-xs mt-1",children:"Выберите другой период или проверьте операции"})]})})})]}),a&&r.jsx(hv,{statistics:a,cashDeskName:t})]})},fd=e=>{const t=Math.abs(Number(e)).toLocaleString("ru-RU");return Number(e)>=0?`+${t} ₽`:`-${t} ₽`},pv=e=>Number(e)>=0?"text-green-600":"text-red-600",gv=e=>new Date(e).toLocaleDateString("ru-RU"),yv=(e,t)=>{const n=e===ft.PLANNED&&new Date(t)<new Date;return e===ft.ACTUAL?r.jsxs("span",{className:"inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:[r.jsx(On,{className:"w-3 h-3 mr-1"}),"Факт"]}):r.jsxs("span",{className:`inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full ${n?"bg-red-100 text-red-800":"bg-orange-100 text-orange-800"}`,children:[r.jsx(pl,{className:"w-3 h-3 mr-1"}),n?"Просрочен":"План"]})},vv=({isOpen:e,onClose:t,cashDesk:n})=>{var x;const[s,a]=p.useState([]),[l,o]=p.useState(!1),[i,c]=p.useState("transactions"),[u,f]=p.useState("all"),[d,y]=p.useState({total:0,actual:0,planned:0,totalIncome:0,totalExpense:0}),{fetchCashDeskTransactions:g}=Cc();p.useEffect(()=>{e&&n&&b()},[e,n]);const b=async()=>{try{o(!0);const h=await g(n.id,{limit:100});a(h||[]),v(h||[])}catch(h){console.error("Ошибка загрузки операций кассы:",h)}finally{o(!1)}},v=h=>{const m=h.length,k=h.filter(C=>C.status===ft.ACTUAL).length,j=h.filter(C=>C.status===ft.PLANNED).length,N=h.filter(C=>C.type==="income").reduce((C,_)=>C+Number(_.amount),0),w=h.filter(C=>C.type==="expense").reduce((C,_)=>C+Math.abs(Number(_.amount)),0);y({total:m,actual:k,planned:j,totalIncome:N,totalExpense:w})},S=s.filter(h=>u==="all"?!0:h.status===u);return e?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl mx-4 max-h-[90vh] md:max-h-[95vh] flex flex-col",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start p-4 md:p-6 border-b border-gray-200 space-y-3 sm:space-y-0",children:[r.jsxs("div",{className:"flex-1",children:[r.jsxs("h2",{className:"text-lg md:text-xl font-semibold text-gray-900 flex items-center",children:[r.jsx(dn,{className:"w-5 h-5 md:w-6 md:h-6 mr-2 text-blue-600"}),(n==null?void 0:n.name)||"Касса"]}),r.jsx("div",{className:"flex items-center mt-1 text-sm text-gray-500",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mr-1 live-dot"}),"Обновлено сейчас"]})})]}),r.jsxs("div",{className:"flex items-center justify-between sm:justify-end space-x-4",children:[r.jsxs("div",{className:"text-left sm:text-right",children:[r.jsxs("div",{className:"text-xl md:text-2xl font-semibold text-green-600",children:[(x=n==null?void 0:n.current_balance)==null?void 0:x.toLocaleString("ru-RU")," ₽"]}),r.jsx("div",{className:"text-xs md:text-sm text-gray-500",children:"Текущий баланс"})]}),r.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors p-1 shrink-0",children:r.jsx(Fe,{className:"w-5 h-5 md:w-6 md:h-6"})})]})]}),r.jsx("div",{className:"px-4 md:px-6 pt-4",children:r.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[r.jsxs("button",{onClick:()=>c("transactions"),className:`flex-1 flex items-center justify-center py-2 px-2 md:px-4 rounded-md text-xs md:text-sm font-medium transition-all ${i==="transactions"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[r.jsx(dn,{className:"w-3 h-3 md:w-4 md:h-4 mr-1 md:mr-2"}),r.jsx("span",{className:"hidden xs:inline",children:"Операции"}),r.jsx("span",{className:"xs:hidden",children:"Операц."})]}),r.jsxs("button",{onClick:()=>c("chart"),className:`flex-1 flex items-center justify-center py-2 px-2 md:px-4 rounded-md text-xs md:text-sm font-medium transition-all ${i==="chart"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[r.jsx(Gt,{className:"w-3 h-3 md:w-4 md:h-4 mr-1 md:mr-2"}),"График"]})]})}),r.jsx("div",{className:"flex-1 overflow-hidden",children:i==="transactions"?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200",children:r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-gray-900",children:d.total}),r.jsx("div",{className:"text-sm text-gray-500",children:"Всего операций"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-600",children:d.actual}),r.jsx("div",{className:"text-sm text-gray-500",children:"Факт"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-orange-600",children:d.planned}),r.jsx("div",{className:"text-sm text-gray-500",children:"План"})]}),r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"text-2xl font-bold text-green-600",children:fd(d.totalIncome)}),r.jsx("div",{className:"text-sm text-gray-500",children:"Доходы"})]}),r.jsxs("div",{className:"text-center",children:[r.jsxs("div",{className:"text-2xl font-bold text-red-600",children:["-",Math.abs(d.totalExpense).toLocaleString("ru-RU")," ₽"]}),r.jsx("div",{className:"text-sm text-gray-500",children:"Расходы"})]})]})}),r.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:r.jsxs("div",{className:"flex space-x-4",children:[r.jsxs("button",{onClick:()=>f("all"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${u==="all"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Все (",d.total,")"]}),r.jsxs("button",{onClick:()=>f("actual"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${u==="actual"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Факт (",d.actual,")"]}),r.jsxs("button",{onClick:()=>f("planned"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${u==="planned"?"bg-orange-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["План (",d.planned,")"]})]})}),r.jsx("div",{className:"flex-1 overflow-y-auto",style:{maxHeight:"400px"},children:l?r.jsx("div",{className:"flex items-center justify-center p-12",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-500",children:"Загрузка операций..."})]})}):S.length===0?r.jsx("div",{className:"flex items-center justify-center p-12",children:r.jsxs("div",{className:"text-center",children:[r.jsx(dn,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),r.jsx("p",{className:"text-gray-500",children:"Операции не найдены"}),r.jsx("p",{className:"text-sm text-gray-400 mt-1",children:u==="all"?"По этой кассе пока нет операций":`Нет операций со статусом "${u==="actual"?"Факт":"План"}"`})]})}):r.jsx("div",{className:"divide-y divide-gray-200",children:S.map(h=>r.jsx("div",{className:"p-4 hover:bg-gray-50",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${Number(h.amount)>=0?"bg-green-100":"bg-red-100"}`,children:Number(h.amount)>=0?r.jsx(sr,{className:"w-5 h-5 text-green-600"}):r.jsx(Br,{className:"w-5 h-5 text-red-600"})}),r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("h4",{className:"text-sm font-medium text-gray-900",children:h.description}),yv(h.status,h.date)]}),r.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[r.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[r.jsx(it,{className:"w-3 h-3 mr-1"}),gv(h.date)]}),h.category&&r.jsx("span",{className:"text-xs text-gray-500",children:h.category}),h.client_name&&r.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[r.jsx(Ee,{className:"w-3 h-3 mr-1"}),h.client_name]})]})]})]}),r.jsx("div",{className:"text-right",children:r.jsx("div",{className:`text-lg font-semibold ${pv(h.amount)}`,children:fd(h.amount)})})]})},h.id))})})]}):r.jsx("div",{className:"p-3 md:p-6 h-full overflow-y-auto",children:r.jsx(xv,{cashDeskId:n==null?void 0:n.id,cashDeskName:n==null?void 0:n.name})})}),r.jsx("div",{className:"px-4 md:px-6 py-3 md:py-4 border-t border-gray-200 bg-gray-50 shrink-0",children:r.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3",children:[r.jsx("p",{className:"text-xs md:text-sm text-gray-500 text-center sm:text-left order-2 sm:order-1",children:i==="transactions"?`Показано ${S.length} из ${d.total} операций`:`График баланса кассы "${n==null?void 0:n.name}"`}),r.jsx("button",{onClick:t,className:"w-full sm:w-auto px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors text-sm font-medium order-1 sm:order-2",children:"Закрыть"})]})})]})}):null},bv=({isOpen:e,onClose:t,onSubmit:n,loading:s=!1})=>{const[a,l]=p.useState({full_name:"",position:"",telegram_username:"",phone:"",bank:"",card_number:"",hire_date:new Date().toISOString().split("T")[0]}),[o,i]=p.useState({}),c=()=>{l({full_name:"",position:"",telegram_username:"",phone:"",bank:"",card_number:"",hire_date:new Date().toISOString().split("T")[0]}),i({}),t()},u=(b,v)=>{l(S=>({...S,[b]:v})),o[b]&&i(S=>({...S,[b]:null}))},f=()=>{const b={};return a.full_name.trim()?a.full_name.trim().length<2&&(b.full_name="ФИО должно содержать минимум 2 символа"):b.full_name="ФИО обязательно для заполнения",a.position.trim()||(b.position="Должность обязательна для заполнения"),a.hire_date?new Date(a.hire_date)>new Date&&(b.hire_date="Дата трудоустройства не может быть в будущем"):b.hire_date="Дата трудоустройства обязательна",a.phone&&!/^7[0-9]{10}$/.test(a.phone)&&(b.phone="Телефон должен быть в формате 79991234567"),a.telegram_username&&!/^@[a-zA-Z0-9_]{4,31}$/.test(a.telegram_username)&&(b.telegram_username="Telegram должен быть в формате @username"),a.card_number&&!/^[0-9]{16,19}$/.test(a.card_number.replace(/\s/g,""))&&(b.card_number="Номер карты должен содержать от 16 до 19 цифр"),i(b),Object.keys(b).length===0},d=async b=>{if(b.preventDefault(),!!f())try{const v={...a,full_name:a.full_name.trim(),position:a.position.trim(),telegram_username:a.telegram_username.trim()||null,phone:a.phone.trim()||null,bank:a.bank.trim()||null,card_number:a.card_number.replace(/\s/g,"")||null};await n(v),c()}catch(v){console.error("Ошибка создания работника:",v)}},y=b=>b.replace(/\D/g,"").replace(/(\d{4})(?=\d)/g,"$1 "),g=b=>{const v=b.replace(/\D/g,"");return v.length<=11?v:v.slice(0,11)};return e?r.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:r.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[r.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:c}),r.jsx("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:r.jsxs("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 sm:mx-0 sm:h-10 sm:w-10",children:r.jsx(Ee,{className:"h-6 w-6 text-blue-600"})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Добавить работника"}),r.jsx("p",{className:"text-sm text-gray-500",children:"Заполните информацию о новом работнике"})]})]}),r.jsx("button",{onClick:c,className:"text-gray-400 hover:text-gray-600 transition-colors",children:r.jsx(Fe,{className:"w-6 h-6"})})]}),r.jsxs("form",{onSubmit:d,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(Ee,{className:"w-4 h-4 inline mr-1"}),"ФИО *"]}),r.jsx("input",{type:"text",value:a.full_name,onChange:b=>u("full_name",b.target.value),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 ${o.full_name?"border-red-500":"border-gray-300"}`,placeholder:"Иванов Иван Иванович"}),o.full_name&&r.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[r.jsx(Ct,{className:"w-4 h-4 mr-1"}),o.full_name]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(S0,{className:"w-4 h-4 inline mr-1"}),"Должность *"]}),r.jsx("input",{type:"text",list:"positions",value:a.position,onChange:b=>u("position",b.target.value),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 ${o.position?"border-red-500":"border-gray-300"}`,placeholder:"Выберите или введите должность"}),r.jsx("datalist",{id:"positions",children:Tf.map(b=>r.jsx("option",{value:b},b))}),o.position&&r.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[r.jsx(Ct,{className:"w-4 h-4 mr-1"}),o.position]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(it,{className:"w-4 h-4 inline mr-1"}),"Дата трудоустройства *"]}),r.jsx("input",{type:"date",value:a.hire_date,onChange:b=>u("hire_date",b.target.value),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 ${o.hire_date?"border-red-500":"border-gray-300"}`}),o.hire_date&&r.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[r.jsx(Ct,{className:"w-4 h-4 mr-1"}),o.hire_date]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(Jn,{className:"w-4 h-4 inline mr-1"}),"Телефон"]}),r.jsx("input",{type:"tel",value:a.phone,onChange:b=>u("phone",g(b.target.value)),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 ${o.phone?"border-red-500":"border-gray-300"}`,placeholder:"79991234567"}),o.phone&&r.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[r.jsx(Ct,{className:"w-4 h-4 mr-1"}),o.phone]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(zn,{className:"w-4 h-4 inline mr-1"}),"Telegram"]}),r.jsx("input",{type:"text",value:a.telegram_username,onChange:b=>u("telegram_username",b.target.value),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 ${o.telegram_username?"border-red-500":"border-gray-300"}`,placeholder:"@username"}),o.telegram_username&&r.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[r.jsx(Ct,{className:"w-4 h-4 mr-1"}),o.telegram_username]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(Ns,{className:"w-4 h-4 inline mr-1"}),"Банк"]}),r.jsx("input",{type:"text",list:"banks",value:a.bank,onChange:b=>u("bank",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Выберите или введите банк"}),r.jsx("datalist",{id:"banks",children:Df.map(b=>r.jsx("option",{value:b},b))})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[r.jsx(Qs,{className:"w-4 h-4 inline mr-1"}),"Номер карты"]}),r.jsx("input",{type:"text",value:y(a.card_number),onChange:b=>u("card_number",b.target.value.replace(/\s/g,"")),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 font-mono ${o.card_number?"border-red-500":"border-gray-300"}`,placeholder:"1234 5678 9012 3456",maxLength:"23"}),o.card_number&&r.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center",children:[r.jsx(Ct,{className:"w-4 h-4 mr-1"}),o.card_number]})]}),r.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[r.jsx("button",{type:"button",onClick:c,disabled:s,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 transition-colors",children:"Отмена"}),r.jsx("button",{type:"submit",disabled:s,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 transition-colors",children:s?r.jsxs(r.Fragment,{children:[r.jsx(Pe,{className:"w-4 h-4 mr-2 animate-spin"}),"Создание..."]}):r.jsxs(r.Fragment,{children:[r.jsx(Ee,{className:"w-4 h-4 mr-2"}),"Создать работника"]})})]})]})]})})]})}):null},Fi={async searchClients(e,t){const n=new URLSearchParams({search:e,filter:t});return q.get(`/clients?${n}`)},async getClientById(e){return q.get(`/clients/${e}`)},async createClient(e){console.log("🟠 clientsService.createClient вызван с данными:",e),console.log("🟠 Вызываем apiService.post...");try{const t=await q.post("/clients",e);return console.log("🟠 apiService.post вернул результат:",t),t}catch(t){throw console.error("❌ Ошибка в clientsService.createClient:",t),t}},async updateClient(e,t){return console.log("🟠 clientsService.updateClient вызван для ID:",e,"с данными:",t),q.put(`/clients/${e}`,t)},async deleteClient(e){return q.delete(`/clients/${e}`)},async getClientDocuments(e){console.log("📋 clientsService.getClientDocuments вызван для ID:",e);try{const t=await q.get(`/clients/${e}/documents`);return console.log("📋 Получены документы клиента:",t),t}catch(t){throw console.error("❌ Ошибка при получении документов:",t),t}},async updateClientDocuments(e,t){console.log("📋 clientsService.updateClientDocuments вызван для ID:",e,"с данными:",t);try{const n=await q.patch(`/clients/${e}/documents`,t);return console.log("📋 Документы клиента обновлены:",n),n}catch(n){throw console.error("❌ Ошибка при обновлении документов:",n),n}},async getClientCurator(e){console.log("👨‍🏫 clientsService.getClientCurator вызван для ID:",e);try{const t=await q.get(`/clients/${e}/curator`);return console.log("👨‍🏫 Получен куратор клиента:",t),t}catch(t){throw console.error("❌ Ошибка при получении куратора:",t),t}},async updateClientCurator(e,t){console.log("👨‍🏫 clientsService.updateClientCurator вызван для ID:",e,"с данными:",t);try{const n=await q.patch(`/clients/${e}/curator`,t);return console.log("👨‍🏫 Куратор клиента обновлен:",n),n}catch(n){throw console.error("❌ Ошибка при обновлении куратора:",n),n}},async updateClientEducationData(e,t){console.log("🎓 clientsService.updateClientEducationData вызван для ID:",e,"с данными:",t);try{const n=await q.patch(`/clients/${e}/data`,t);return console.log("🎓 Данные обучения клиента обновлены:",n),n}catch(n){throw console.error("❌ Ошибка при обновлении данных обучения:",n),n}},async getDocumentsStats(){console.log("📊 clientsService.getDocumentsStats вызван");try{const e=await q.get("/clients/stats/documents");return console.log("📊 Получена статистика по документам:",e),e}catch(e){throw console.error("❌ Ошибка при получении статистики:",e),e}},async searchClientsByInn(e){const t=new URLSearchParams({search:e,filter:"inn"});return q.get(`/clients?${t}`)},async validateClientData(e){var n,s,a,l,o;const t={};if((n=e.name)!=null&&n.trim()||(t.name="Имя обязательно для заполнения"),(s=e.email)!=null&&s.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.email)||(t.email="Некорректный формат email"):t.email="Email обязателен для заполнения",e.phone&&!/^\+?[1-9]\d{1,14}$/.test(e.phone.replace(/\s/g,""))&&(t.phone="Некорректный формат телефона"),e.data){e.data.direction&&!["QA","AQA"].includes(e.data.direction)&&(t.direction="Направление может быть только QA или AQA");const i=/^\d{4}-\d{2}-\d{2}$/;if(e.data.start_date&&!i.test(e.data.start_date)&&(t.start_date="Дата начала должна быть в формате YYYY-MM-DD"),e.data.end_date&&!i.test(e.data.end_date)&&(t.end_date="Дата окончания должна быть в формате YYYY-MM-DD"),e.data.start_date&&e.data.end_date){const c=new Date(e.data.start_date);new Date(e.data.end_date)<=c&&(t.date_range="Дата окончания должна быть больше даты начала")}}if((a=e.documents)!=null&&a.inn){const i=e.documents.inn.toString();/^\d{10}$|^\d{12}$/.test(i)||(t.inn="ИНН может содержать только 10 или 12 цифр")}if((l=e.documents)!=null&&l.passport){const{serial:i,number:c}=e.documents.passport;i&&!/^\d{4}$/.test(i)&&(t.passportSerial="Серия паспорта должна содержать 4 цифры"),c&&!/^\d{6}$/.test(c)&&(t.passportNumber="Номер паспорта должен содержать 6 цифр")}if((o=e.documents)!=null&&o.konturLink){const i=["focus.kontur.ru","kontur.ru","extern.kontur.ru","elba.kontur.ru"];try{const c=new URL(e.documents.konturLink);i.some(f=>c.hostname===f||c.hostname.endsWith("."+f))||(t.konturLink="Разрешены только ссылки на домены Контура")}catch{t.konturLink="Некорректный URL адрес"}}return{isValid:Object.keys(t).length===0,errors:t}},getRecordType(e){return["CREATED","DISTRIBUTION","GIVE_ACCESS"].includes(e)?"lead":"client"},getStatusLabel(e){return{CREATED:"Создан",DISTRIBUTION:"Распределение",GIVE_ACCESS:"Выдача доступов",IN_PROGRESS:"Обучается",SEARCH_OFFER:"Ищет работу",ACCEPT_OFFER:"Принимает оффер",PAYING_OFFER:"Выплачивает процент",FINISH:"Закончил обучение"}[e]||e},analyzeProfileCompleteness(e){var i,c;const t=[e.name,e.email,e.phone].filter(Boolean).length,n=e.documents||{},s=[n.inn,((i=n.passport)==null?void 0:i.serial)&&((c=n.passport)==null?void 0:c.number),n.konturLink].filter(Boolean).length,a=6,l=t+s,o=Math.round(l/a*100);return{basicFields:t,docFields:s,filledFields:l,totalFields:a,percentage:o,status:o===100?"complete":o===0?"empty":"partial"}},async bulkUpdateStatus(e,t){console.log("🔄 Массовое обновление статуса для клиентов:",e,"на статус:",t);const n=e.map(s=>this.updateClient(s,{status:t}));try{const s=await Promise.allSettled(n),a=s.filter(o=>o.status==="fulfilled").length,l=s.filter(o=>o.status==="rejected").length;return console.log(`✅ Успешно обновлено: ${a}, ошибок: ${l}`),{successful:a,failed:l,results:s}}catch(s){throw console.error("❌ Ошибка при массовом обновлении:",s),s}},formatEducationData(e){return e?{flow:e.flow||"",direction:e.direction||"",group:e.group||"",start_date:e.start_date||"",end_date:e.end_date||""}:{}},calculateEducationDuration(e,t){if(!e||!t)return null;const n=new Date(e),s=new Date(t),a=Math.abs(s-n),l=Math.ceil(a/(1e3*60*60*24));return{days:l,weeks:Math.ceil(l/7),months:Math.ceil(l/30)}},getEducationProgress(e,t){if(!e||!t)return null;const n=new Date(e),s=new Date(t),a=new Date;if(a<n)return{status:"not_started",progress:0};if(a>s)return{status:"completed",progress:100};const l=s-n,o=a-n;return{status:"in_progress",progress:Math.round(o/l*100)}}},wv=(e,t)=>{const[n,s]=p.useState(null),[a,l]=p.useState([]),[o,i]=p.useState({totalOperations:0,totalAmount:0,lastOperation:null,averageCheck:0}),[c,u]=p.useState(!0),[f,d]=p.useState(null),y=S=>{if(!S||S.length===0){i({totalOperations:0,totalAmount:0,lastOperation:null,averageCheck:0});return}const x=S.reduce((k,j)=>k+Number(j.amount),0),h=S.sort((k,j)=>new Date(j.date)-new Date(k.date))[0],m=x/S.length;i({totalOperations:S.length,totalAmount:x,lastOperation:h,averageCheck:m})},g=async()=>{if(e){u(!0),d(null);try{const S=await Fi.getClientById(e);s(S);const x=await De.getClientFinances(e);l(x),y(x)}catch(S){console.error("Ошибка загрузки данных клиента:",S);const x=S.message;d(x),t&&t(x)}finally{u(!1)}}},b=S=>{s(S)},v=async()=>{if(e)try{const S=await De.getClientFinances(e);l(S),y(S)}catch(S){console.error("Ошибка перезагрузки финансов:",S)}};return p.useEffect(()=>{e&&g()},[e]),{client:n,clientFinances:a,clientStats:o,loading:c,error:f,loadClientData:g,updateClientData:b,reloadFinances:v,calculateStats:y}},jv=(e,t,n)=>{const[s,a]=p.useState(!1),[l,o]=p.useState(!1),[i,c]=p.useState(!1),[u,f]=p.useState(!1),[d,y]=p.useState({name:"",email:"",phone:"",status:"",worker_id:null,data:{}}),[g,b]=p.useState({inn:"",passportSerial:"",passportNumber:"",konturLink:""});return p.useEffect(()=>{var _,E;if(e){y({name:e.name||"",email:e.email||"",phone:e.phone||"",status:e.status||"",worker_id:e.worker_id||null,data:e.data||{}});const T=e.documents||{};b({inn:T.inn||"",passportSerial:((_=T.passport)==null?void 0:_.serial)||"",passportNumber:((E=T.passport)==null?void 0:E.number)||"",konturLink:T.konturLink||""})}},[e]),{editingBasic:s,editingDocs:l,savingBasic:i,savingDocs:u,basicFormData:d,docsFormData:g,handleEditBasic:()=>{a(!0)},handleCancelBasic:()=>{e&&y({name:e.name||"",email:e.email||"",phone:e.phone||"",status:e.status||"",worker_id:e.worker_id||null,data:e.data||{}}),a(!1)},handleSaveBasic:async()=>{if(e){c(!0);try{const _={name:d.name,email:d.email,phone:d.phone,status:d.status,worker_id:d.worker_id,data:d.data},E=await Fi.updateClient(e.id,_);a(!1),t&&t("Основная информация обновлена",E)}catch(_){console.error("Ошибка обновления основной информации:",_),n&&n(_.message||"Ошибка обновления основной информации")}finally{c(!1)}}},handleEditDocs:()=>{o(!0)},handleCancelDocs:()=>{var _,E;if(e){const T=e.documents||{};b({inn:T.inn||"",passportSerial:((_=T.passport)==null?void 0:_.serial)||"",passportNumber:((E=T.passport)==null?void 0:E.number)||"",konturLink:T.konturLink||""})}o(!1)},handleSaveDocs:async()=>{if(e){f(!0);try{const _={};g.inn&&g.inn.trim()&&(_.inn=g.inn.trim()),g.konturLink&&g.konturLink.trim()&&(_.konturLink=g.konturLink.trim()),g.passportSerial&&g.passportNumber&&(_.passport={serial:g.passportSerial.trim(),number:g.passportNumber.trim()});const E=await Fi.updateClient(e.id,{documents:_});o(!1),t&&t("Документы обновлены",E)}catch(_){console.error("Ошибка обновления документов:",_),n&&n(_.message||"Ошибка обновления документов")}finally{f(!1)}}},handleBasicChange:(_,E)=>{y(T=>({...T,[_]:E}))},handleDocsChange:(_,E)=>{b(T=>({...T,[_]:E}))},handleEducationChange:(_,E)=>{y(T=>({...T,data:{...T.data,[_]:E}}))},handleCuratorChange:_=>{y(E=>({...E,worker_id:_}))}}},Nv=({onBack:e,onDelete:t,client:n,title:s="Карточка клиента"})=>{const{canDelete:a}=Rt(),l=()=>{t&&n&&t(n)};return r.jsx("div",{className:"bg-white border-b",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:r.jsxs("div",{className:"flex items-center justify-between h-16",children:[r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsxs("button",{onClick:e,className:"flex items-center space-x-2 text-gray-600 hover:text-gray-900 transition-colors",title:"Вернуться к списку клиентов",children:[r.jsx(Lf,{className:"w-5 h-5"}),r.jsx("span",{children:"Назад к списку"})]}),r.jsx("div",{className:"h-6 w-px bg-gray-300"}),r.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:s}),(n==null?void 0:n.name)&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"h-6 w-px bg-gray-300"}),r.jsx("span",{className:"text-lg text-gray-700",children:n.name})]})]}),r.jsx("div",{className:"flex items-center space-x-3",children:a()&&r.jsxs("button",{onClick:l,className:"flex items-center space-x-2 px-4 py-2 text-red-600 bg-red-50 rounded-lg hover:bg-red-100 transition-colors",title:"Удалить клиента",children:[r.jsx(Yr,{className:"w-4 h-4"}),r.jsx("span",{children:"Удалить"})]})})]})})})},Sv="modulepreload",kv=function(e){return"/"+e},hd={},Cv=function(t,n,s){let a=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),i=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(n.map(c=>{if(c=kv(c),c in hd)return;hd[c]=!0;const u=c.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":Sv,u||(d.as="script"),d.crossOrigin="",d.href=c,i&&d.setAttribute("nonce",i),document.head.appendChild(d),u)return new Promise((y,g)=>{d.addEventListener("load",y),d.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}function l(o){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=o,window.dispatchEvent(i),!i.defaultPrevented)throw o}return a.then(o=>{for(const i of o||[])i.status==="rejected"&&l(i.reason);return t().catch(l)})},jh=({title:e,icon:t,isEditing:n,isSaving:s=!1,onEdit:a,onSave:l,onCancel:o,children:i,className:c="",headerClassName:u="",contentClassName:f="",showEditButton:d=!0,editButtonText:y="Редактировать",saveButtonText:g="Сохранить",cancelButtonText:b="Отмена"})=>r.jsxs("div",{className:`bg-white rounded-lg shadow-sm border ${c}`,children:[r.jsx("div",{className:`px-6 py-4 border-b border-gray-200 ${u}`,children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[t&&r.jsx(t,{className:"w-5 h-5 mr-2 text-blue-600"}),e]}),d&&r.jsx("div",{className:"flex items-center space-x-2",children:n?r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:l,disabled:s,className:"flex items-center space-x-1 px-3 py-1.5 text-green-600 bg-green-50 rounded-md hover:bg-green-100 transition-colors disabled:opacity-50",children:[s?r.jsx(Pe,{className:"w-4 h-4 animate-spin"}):r.jsx(Cs,{className:"w-4 h-4"}),r.jsx("span",{children:g})]}),r.jsxs("button",{onClick:o,disabled:s,className:"flex items-center space-x-1 px-3 py-1.5 text-gray-600 bg-gray-50 rounded-md hover:bg-gray-100 transition-colors disabled:opacity-50",children:[r.jsx(Fe,{className:"w-4 h-4"}),r.jsx("span",{children:b})]})]}):r.jsxs("button",{onClick:a,className:"flex items-center space-x-1 px-3 py-1.5 text-blue-600 bg-blue-50 rounded-md hover:bg-blue-100 transition-colors",children:[r.jsx(ks,{className:"w-4 h-4"}),r.jsx("span",{children:y})]})})]})}),r.jsx("div",{className:`p-6 ${f}`,children:i})]}),jt=({text:e,fieldName:t,className:n="p-1 text-gray-400 hover:text-gray-600 transition-colors",title:s="Копировать",size:a=4,showAnimation:l=!0,animationDuration:o=2e3})=>{const[i,c]=p.useState(null);if(!e)return null;const u=async()=>{try{await navigator.clipboard.writeText(e),l&&(c(t),setTimeout(()=>c(null),o))}catch(y){console.error("Не удалось скопировать:",y)}},f=`w-${a} h-${a}`,d=l&&i===t;return r.jsx("button",{onClick:u,className:n,title:d?"Скопировано!":s,children:d?r.jsx(Wa,{className:`${f} text-green-500`}):r.jsx(Ha,{className:f})})},_v=({status:e,size:t="sm",customConfig:n=null})=>{const a=n||{lead:{color:"bg-blue-100 text-blue-800",label:"Лид"},client:{color:"bg-green-100 text-green-800",label:"Клиент"},in_progress:{color:"bg-yellow-100 text-yellow-800",label:"В работе"},blocked:{color:"bg-red-100 text-red-800",label:"Заблокирован"},finished:{color:"bg-gray-100 text-gray-800",label:"Закончил обучение"}},l={xs:"px-1.5 py-0.5 text-xs",sm:"px-2.5 py-0.5 text-xs",md:"px-3 py-1 text-sm",lg:"px-4 py-1.5 text-base"},o=a[e]||{color:"bg-gray-100 text-gray-800",label:e||"Неизвестно"},i=l[t]||l.sm;return r.jsx("span",{className:`
        inline-flex items-center rounded-full font-medium
        ${o.color} 
        ${i}
      `,title:`Статус: ${o.label}`,children:o.label})},xd=({label:e,value:t="",onChange:n,placeholder:s="YYYY-MM-DD",disabled:a=!1,error:l=""})=>{const o=i=>{const c=i.target.value;n&&n(c)};return r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),r.jsxs("div",{className:"relative",children:[r.jsx(it,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),r.jsx("input",{type:"date",value:t,onChange:o,placeholder:s,disabled:a,className:`w-full pl-10 pr-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 disabled:bg-gray-100 disabled:cursor-not-allowed ${l?"border-red-500":"border-gray-300"}`})]}),l&&r.jsx("p",{className:"mt-1 text-sm text-red-600",children:l})]})},Ev=({client:e,isEditing:t,isSaving:n,formData:s,onEdit:a,onSave:l,onCancel:o,onChange:i})=>{const[c,u]=p.useState([]),[f,d]=p.useState(!1);p.useEffect(()=>{t&&y()},[t]);const y=async()=>{try{d(!0);const{apiService:h}=await Cv(async()=>{const{apiService:N}=await Promise.resolve().then(()=>h0);return{apiService:N}},void 0),m=await h.get("/workers?active_only=true"),j=(Array.isArray(m)?m:[]).map(N=>({value:N.id,label:`${N.full_name} (${N.position})`}));u(j)}catch(h){console.error("Ошибка загрузки кураторов:",h),u([])}finally{d(!1)}},g=[{value:"CREATED",label:"Создан"},{value:"DISTRIBUTION",label:"Распределение"},{value:"GIVE_ACCESS",label:"Выдача доступов"},{value:"IN_PROGRESS",label:"Обучается"},{value:"SEARCH_OFFER",label:"Ищет работу"},{value:"ACCEPT_OFFER",label:"Принял оффер"},{value:"PAYING_OFFER",label:"Выплачивает процент"},{value:"FINISH",label:"Закончил обучение"}],b=[{value:"QA",label:"QA (Ручное тестирование)"},{value:"AQA",label:"AQA (Автоматизированное тестирование)"}],v=(h,m)=>{i&&i(h,m)},S=(h,m)=>{const j={...s.data||{},[h]:m};v("data",j)},x=t?s.data||{}:(e==null?void 0:e.data)||{};return r.jsx(jh,{title:"Основная информация",icon:Ee,isEditing:t,isSaving:n,onEdit:a,onSave:l,onCancel:o,children:t?r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-4",children:[r.jsxs("h4",{className:"text-sm font-medium text-gray-900 flex items-center space-x-2",children:[r.jsx(Ee,{className:"w-4 h-4"}),r.jsx("span",{children:"Личные данные"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsx(ue,{label:"Имя клиента",value:s.name,onChange:h=>v("name",h),placeholder:"Введите имя клиента",required:!0}),r.jsx(ue,{label:"Email",type:"email",value:s.email,onChange:h=>v("email",h),placeholder:"client@example.com",required:!0}),r.jsx(ue,{label:"Телефон",value:s.phone,onChange:h=>v("phone",h),placeholder:"+7 (999) 123-45-67"}),r.jsx(ue,{label:"Telegram",value:s.telegram,onChange:h=>v("telegram",h),placeholder:"@username"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsx(qe,{label:"Статус",value:s.status,onChange:h=>v("status",h),options:g,placeholder:"Выберите статус"}),r.jsx(qe,{label:"Куратор",value:s.worker_id,onChange:h=>v("worker_id",h),options:[{value:null,label:"Без куратора"},...c],placeholder:f?"Загрузка...":"Выберите куратора",disabled:f})]})]}),r.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 space-y-4",children:[r.jsxs("h4",{className:"text-sm font-medium text-gray-900 flex items-center space-x-2",children:[r.jsx(ko,{className:"w-4 h-4"}),r.jsx("span",{children:"Данные обучения"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsx(ue,{label:"Поток",value:x.flow||"",onChange:h=>S("flow",h),placeholder:"Например: Основной поток"}),r.jsx(qe,{label:"Направление",value:x.direction||"",onChange:h=>S("direction",h),options:[{value:"",label:"Не выбрано"},...b],placeholder:"Выберите направление"}),r.jsx(ue,{label:"Группа",value:x.group||"",onChange:h=>S("group",h),placeholder:"Например: QA-2025-01"})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsx(xd,{label:"Дата начала обучения",value:x.start_date||"",onChange:h=>S("start_date",h),placeholder:"YYYY-MM-DD"}),r.jsx(xd,{label:"Дата окончания обучения",value:x.end_date||"",onChange:h=>S("end_date",h),placeholder:"YYYY-MM-DD"})]})]})]}):r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"space-y-4",children:[r.jsxs("h4",{className:"text-sm font-medium text-gray-700 flex items-center space-x-2 pb-2 border-b",children:[r.jsx(Ee,{className:"w-4 h-4"}),r.jsx("span",{children:"Личные данные"})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(Ee,{className:"w-5 h-5 text-gray-400"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:(e==null?void 0:e.name)||"Не указано"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Имя клиента"})]})]}),(e==null?void 0:e.name)&&r.jsx(jt,{text:e.name,fieldName:"name"})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(zl,{className:"w-5 h-5 text-gray-400"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:(e==null?void 0:e.email)||"Не указан"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Email"})]})]}),(e==null?void 0:e.email)&&r.jsx(jt,{text:e.email,fieldName:"email"})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(Jn,{className:"w-5 h-5 text-gray-400"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:(e==null?void 0:e.phone)||"Не указан"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Телефон"})]})]}),(e==null?void 0:e.phone)&&r.jsx(jt,{text:e.phone,fieldName:"phone"})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(zn,{className:"w-5 h-5 text-gray-400"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:(e==null?void 0:e.telegram)||"Не указан"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Telegram"})]})]}),(e==null?void 0:e.telegram)&&r.jsx(jt,{text:e.telegram,fieldName:"telegram"})]}),r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"w-5 h-5 flex items-center justify-center",children:r.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full"})}),r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{children:r.jsx("p",{className:"text-xs text-gray-500",children:"Статус"})}),r.jsx(_v,{status:e==null?void 0:e.status})]})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(Dc,{className:"w-5 h-5 text-gray-400"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:e!=null&&e.curator?r.jsxs("span",{children:[e.curator.name,r.jsxs("span",{className:"text-xs text-gray-500 ml-1",children:["(",e.curator.position,")"]})]}):"Не назначен"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Куратор"})]})]}),(e==null?void 0:e.curator)&&r.jsx(jt,{text:e.curator.name,fieldName:"curator"})]})]}),(x.flow||x.direction||x.group||x.start_date||x.end_date)&&r.jsxs("div",{className:"space-y-4",children:[r.jsxs("h4",{className:"text-sm font-medium text-gray-700 flex items-center space-x-2 pb-2 border-b",children:[r.jsx(ko,{className:"w-4 h-4"}),r.jsx("span",{children:"Данные обучения"})]}),x.flow&&r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(_0,{className:"w-5 h-5 text-gray-400"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:x.flow}),r.jsx("p",{className:"text-xs text-gray-500",children:"Поток"})]})]}),r.jsx(jt,{text:x.flow,fieldName:"flow"})]}),x.direction&&r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(ko,{className:"w-5 h-5 text-gray-400"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:r.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${x.direction==="QA"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}`,children:x.direction})}),r.jsx("p",{className:"text-xs text-gray-500",children:"Направление"})]})]}),r.jsx(jt,{text:x.direction,fieldName:"direction"})]}),x.group&&r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(Jt,{className:"w-5 h-5 text-gray-400"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:x.group}),r.jsx("p",{className:"text-xs text-gray-500",children:"Группа"})]})]}),r.jsx(jt,{text:x.group,fieldName:"group"})]}),(x.start_date||x.end_date)&&r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(it,{className:"w-5 h-5 text-gray-400"}),r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center space-x-4",children:[x.start_date&&r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:new Date(x.start_date).toLocaleDateString("ru-RU")}),r.jsx("p",{className:"text-xs text-gray-500",children:"Начало"})]}),x.start_date&&x.end_date&&r.jsx("span",{className:"text-gray-400",children:"→"}),x.end_date&&r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:new Date(x.end_date).toLocaleDateString("ru-RU")}),r.jsx("p",{className:"text-xs text-gray-500",children:"Окончание"})]})]}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Период обучения"})]}),(x.start_date||x.end_date)&&r.jsx(jt,{text:`${x.start_date||""} - ${x.end_date||""}`,fieldName:"dates"})]})]})]})})},Dv=({client:e,isEditing:t,isSaving:n,formData:s,onEdit:a,onSave:l,onCancel:o,onChange:i})=>{const c=(d,y)=>{i&&i(d,y)},u=(e==null?void 0:e.documents)||{},f=u.passport||{};return r.jsx(jh,{title:"Документы",icon:Ss,isEditing:t,isSaving:n,onEdit:a,onSave:l,onCancel:o,children:t?r.jsxs("div",{className:"space-y-4",children:[r.jsx(ue,{label:"ИНН",value:s.inn,onChange:d=>c("inn",d),placeholder:"123456789012",maxLength:12}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsx(ue,{label:"Серия паспорта",value:s.passportSerial,onChange:d=>c("passportSerial",d),placeholder:"1234",maxLength:4}),r.jsx(ue,{label:"Номер паспорта",value:s.passportNumber,onChange:d=>c("passportNumber",d),placeholder:"123456",maxLength:6})]}),r.jsx(ue,{label:"Ссылка на Контур",value:s.konturLink,onChange:d=>c("konturLink",d),placeholder:"https://focus.kontur.ru/entity?query=..."})]}):r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(Qs,{className:"w-5 h-5 text-gray-400"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:u.inn||"Не указан"}),r.jsx("p",{className:"text-xs text-gray-500",children:"ИНН"})]})]}),u.inn&&r.jsx(jt,{text:u.inn,fieldName:"inn"})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(Ss,{className:"w-5 h-5 text-gray-400"}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:f.serial&&f.number?`${f.serial} ${f.number}`:"Не указан"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Паспорт"})]})]}),f.serial&&f.number&&r.jsx(jt,{text:`${f.serial} ${f.number}`,fieldName:"passport"})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx($f,{className:"w-5 h-5 text-gray-400"}),r.jsxs("div",{children:[u.konturLink?r.jsx("a",{href:u.konturLink,target:"_blank",rel:"noopener noreferrer",className:"text-sm font-medium text-blue-600 hover:text-blue-800 transition-colors underline",children:"Открыть в Контуре"}):r.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Не указана"}),r.jsx("p",{className:"text-xs text-gray-500",children:"Ссылка на Контур"})]})]}),u.konturLink&&r.jsx(jt,{text:u.konturLink,fieldName:"konturLink"})]}),!u.inn&&!f.serial&&!f.number&&!u.konturLink&&r.jsxs("div",{className:"text-center py-4",children:[r.jsx(Ss,{className:"w-8 h-8 text-gray-300 mx-auto mb-2"}),r.jsx("p",{className:"text-sm text-gray-500",children:"Документы не заполнены"})]})]})})},Tv=e=>{const t=Math.abs(Number(e)).toLocaleString("ru-RU");return Number(e)>=0?`+${t} ₽`:`-${t} ₽`},Nh=e=>new Date(e).toLocaleDateString("ru-RU"),Fv=({clientFinances:e,showLimit:t=5})=>{const n=[...e||[]].sort((l,o)=>new Date(o.date)-new Date(l.date)),s=t>0?n.slice(0,t):n,a=t>0&&n.length>t;return r.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[r.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:r.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[r.jsx(Ss,{className:"w-5 h-5 mr-2 text-blue-600"}),"История операций",n.length>0&&r.jsx("span",{className:"ml-2 px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded-full",children:n.length})]})}),r.jsx("div",{className:"p-6",children:n.length>0?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"space-y-4",children:s.map(l=>r.jsxs("div",{className:"flex items-start justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[r.jsx("div",{className:"flex-1",children:r.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[r.jsx("div",{className:`p-1.5 rounded-full ${l.type==="income"?"bg-green-100 text-green-600":"bg-red-100 text-red-600"}`,children:r.jsx(Xe,{className:"w-3 h-3"})}),r.jsxs("div",{className:"flex-1",children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:l.description||"Без описания"}),r.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[r.jsxs("div",{className:"flex items-center space-x-1 text-xs text-gray-500",children:[r.jsx(it,{className:"w-3 h-3"}),r.jsx("span",{children:Nh(l.date)})]}),l.category&&r.jsxs("div",{className:"flex items-center space-x-1 text-xs text-gray-500",children:[r.jsx(R0,{className:"w-3 h-3"}),r.jsx("span",{children:l.category})]})]})]})]})}),r.jsxs("div",{className:"text-right",children:[r.jsxs("span",{className:`text-sm font-semibold ${l.type==="income"?"text-green-600":"text-red-600"}`,children:[l.type==="income"?"+":"-",Tv(Math.abs(l.amount))]}),l.status&&r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:l.status==="completed"?"Завершена":l.status==="pending"?"В обработке":l.status==="cancelled"?"Отменена":l.status})]})]},l.id))}),a&&r.jsx("div",{className:"text-center mt-4 pt-4 border-t border-gray-200",children:r.jsxs("p",{className:"text-xs text-gray-500",children:["И еще ",n.length-t," операций..."]})})]}):r.jsxs("div",{className:"text-center py-8",children:[r.jsx(Ss,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),r.jsx("p",{className:"text-gray-500 mb-2",children:"Нет финансовых операций"}),r.jsx("p",{className:"text-xs text-gray-400",children:"Операции появятся здесь после их добавления"})]})})]})},tn={async getClientNotes(e,t={}){const{limit:n=50,offset:s=0}=t,a=new URLSearchParams({limit:n.toString(),offset:s.toString()});console.log(`📝 Получение заметок клиента ID: ${e}`);try{const l=await q.get(`/clients/${e}/notes?${a}`);return console.log(`✅ Получено заметок: ${(l==null?void 0:l.length)||0}`),l||[]}catch(l){throw console.error("❌ Ошибка получения заметок:",l),l}},async createNote(e,t){if(console.log(`📝 Создание заметки для клиента ID: ${e}`,t),!t.content||!t.content.trim())throw new Error("Содержимое заметки не может быть пустым");try{const n=await q.post(`/clients/${e}/notes`,{content:t.content.trim()});return console.log("✅ Заметка создана:",n),n}catch(n){throw console.error("❌ Ошибка создания заметки:",n),n}},async updateNote(e,t){if(console.log(`📝 Обновление заметки ID: ${e}`,t),!t.content||!t.content.trim())throw new Error("Содержимое заметки не может быть пустым");try{const n=await q.put(`/notes/${e}`,{content:t.content.trim()});return console.log("✅ Заметка обновлена:",n),n}catch(n){throw console.error("❌ Ошибка обновления заметки:",n),n}},async deleteNote(e){console.log(`📝 Удаление заметки ID: ${e}`);try{const t=await q.delete(`/notes/${e}`);return console.log("✅ Заметка удалена"),t}catch(t){throw console.error("❌ Ошибка удаления заметки:",t),t}},async getClientNotesStats(e){console.log(`📊 Получение статистики заметок клиента ID: ${e}`);try{const t=await q.get(`/clients/${e}/notes/stats`);return console.log("✅ Статистика получена:",t),t}catch(t){throw console.error("❌ Ошибка получения статистики заметок:",t),t}},validateNoteData(e){const t={};return(!e.content||!e.content.trim())&&(t.content="Содержимое заметки обязательно для заполнения"),e.content&&e.content.length>1e4&&(t.content="Содержимое заметки не может превышать 10000 символов"),{isValid:Object.keys(t).length===0,errors:t}},formatNoteForDisplay(e){return{id:e.id,content:e.content||"",authorId:e.author_id,authorName:e.author_name||"Неизвестный автор",createdAt:e.created_at,updatedAt:e.updated_at,isEdited:e.updated_at&&e.updated_at!==e.created_at}},prepareNoteDataForAPI(e){var t;return{content:((t=e.content)==null?void 0:t.trim())||""}}},Sh=({content:e,className:t=""})=>{const n=p.useMemo(()=>{if(!e)return"";let s=e;return s=s.replace(/^### (.+$)/gim,'<h3 class="text-md font-semibold text-gray-900 mt-4 mb-2">$1</h3>'),s=s.replace(/^## (.+$)/gim,'<h2 class="text-lg font-semibold text-gray-900 mt-4 mb-2">$1</h2>'),s=s.replace(/^# (.+$)/gim,'<h1 class="text-xl font-bold text-gray-900 mt-4 mb-3">$1</h1>'),s=s.replace(/\*\*(.*?)\*\*/g,'<strong class="font-semibold text-gray-900">$1</strong>'),s=s.replace(/\*(.*?)\*/g,'<em class="italic text-gray-800">$1</em>'),s=s.replace(/`([^`]+)`/g,'<code class="bg-gray-100 text-gray-800 px-1.5 py-0.5 rounded text-sm font-mono">$1</code>'),s=s.replace(/```([\s\S]*?)```/g,'<pre class="bg-gray-100 border border-gray-200 rounded-md p-3 my-2 overflow-x-auto"><code class="text-sm font-mono text-gray-800">$1</code></pre>'),s=s.replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:text-blue-800 underline">$1</a>'),s=s.replace(/^[\-\*] (.+$)/gim,'<li class="ml-4">$1</li>'),s=s.replace(/(<li class="ml-4">.*<\/li>)/s,'<ul class="list-disc list-inside space-y-1 my-2">$1</ul>'),s=s.replace(/^\d+\. (.+$)/gim,'<li class="ml-4">$1</li>'),s=s.replace(/(<li class="ml-4">.*<\/li>)/s,'<ol class="list-decimal list-inside space-y-1 my-2">$1</ol>'),s=s.replace(/\n\n/g,'</p><p class="mb-2">'),s=s.replace(/\n/g,"<br />"),!s.includes("<h1")&&!s.includes("<h2")&&!s.includes("<h3")&&!s.includes("<ul")&&!s.includes("<ol")&&!s.includes("<pre")?s=`<p class="mb-2">${s}</p>`:s=`<div>${s}</div>`,s},[e]);return r.jsx("div",{className:`prose prose-sm max-w-none ${t}`,dangerouslySetInnerHTML:{__html:n}})},Rv=({note:e,currentUser:t,onEdit:n,onDelete:s,canEdit:a=!0,canDelete:l=!0})=>{const[o,i]=p.useState(!1),[c,u]=p.useState(e.content||""),[f,d]=p.useState(!1),y=t&&t.id===e.authorId,g=e.authorName||"Неизвестный автор",b=Nh(e.createdAt);e.updatedAt;const v=e.isEdited,S=()=>{u(e.content||""),i(!0)},x=()=>{u(e.content||""),i(!1)},h=async()=>{if(c.trim()){d(!0);try{await n(e.id,c),i(!1)}catch(k){console.error("Ошибка сохранения заметки:",k)}finally{d(!1)}}},m=async()=>{if(confirm("Вы уверены, что хотите удалить эту заметку?"))try{await s(e.id)}catch(k){console.error("Ошибка удаления заметки:",k)}};return r.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow",children:[r.jsxs("div",{className:"flex items-start justify-between mb-3",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:r.jsx(Ee,{className:"w-4 h-4 text-blue-600"})})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:g}),r.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-500",children:[r.jsx(it,{className:"w-3 h-3"}),r.jsx("span",{children:b}),v&&r.jsx("span",{className:"text-gray-400",children:"(изменено)"})]})]})]}),(y||(t==null?void 0:t.role)==="admin")&&r.jsx("div",{className:"flex items-center space-x-2",children:o?r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:h,disabled:f||!c.trim(),className:"flex items-center space-x-1 px-2 py-1 text-green-600 bg-green-50 rounded hover:bg-green-100 transition-colors disabled:opacity-50",children:[r.jsx(Cs,{className:"w-3 h-3"}),r.jsx("span",{className:"text-xs",children:"Сохранить"})]}),r.jsxs("button",{onClick:x,disabled:f,className:"flex items-center space-x-1 px-2 py-1 text-gray-600 bg-gray-50 rounded hover:bg-gray-100 transition-colors disabled:opacity-50",children:[r.jsx(Fe,{className:"w-3 h-3"}),r.jsx("span",{className:"text-xs",children:"Отмена"})]})]}):r.jsxs(r.Fragment,{children:[a&&r.jsx("button",{onClick:S,className:"p-1 text-gray-400 hover:text-blue-600 transition-colors",title:"Редактировать заметку",children:r.jsx(ks,{className:"w-4 h-4"})}),l&&r.jsx("button",{onClick:m,className:"p-1 text-gray-400 hover:text-red-600 transition-colors",title:"Удалить заметку",children:r.jsx(Yr,{className:"w-4 h-4"})})]})})]}),r.jsx("div",{className:"ml-11",children:o?r.jsxs("div",{className:"space-y-3",children:[r.jsx("textarea",{value:c,onChange:k=>u(k.target.value),className:"w-full p-3 border border-gray-300 rounded-md resize-vertical min-h-[100px] focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Введите текст заметки... Поддерживается Markdown форматирование"}),r.jsxs("div",{className:"text-xs text-gray-500",children:[r.jsx("span",{className:"font-medium",children:"Поддерживается:"}),r.jsx("code",{className:"mx-1",children:"**жирный**"}),r.jsx("code",{className:"mx-1",children:"*курсив*"}),r.jsx("code",{className:"mx-1",children:"`код`"}),r.jsx("code",{className:"mx-1",children:"[ссылка](url)"}),r.jsx("code",{className:"mx-1",children:"# заголовок"})]})]}):r.jsx("div",{className:"text-sm text-gray-700",children:r.jsx(Sh,{content:e.content,className:"prose-gray"})})})]})},Av=({currentUser:e,onAdd:t,isAdding:n=!1})=>{const[s,a]=p.useState(""),[l,o]=p.useState(!1),[i,c]=p.useState(!1),u=async y=>{if(y.preventDefault(),!!s.trim())try{await t(s),a(""),c(!1),o(!1)}catch(g){console.error("Ошибка добавления заметки:",g)}},f=()=>{a(""),c(!1),o(!1)},d=(e==null?void 0:e.name)||(e==null?void 0:e.email)||"Вы";return r.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm",children:r.jsxs("form",{onSubmit:u,children:[r.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:r.jsx(Ee,{className:"w-4 h-4 text-green-600"})})}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:d}),r.jsx("p",{className:"text-xs text-gray-500",children:"Добавить новую заметку"})]})]}),r.jsxs("div",{className:"ml-11 space-y-3",children:[r.jsx("div",{className:"relative",children:r.jsx("textarea",{value:s,onChange:y=>a(y.target.value),onFocus:()=>c(!0),placeholder:i?"Введите текст заметки... Поддерживается Markdown форматирование":"Написать заметку...",className:`w-full p-3 border border-gray-300 rounded-md resize-vertical focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all ${i?"min-h-[120px]":"min-h-[60px]"}`})}),i&&s&&l&&r.jsxs("div",{className:"border border-gray-200 rounded-md p-3 bg-gray-50",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"Предварительный просмотр:"}),r.jsx("button",{type:"button",onClick:()=>o(!1),className:"text-xs text-gray-500 hover:text-gray-700",children:"Скрыть"})]}),r.jsx(Sh,{content:s,className:"prose-sm"})]}),i&&r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"text-xs text-gray-500 bg-blue-50 p-2 rounded",children:[r.jsx("span",{className:"font-medium",children:"Поддерживается Markdown:"}),r.jsx("code",{className:"mx-1 bg-white px-1 rounded",children:"**жирный**"}),r.jsx("code",{className:"mx-1 bg-white px-1 rounded",children:"*курсив*"}),r.jsx("code",{className:"mx-1 bg-white px-1 rounded",children:"`код`"}),r.jsx("code",{className:"mx-1 bg-white px-1 rounded",children:"[ссылка](url)"}),r.jsx("code",{className:"mx-1 bg-white px-1 rounded",children:"# заголовок"}),r.jsx("code",{className:"mx-1 bg-white px-1 rounded",children:"- список"})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("div",{className:"flex items-center space-x-2",children:s&&r.jsxs("button",{type:"button",onClick:()=>o(!l),className:"flex items-center space-x-1 px-2 py-1 text-gray-600 bg-gray-100 rounded hover:bg-gray-200 transition-colors",children:[l?r.jsx(_c,{className:"w-3 h-3"}):r.jsx(ra,{className:"w-3 h-3"}),r.jsx("span",{className:"text-xs",children:l?"Скрыть":"Просмотр"})]})}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("button",{type:"button",onClick:f,className:"px-3 py-1.5 text-gray-600 bg-gray-100 rounded hover:bg-gray-200 transition-colors text-sm",children:"Отмена"}),r.jsx("button",{type:"submit",disabled:!s.trim()||n,className:"flex items-center space-x-1 px-3 py-1.5 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:n?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"w-3 h-3 border border-white border-t-transparent rounded-full animate-spin"}),r.jsx("span",{children:"Добавление..."})]}):r.jsxs(r.Fragment,{children:[r.jsx(Of,{className:"w-3 h-3"}),r.jsx("span",{children:"Добавить заметку"})]})})]})]})]})]})]})})},Lv=({client:e,onError:t,onSuccess:n})=>{const{user:s}=Rt(),[a,l]=p.useState([]),[o,i]=p.useState(!0),[c,u]=p.useState(!1);p.useEffect(()=>{e!=null&&e.id&&f()},[e==null?void 0:e.id]);const f=async()=>{i(!0);try{const v=(await tn.getClientNotes(e.id)).map(S=>tn.formatNoteForDisplay(S));l(v)}catch(b){console.error("Ошибка загрузки заметок:",b),t&&t("Не удалось загрузить заметки")}finally{i(!1)}},d=async b=>{if(!(!s||!(e!=null&&e.id))){u(!0);try{const v=tn.validateNoteData({content:b});if(!v.isValid)throw new Error(Object.values(v.errors)[0]);const S=await tn.createNote(e.id,{content:b}),x=tn.formatNoteForDisplay(S);l(h=>[x,...h]),n&&n("Заметка добавлена")}catch(v){console.error("Ошибка добавления заметки:",v),t&&t(v.message||"Не удалось добавить заметку")}finally{u(!1)}}},y=async(b,v)=>{if(!(!s||!(e!=null&&e.id)))try{const S=tn.validateNoteData({content:v});if(!S.isValid)throw new Error(Object.values(S.errors)[0]);const x=await tn.updateNote(b,{content:v}),h=tn.formatNoteForDisplay(x);l(m=>m.map(k=>k.id===b?h:k)),n&&n("Заметка обновлена")}catch(S){console.error("Ошибка редактирования заметки:",S),t&&t(S.message||"Не удалось обновить заметку")}},g=async b=>{if(e!=null&&e.id)try{await tn.deleteNote(b),l(v=>v.filter(S=>S.id!==b)),n&&n("Заметка удалена")}catch(v){console.error("Ошибка удаления заметки:",v),t&&t(v.message||"Не удалось удалить заметку")}};return e?r.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[r.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:r.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[r.jsx(Ci,{className:"w-5 h-5 mr-2 text-blue-600"}),"Заметки",a.length>0&&r.jsx("span",{className:"ml-2 px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded-full",children:a.length})]})}),r.jsxs("div",{className:"p-6",children:[s&&r.jsx("div",{className:"mb-6",children:r.jsx(Av,{currentUser:s,onAdd:d,isAdding:c})}),o?r.jsx("div",{className:"flex items-center justify-center py-8",children:r.jsxs("div",{className:"flex items-center space-x-3 text-gray-600",children:[r.jsx("div",{className:"w-5 h-5 border border-gray-300 border-t-blue-600 rounded-full animate-spin"}),r.jsx("span",{children:"Загрузка заметок..."})]})}):a.length>0?r.jsx("div",{className:"space-y-4",children:a.map(b=>r.jsx(Rv,{note:b,currentUser:s,onEdit:y,onDelete:g},b.id))}):r.jsxs("div",{className:"text-center py-8",children:[r.jsx(Ci,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),r.jsx("p",{className:"text-gray-500 mb-2",children:"Пока нет заметок"}),r.jsx("p",{className:"text-xs text-gray-400",children:"Заметки помогают отслеживать важную информацию о клиенте"})]}),!s&&r.jsxs("div",{className:"flex items-center space-x-2 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[r.jsx(Ct,{className:"w-5 h-5 text-yellow-600"}),r.jsx("p",{className:"text-sm text-yellow-800",children:"Необходимо войти в систему для работы с заметками"})]})]})]}):null},Iv=({clientId:e,onBack:t,onEdit:n,onDelete:s,onError:a,onSuccess:l})=>{const{canDelete:o}=Rt(),{client:i,clientFinances:c,loading:u,error:f,updateClientData:d}=wv(e,a),{editingBasic:y,editingDocs:g,savingBasic:b,savingDocs:v,basicFormData:S,docsFormData:x,handleEditBasic:h,handleCancelBasic:m,handleSaveBasic:k,handleEditDocs:j,handleCancelDocs:N,handleSaveDocs:w,handleBasicChange:C,handleDocsChange:_}=jv(i,E,a);function E(L,U){U&&d(U),l&&l(L)}const T=()=>{s&&i&&s(i)};return u?r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:r.jsxs("div",{className:"flex items-center space-x-3 text-gray-600",children:[r.jsx(Pe,{className:"w-6 h-6 animate-spin"}),r.jsx("span",{children:"Загрузка данных клиента..."})]})}):f||!i?r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx(gl,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),r.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Ошибка загрузки"}),r.jsx("p",{className:"text-gray-600 mb-4",children:f||"Клиент не найден"}),r.jsx("button",{onClick:t,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Вернуться к списку"})]})}):r.jsxs("div",{className:"min-h-screen bg-gray-50",children:[r.jsx(Nv,{onBack:t,onDelete:o()?T:null,client:i}),r.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[r.jsxs("div",{className:"space-y-6",children:[r.jsx(Ev,{client:i,isEditing:y,isSaving:b,formData:S,onEdit:h,onSave:k,onCancel:m,onChange:C}),r.jsx(Dv,{client:i,isEditing:g,isSaving:v,formData:x,onEdit:j,onSave:w,onCancel:N,onChange:_}),r.jsx(Fv,{clientFinances:c,showLimit:5})]}),r.jsx("div",{className:"mt-8",children:r.jsx(Lv,{client:i,onError:a,onSuccess:l})})]})]})},Mv=({workerId:e,onBack:t,onEdit:n,onDelete:s,onError:a,onSuccess:l,workersService:o,financesService:i})=>{const{user:c,canDelete:u,canEdit:f}=Rt(),[d,y]=p.useState(null),[g,b]=p.useState([]),[v,S]=p.useState({totalTransactions:0,totalSalaryPaid:0,totalIncomeBrought:0,workMonths:0,monthlyStats:[]}),[x,h]=p.useState(!0),[m,k]=p.useState(null),[j,N]=p.useState(null),[w,C]=p.useState(!1),[_,E]=p.useState(!1),[T,L]=p.useState(!1),[U,V]=p.useState(!1),[Y,M]=p.useState(!1),[B,F]=p.useState(!1),[D,I]=p.useState(!1),[P,$]=p.useState({full_name:"",position:"",hire_date:"",fire_date:"",is_active:!0}),[A,K]=p.useState({phone:"",telegram_username:""}),[J,te]=p.useState({bank:"",card_number:""});p.useEffect(()=>{if(!e||!o)return;(async()=>{h(!0);try{const X=await o.fetchWorkerById(e);if(y(X),$({full_name:X.full_name||"",position:X.position||"",hire_date:X.hire_date||"",fire_date:X.fire_date||"",is_active:X.is_active}),K({phone:X.phone||"",telegram_username:X.telegram_username||""}),te({bank:X.bank||"",card_number:X.card_number||""}),i&&i.getWorkerFinances)try{const Se=await i.getWorkerFinances(e);b(Array.isArray(Se)?Se:[])}catch(Se){console.warn("Не удалось загрузить финансы работника:",Se),b([])}try{const Se=await o.fetchWorkerStats(e);S(Se||{totalTransactions:0,totalSalaryPaid:0,totalIncomeBrought:0,workMonths:0,monthlyStats:[]})}catch(Se){console.warn("Не удалось загрузить статистику работника:",Se),S({totalTransactions:0,totalSalaryPaid:0,totalIncomeBrought:0,workMonths:0,monthlyStats:[]})}}catch(X){console.error("Ошибка загрузки данных работника:",X),k(X.message||"Ошибка загрузки данных работника"),a&&a("Ошибка загрузки данных работника")}finally{h(!1)}})()},[e]);const fe=async()=>{V(!0);try{const W=await o.updateWorker(e,P);y(X=>({...X,...W})),C(!1),l==null||l("Основная информация обновлена")}catch(W){console.error("Ошибка обновления основной информации:",W),a==null||a("Ошибка обновления основной информации")}finally{V(!1)}},Ce=async()=>{M(!0);try{const W=await o.updateWorker(e,A);y(X=>({...X,...W})),E(!1),l==null||l("Контактная информация обновлена")}catch(W){console.error("Ошибка обновления контактов:",W),a==null||a("Ошибка обновления контактов")}finally{M(!1)}},ye=async()=>{F(!0);try{const W=await o.updateWorker(e,J);y(X=>({...X,...W})),L(!1),l==null||l("Банковская информация обновлена")}catch(W){console.error("Ошибка обновления банковской информации:",W),a==null||a("Ошибка обновления банковской информации")}finally{F(!1)}},Z=async(W,X)=>{try{await navigator.clipboard.writeText(W),N(X),setTimeout(()=>N(null),2e3)}catch(Se){console.error("Ошибка копирования:",Se)}},Qe=()=>{if(d.transactions_count>0){alert(`Невозможно удалить работника. У него есть ${d.transactions_count} связанных финансовых операций.`);return}confirm(`Вы уверены, что хотите удалить работника "${d.full_name}"?`)&&(s==null||s(e))},ve=async()=>{const W=!d.is_active,X=W?`Восстановить работника "${d.full_name}"?`:`Уволить работника "${d.full_name}"?`;if(confirm(X))try{const Se={is_active:W,fire_date:W?null:new Date().toISOString().split("T")[0]},nt=await o.updateWorker(e,Se);y(Wt=>({...Wt,...nt})),l==null||l(W?"Работник восстановлен":"Работник уволен")}catch(Se){console.error("Ошибка изменения статуса работника:",Se),a==null||a("Ошибка изменения статуса работника")}},ne=W=>W?new Date(W).toLocaleDateString("ru-RU"):"—",R=W=>Number(W).toLocaleString("ru-RU")+" ₽",ee=(W,X=null)=>{const Se=new Date(W),nt=X?new Date(X):new Date,Wt=Math.abs(nt-Se),Zt=Math.ceil(Wt/(1e3*60*60*24)),z=Math.floor(Zt/365),G=Math.floor(Zt%365/30);return z>0?`${z} лет ${G} мес.`:G>0?`${G} мес.`:`${Zt} дн.`},ae=()=>d.is_active?r.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800",children:[r.jsx(On,{className:"w-4 h-4 mr-2"}),"Активен"]}):r.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-red-100 text-red-800",children:[r.jsx(gl,{className:"w-4 h-4 mr-2"}),"Уволен"]});return x?r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:r.jsxs("div",{className:"flex items-center space-x-3 text-gray-600",children:[r.jsx(Pe,{className:"w-6 h-6 animate-spin"}),r.jsx("span",{children:"Загрузка данных работника..."})]})}):m||!d?r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx(gl,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),r.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Ошибка загрузки"}),r.jsx("p",{className:"text-gray-600 mb-4",children:m||"Работник не найден"}),r.jsx("button",{onClick:t,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Вернуться к списку"})]})}):r.jsxs("div",{className:"min-h-screen bg-gray-50",children:[r.jsx("div",{className:"bg-white border-b",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:r.jsxs("div",{className:"flex items-center justify-between h-16",children:[r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsxs("button",{onClick:t,className:"flex items-center text-gray-600 hover:text-gray-900 transition-colors",children:[r.jsx(Lf,{className:"w-5 h-5 mr-2"}),"Назад к списку"]}),r.jsx("div",{className:"h-6 w-px bg-gray-300"}),r.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:d.full_name}),ae()]}),r.jsxs("div",{className:"flex items-center space-x-3",children:[f&&r.jsx("button",{onClick:ve,className:`inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md transition-colors ${d.is_active?"text-red-700 bg-red-100 hover:bg-red-200":"text-green-700 bg-green-100 hover:bg-green-200"}`,children:d.is_active?r.jsxs(r.Fragment,{children:[r.jsx(A0,{className:"w-4 h-4 mr-2"}),"Уволить"]}):r.jsxs(r.Fragment,{children:[r.jsx(Dc,{className:"w-4 h-4 mr-2"}),"Восстановить"]})}),u&&r.jsxs("button",{onClick:Qe,className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-red-700 bg-red-100 hover:bg-red-200 transition-colors",children:[r.jsx(Yr,{className:"w-4 h-4 mr-2"}),"Удалить"]})]})]})})}),r.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[r.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[r.jsxs("div",{className:"bg-white rounded-lg shadow",children:[r.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[r.jsx(Ee,{className:"w-5 h-5 mr-2"}),"Основная информация"]}),f&&!w&&r.jsx("button",{onClick:()=>C(!0),className:"text-blue-600 hover:text-blue-800 transition-colors",children:r.jsx(ks,{className:"w-4 h-4"})})]})}),r.jsx("div",{className:"px-6 py-4",children:w?r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ФИО"}),r.jsx("input",{type:"text",value:P.full_name,onChange:W=>$(X=>({...X,full_name:W.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Должность"}),r.jsx("input",{type:"text",list:"positions",value:P.position,onChange:W=>$(X=>({...X,position:W.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"}),r.jsx("datalist",{id:"positions",children:Tf.map(W=>r.jsx("option",{value:W},W))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Дата трудоустройства"}),r.jsx("input",{type:"date",value:P.hire_date,onChange:W=>$(X=>({...X,hire_date:W.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Дата увольнения"}),r.jsx("input",{type:"date",value:P.fire_date||"",onChange:W=>$(X=>({...X,fire_date:W.target.value||null})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),r.jsxs("div",{className:"flex space-x-3",children:[r.jsxs("button",{onClick:fe,disabled:U,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[U?r.jsx(Pe,{className:"w-4 h-4 mr-2 animate-spin"}):r.jsx(Cs,{className:"w-4 h-4 mr-2"}),"Сохранить"]}),r.jsxs("button",{onClick:()=>C(!1),disabled:U,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[r.jsx(Fe,{className:"w-4 h-4 mr-2"}),"Отмена"]})]})]}):r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"ФИО"}),r.jsx("p",{className:"mt-1 text-sm text-gray-900",children:d.full_name})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Должность"}),r.jsx("p",{className:"mt-1 text-sm text-gray-900",children:d.position})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Дата трудоустройства"}),r.jsx("p",{className:"mt-1 text-sm text-gray-900",children:ne(d.hire_date)})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Стаж работы"}),r.jsx("p",{className:"mt-1 text-sm text-gray-900",children:ee(d.hire_date,d.fire_date)})]}),d.fire_date&&r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-500",children:"Дата увольнения"}),r.jsx("p",{className:"mt-1 text-sm text-red-600",children:ne(d.fire_date)})]})]})})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow",children:[r.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[r.jsx(Jn,{className:"w-5 h-5 mr-2"}),"Контактная информация"]}),f&&!_&&r.jsx("button",{onClick:()=>E(!0),className:"text-blue-600 hover:text-blue-800 transition-colors",children:r.jsx(ks,{className:"w-4 h-4"})})]})}),r.jsx("div",{className:"px-6 py-4",children:_?r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Телефон"}),r.jsx("input",{type:"tel",value:A.phone,onChange:W=>K(X=>({...X,phone:W.target.value})),placeholder:"79991234567",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telegram"}),r.jsx("input",{type:"text",value:A.telegram_username,onChange:W=>K(X=>({...X,telegram_username:W.target.value})),placeholder:"@username",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),r.jsxs("div",{className:"flex space-x-3",children:[r.jsxs("button",{onClick:Ce,disabled:Y,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[Y?r.jsx(Pe,{className:"w-4 h-4 mr-2 animate-spin"}):r.jsx(Cs,{className:"w-4 h-4 mr-2"}),"Сохранить"]}),r.jsxs("button",{onClick:()=>E(!1),disabled:Y,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[r.jsx(Fe,{className:"w-4 h-4 mr-2"}),"Отмена"]})]})]}):r.jsxs("div",{className:"space-y-4",children:[d.phone?r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(Jn,{className:"w-4 h-4 text-gray-400 mr-3"}),r.jsx("span",{className:"text-sm text-gray-900",children:d.phone})]}),r.jsx("button",{onClick:()=>Z(d.phone,"phone"),className:"text-gray-400 hover:text-gray-600 transition-colors",children:j==="phone"?r.jsx(Wa,{className:"w-4 h-4"}):r.jsx(Ha,{className:"w-4 h-4"})})]}):r.jsxs("div",{className:"flex items-center text-gray-400",children:[r.jsx(Jn,{className:"w-4 h-4 mr-3"}),r.jsx("span",{className:"text-sm",children:"Не указан"})]}),d.telegram_username?r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(zn,{className:"w-4 h-4 text-blue-400 mr-3"}),r.jsx("span",{className:"text-sm text-gray-900",children:d.telegram_username})]}),r.jsx("button",{onClick:()=>Z(d.telegram_username,"telegram"),className:"text-gray-400 hover:text-gray-600 transition-colors",children:j==="telegram"?r.jsx(Wa,{className:"w-4 h-4"}):r.jsx(Ha,{className:"w-4 h-4"})})]}):r.jsxs("div",{className:"flex items-center text-gray-400",children:[r.jsx(zn,{className:"w-4 h-4 mr-3"}),r.jsx("span",{className:"text-sm",children:"Не указан"})]})]})})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow",children:[r.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[r.jsx(Ns,{className:"w-5 h-5 mr-2"}),"Банковская информация"]}),f&&!T&&r.jsx("button",{onClick:()=>L(!0),className:"text-blue-600 hover:text-blue-800 transition-colors",children:r.jsx(ks,{className:"w-4 h-4"})})]})}),r.jsx("div",{className:"px-6 py-4",children:T?r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Банк"}),r.jsx("input",{type:"text",list:"banks",value:J.bank,onChange:W=>te(X=>({...X,bank:W.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"}),r.jsx("datalist",{id:"banks",children:Df.map(W=>r.jsx("option",{value:W},W))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Номер карты"}),r.jsx("input",{type:"text",value:J.card_number,onChange:W=>te(X=>({...X,card_number:W.target.value.replace(/\D/g,"")})),placeholder:"1234567890123456",maxLength:"19",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500"})]}),r.jsxs("div",{className:"flex space-x-3",children:[r.jsxs("button",{onClick:ye,disabled:B,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[B?r.jsx(Pe,{className:"w-4 h-4 mr-2 animate-spin"}):r.jsx(Cs,{className:"w-4 h-4 mr-2"}),"Сохранить"]}),r.jsxs("button",{onClick:()=>L(!1),disabled:B,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:[r.jsx(Fe,{className:"w-4 h-4 mr-2"}),"Отмена"]})]})]}):r.jsxs("div",{className:"space-y-4",children:[d.bank?r.jsxs("div",{className:"flex items-center",children:[r.jsx(Ns,{className:"w-4 h-4 text-gray-400 mr-3"}),r.jsx("span",{className:"text-sm text-gray-900",children:d.bank})]}):r.jsxs("div",{className:"flex items-center text-gray-400",children:[r.jsx(Ns,{className:"w-4 h-4 mr-3"}),r.jsx("span",{className:"text-sm",children:"Не указан"})]}),d.masked_card_number?r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(Qs,{className:"w-4 h-4 text-gray-400 mr-3"}),r.jsx("span",{className:"text-sm text-gray-900 font-mono",children:D&&d.card_number?d.card_number:d.masked_card_number})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[d.card_number&&r.jsx("button",{onClick:()=>I(!D),className:"text-gray-400 hover:text-gray-600 transition-colors",title:D?"Скрыть номер":"Показать номер",children:D?r.jsx(_c,{className:"w-4 h-4"}):r.jsx(ra,{className:"w-4 h-4"})}),r.jsx("button",{onClick:()=>Z(d.card_number||d.masked_card_number,"card"),className:"text-gray-400 hover:text-gray-600 transition-colors",children:j==="card"?r.jsx(Wa,{className:"w-4 h-4"}):r.jsx(Ha,{className:"w-4 h-4"})})]})]}):r.jsxs("div",{className:"flex items-center text-gray-400",children:[r.jsx(Qs,{className:"w-4 h-4 mr-3"}),r.jsx("span",{className:"text-sm",children:"Не указан"})]})]})})]})]}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"bg-white rounded-lg shadow",children:[r.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:r.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[r.jsx(Gt,{className:"w-5 h-5 mr-2"}),"Статистика"]})}),r.jsx("div",{className:"px-6 py-4 space-y-4",children:r.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[r.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-blue-900",children:"Всего операций"}),r.jsx("p",{className:"text-2xl font-bold text-blue-900",children:v.totalTransactions||d.transactions_count||0})]}),r.jsx(Xe,{className:"w-8 h-8 text-blue-600"})]})}),r.jsx("div",{className:"bg-gradient-to-r from-red-50 to-red-100 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-red-900",children:"Выплачено зарплаты"}),r.jsx("p",{className:"text-xl font-bold text-red-900",children:R(v.totalSalaryPaid||d.total_salary_paid||0)})]}),r.jsx(Xe,{className:"w-8 h-8 text-red-600"})]})}),(v.totalIncomeBrought||d.total_income_brought)>0&&r.jsx("div",{className:"bg-gradient-to-r from-green-50 to-green-100 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-green-900",children:"Принес дохода"}),r.jsx("p",{className:"text-xl font-bold text-green-900",children:R(v.totalIncomeBrought||d.total_income_brought||0)})]}),r.jsx(Xe,{className:"w-8 h-8 text-green-600"})]})}),r.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-purple-100 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-purple-900",children:"Стаж работы"}),r.jsxs("p",{className:"text-xl font-bold text-purple-900",children:[v.workMonths||Math.ceil((new Date-new Date(d.hire_date))/(1e3*60*60*24*30))," мес."]})]}),r.jsx(it,{className:"w-8 h-8 text-purple-600"})]})})]})})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow",children:[r.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:r.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[r.jsx(Xe,{className:"w-5 h-5 mr-2"}),"Последние операции"]})}),r.jsx("div",{className:"px-6 py-4",children:g.length>0?r.jsxs("div",{className:"space-y-3",children:[g.slice(0,5).map(W=>r.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-100 last:border-b-0",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900 truncate max-w-[200px]",children:W.description}),r.jsx("p",{className:"text-xs text-gray-500",children:ne(W.date)})]}),r.jsxs("div",{className:"text-right",children:[r.jsxs("span",{className:`text-sm font-medium ${W.type==="income"?"text-green-600":"text-red-600"}`,children:[W.type==="income"?"+":"-",R(Math.abs(W.amount))]}),r.jsx("p",{className:"text-xs text-gray-500",children:W.status==="planned"?"План":"Факт"})]})]},W.id)),g.length>5&&r.jsxs("button",{onClick:()=>{},className:"w-full text-center text-sm text-blue-600 hover:text-blue-800 py-2",children:["Показать все операции (",g.length,")"]})]}):r.jsxs("div",{className:"text-center py-6",children:[r.jsx(Xe,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),r.jsx("p",{className:"text-sm text-gray-500",children:"Нет финансовых операций"})]})})]}),v.monthlyStats&&v.monthlyStats.length>0&&r.jsxs("div",{className:"bg-white rounded-lg shadow",children:[r.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:r.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center",children:[r.jsx(Gt,{className:"w-5 h-5 mr-2"}),"По месяцам"]})}),r.jsx("div",{className:"px-6 py-4",children:r.jsx("div",{className:"space-y-3",children:v.monthlyStats.slice(0,6).map(W=>r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-900",children:new Date(W.month).toLocaleDateString("ru-RU",{year:"numeric",month:"long"})}),r.jsxs("p",{className:"text-xs text-gray-500",children:[W.transactions," операций"]})]}),r.jsxs("div",{className:"text-right",children:[r.jsxs("p",{className:"text-sm font-medium text-red-600",children:["-",R(W.salary_paid||0)]}),W.income_brought>0&&r.jsxs("p",{className:"text-xs text-green-600",children:["+",R(W.income_brought)]})]})]},W.month))})})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow",children:[r.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:r.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Быстрые действия"})}),r.jsxs("div",{className:"px-6 py-4 space-y-3",children:[r.jsxs("button",{onClick:()=>{},className:"w-full flex items-center justify-center px-4 py-3 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:[r.jsx(Xe,{className:"w-4 h-4 mr-2"}),"Добавить операцию"]}),r.jsxs("button",{onClick:()=>{},className:"w-full flex items-center justify-center px-4 py-3 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:[r.jsx(Gt,{className:"w-4 h-4 mr-2"}),"Все операции"]}),r.jsxs("button",{onClick:()=>{},className:"w-full flex items-center justify-center px-4 py-3 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:[r.jsx(Gt,{className:"w-4 h-4 mr-2"}),"Детальная статистика"]})]})]})]})]})})]})},Pv=()=>{const[e,t]=p.useState({name:"",email:"",phone:"",telegram:""}),[n,s]=p.useState(!1),[a,l]=p.useState(!1),[o,i]=p.useState({}),[c,u]=p.useState({isVisible:!1,message:"",type:"info"}),f=(j,N="info")=>{u({isVisible:!0,message:j,type:N}),setTimeout(()=>{u(w=>({...w,isVisible:!1}))},5e3)},d=()=>{u(j=>({...j,isVisible:!1}))},y=j=>f(j,"success"),g=j=>f(j,"error"),b=j=>{if(!j)return"";let N=j.replace(/https?:\/\/(t\.me\/|telegram\.me\/)/gi,"").replace(/^@/,"").replace(/[^a-zA-Z0-9_]/g,"").toLowerCase();return N?(N=N.slice(0,32),`@${N}`):""},v=j=>j||"",S=j=>{const N=j.replace(/\D/g,"");if(!N)return"";let w=N;if(w.startsWith("8")&&(w="7"+w.slice(1)),w.startsWith("7")||(w="7"+w),w=w.slice(0,11),w.length>=1){const C=w[0],_=w.slice(1,4),E=w.slice(4,7),T=w.slice(7,9),L=w.slice(9,11);let U=`+${C}`;return _.length>0&&(U+=` (${_}`,_.length===3&&(U+=")",E.length>0&&(U+=` ${E}`,T.length>0&&(U+=`-${T}`,L.length>0&&(U+=`-${L}`))))),U}return w},x=j=>{let w=j.replace(/\D/g,"");return w.startsWith("8")&&(w="7"+w.slice(1)),w.startsWith("7")||(w="7"+w),w.slice(0,11)},h=(j,N)=>{if(j==="phone"){const w=S(N);t(C=>({...C,[j]:w}))}else if(j==="telegram"){const w=b(N);t(C=>({...C,[j]:w}))}else t(w=>({...w,[j]:N}));o[j]&&i(w=>({...w,[j]:""}))},m=()=>{const j={};if(e.name.trim()||(j.name="Введите ваше имя"),e.email.trim()?/\S+@\S+\.\S+/.test(e.email)||(j.email="Некорректный email"):j.email="Введите email",!e.phone.trim())j.phone="Введите номер телефона";else{const N=x(e.phone);(N.length!==11||!N.startsWith("7"))&&(j.phone="Введите корректный номер телефона")}return i(j),Object.keys(j).length===0},k=async j=>{if(j.preventDefault(),!!m()){s(!0);try{const N=await fetch("/api/public/leads",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e.name,email:e.email,phone:x(e.phone),telegram:v(e.telegram)})});if(!N.ok){const C=await N.json();throw new Error(C.message||"Ошибка отправки формы")}const w=await N.json();l(!0),y("Заявка успешно отправлена! Мы свяжемся с вами в ближайшее время.")}catch(N){console.error("Ошибка отправки формы:",N),N.message.includes("уже была отправлена")?g("Заявка уже была отправлена. Наш менеджер свяжется с вами в ближайшее время."):N.message.includes("Слишком много заявок")?g("Слишком много заявок с вашего IP. Попробуйте позже."):g("Произошла ошибка при отправке заявки. Попробуйте еще раз или свяжитесь с нами напрямую."),i({submit:N.message})}finally{s(!1)}}};return a?r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 flex items-center justify-center p-4",children:r.jsxs("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-2xl p-8 text-center",children:[r.jsxs("div",{className:"mb-6",children:[r.jsx(On,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),r.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Заявка отправлена!"}),r.jsx("p",{className:"text-gray-600",children:"Спасибо за интерес к нашим курсам. Мы свяжемся с вами в ближайшее время."})]}),r.jsx("button",{onClick:()=>{l(!1),t({name:"",email:"",phone:"",telegram:""})},className:"w-full bg-blue-600 text-white py-3 px-6 rounded-lg hover:bg-blue-700 transition-colors",children:"Отправить еще одну заявку"})]})}):r.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50",children:[r.jsxs("div",{className:"relative overflow-hidden",children:[r.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600/10 to-purple-600/10"}),r.jsxs("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:[r.jsxs("div",{className:"text-center mb-12",children:[r.jsx("h1",{className:"text-4xl md:text-6xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-6",children:"Станьте QA/AQA тестировщиком"}),r.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto mb-8",children:"Изучите навыки тестирования, которые нужны IT-компаниям. Трудоустройство 87% выпускников."}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 mb-12",children:[r.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 shadow-lg",children:[r.jsx("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:"87%"}),r.jsx("div",{className:"text-gray-600",children:"Трудоустройство выпускников"})]}),r.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 shadow-lg",children:[r.jsx("div",{className:"text-3xl font-bold text-purple-600 mb-2",children:"4 мес"}),r.jsx("div",{className:"text-gray-600",children:"Продолжительность курса"})]}),r.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 shadow-lg",children:[r.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:"80k₽"}),r.jsx("div",{className:"text-gray-600",children:"Средняя зарплата"})]})]})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12 items-center",children:[r.jsxs("div",{className:"bg-white/90 backdrop-blur-sm rounded-3xl shadow-2xl p-8",children:[r.jsxs("div",{className:"text-center mb-8",children:[r.jsx(If,{className:"w-12 h-12 text-blue-600 mx-auto mb-4"}),r.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Запишитесь на бесплатную консультацию"}),r.jsx("p",{className:"text-gray-600",children:"Узнайте подробности о курсе и получите персональную программу обучения"})]}),r.jsxs("form",{onSubmit:k,className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Ваше имя *"}),r.jsxs("div",{className:"relative",children:[r.jsx(Ee,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),r.jsx("input",{type:"text",id:"name",value:e.name,onChange:j=>h("name",j.target.value),className:`w-full pl-12 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${o.name?"border-red-500":"border-gray-300"}`,placeholder:"Введите ваше имя"})]}),o.name&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:o.name})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),r.jsxs("div",{className:"relative",children:[r.jsx(zl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),r.jsx("input",{type:"email",id:"email",value:e.email,onChange:j=>h("email",j.target.value),className:`w-full pl-12 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${o.email?"border-red-500":"border-gray-300"}`,placeholder:"your@email.com"})]}),o.email&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:o.email})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-2",children:"Телефон *"}),r.jsxs("div",{className:"relative",children:[r.jsx(Jn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),r.jsx("input",{type:"tel",id:"phone",value:e.phone,onChange:j=>h("phone",j.target.value),className:`w-full pl-12 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${o.phone?"border-red-500":"border-gray-300"}`,placeholder:"+7 (999) 123-45-67"})]}),o.phone&&r.jsx("p",{className:"text-red-500 text-sm mt-1",children:o.phone})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"telegram",className:"block text-sm font-medium text-gray-700 mb-2",children:"Telegram"}),r.jsxs("div",{className:"relative",children:[r.jsx(zn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),r.jsx("input",{type:"text",id:"telegram",value:e.telegram,onChange:j=>h("telegram",j.target.value),className:"w-full pl-12 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"@username или t.me/username"})]}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Введите ваш username или ссылку на профиль"})]}),r.jsx("button",{type:"submit",disabled:n,className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-4 px-6 rounded-lg font-semibold hover:from-blue-700 hover:to-purple-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 transform hover:scale-105",children:n?r.jsxs("div",{className:"flex items-center justify-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Отправляем..."]}):r.jsxs("div",{className:"flex items-center justify-center",children:[r.jsx(Of,{className:"w-5 h-5 mr-2"}),"Записаться на консультацию"]})}),o.submit&&r.jsx("p",{className:"text-red-500 text-sm text-center",children:o.submit})]})]}),r.jsxs("div",{className:"space-y-8",children:[r.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 shadow-lg",children:[r.jsx(it,{className:"w-10 h-10 text-blue-600 mb-4"}),r.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Гибкий график обучения"}),r.jsx("p",{className:"text-gray-600",children:"Занятия в удобное время. Совмещайте обучение с работой или учебой."})]}),r.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 shadow-lg",children:[r.jsx(F0,{className:"w-10 h-10 text-purple-600 mb-4"}),r.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Практический опыт"}),r.jsx("p",{className:"text-gray-600",children:"Работа с реальными проектами и современными инструментами тестирования."})]}),r.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 shadow-lg",children:[r.jsx(N0,{className:"w-10 h-10 text-green-600 mb-4"}),r.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Помощь в трудоустройстве"}),r.jsx("p",{className:"text-gray-600",children:"Подготовка резюме, подготовка к собеседованиям и помощь в поиске работы."})]})]})]})]})]}),c.isVisible&&r.jsxs("div",{className:`fixed top-4 right-4 z-50 px-6 py-4 rounded-lg shadow-lg flex items-center space-x-3 transform transition-all duration-300 ${c.type==="success"?"bg-green-500 text-white":c.type==="error"?"bg-red-500 text-white":"bg-blue-500 text-white"}`,children:[c.type==="success"&&r.jsx(On,{className:"w-5 h-5"}),c.type==="error"&&r.jsx(Ct,{className:"w-5 h-5"}),c.type==="info"&&r.jsx(zn,{className:"w-5 h-5"}),r.jsx("span",{className:"font-medium",children:c.message}),r.jsx("button",{onClick:d,className:"ml-2 hover:bg-white hover:bg-opacity-20 rounded p-1 transition-colors",children:r.jsx(Fe,{className:"w-4 h-4"})})]})]})},$v=()=>{const[e,t]=p.useState(window.location.pathname);return p.useEffect(()=>{const a=()=>{t(window.location.pathname)};return window.addEventListener("popstate",a),()=>window.removeEventListener("popstate",a)},[]),{currentPath:e,navigate:a=>{window.history.pushState({},"",a),t(a)},getParams:()=>{const a=e.split("/");return a[1]==="client"&&a[2]?{clientId:a[2]}:a[1]==="worker"&&a[2]?{workerId:a[2]}:{}}}},Ov=()=>{const{currentPath:e,navigate:t,getParams:n}=$v(),{clientId:s,workerId:a}=n(),l=()=>e.startsWith("/client/")?"client-card":e.startsWith("/worker/")?"worker-card":"dashboard",o=()=>e==="/crm-form"?"CRM_FORM":e==="/leads"?re.LEADS:e==="/finances"?re.FINANCES:e==="/cash-desks"?re.CASH_DESKS:e==="/workers"?re.WORKERS:e==="/"||e==="/clients"?re.CLIENTS:re.LEADS,[i,c]=p.useState(o()),[u,f]=p.useState(me.ACTUAL),[d,y]=p.useState(""),[g,b]=p.useState("name"),[v,S]=p.useState(""),x=l(),[h,m]=p.useState({addClient:!1,editClient:!1,addFinance:!1,editFinance:!1,addCashDesk:!1,editCashDesk:!1,viewCashDeskTransactions:!1,addWorker:!1}),[k,j]=p.useState(null),[N,w]=p.useState(null),[C,_]=p.useState(null),[E,T]=p.useState(null),[L,U]=p.useState(null),{toast:V,showSuccess:Y,showError:M,hideToast:B}=m0(),F=x0(),D=Af(),I=Cc(),P=p0();p.useEffect(()=>{const z=o();z!==i&&(c(z),setTimeout(()=>{switch(z){case re.LEADS:F.searchLeads("");break;case re.CLIENTS:F.searchActiveClients("");break;case re.FINANCES:D.loadAllFinances(),I.searchCashDesks("");break;case re.CASH_DESKS:I.searchCashDesks("");break;case re.WORKERS:P.searchAllWorkers("");break}},100))},[e,i]),p.useEffect(()=>{const z=o();setTimeout(()=>{switch(z){case re.LEADS:F.clients.length===0&&F.searchLeads("");break;case re.CLIENTS:F.clients.length===0&&F.searchActiveClients("");break;case re.FINANCES:D.finances.length===0&&D.loadAllFinances();break;case re.CASH_DESKS:I.cashDesks.length===0&&I.searchCashDesks("");break;case re.WORKERS:P.workers.length===0&&P.searchAllWorkers("");break}},500)},[]);const $=(z,G=null)=>{switch(m(ct=>({...ct,[z]:!0})),z){case"editClient":j(G);break;case"editFinance":w(G);break;case"editCashDesk":_(G);break;case"viewCashDeskTransactions":T(G);break}},A=z=>{switch(m(G=>({...G,[z]:!1})),z){case"editClient":j(null);break;case"editFinance":w(null);break;case"editCashDesk":_(null);break;case"viewCashDeskTransactions":T(null);break}},K=z=>{switch(c(z),y(""),S(""),b("name"),z){case re.LEADS:t("/leads"),setTimeout(()=>{F.searchLeads("")},100);break;case re.CLIENTS:t("/clients"),setTimeout(()=>{F.searchActiveClients("")},100);break;case re.FINANCES:t("/finances"),setTimeout(()=>{const G=D.getCurrentFilters();!G.date_from&&!G.date_to&&D.finances.length===0?D.loadCurrentMonthFinances():D.finances.length===0&&D.applyFilters()},100),setTimeout(()=>{I.searchCashDesks("")},150);break;case re.CASH_DESKS:t("/cash-desks"),setTimeout(()=>{I.searchCashDesks("")},100);break;case re.WORKERS:t("/workers"),setTimeout(()=>{P.searchAllWorkers("")},100);break;default:t("/")}},J=z=>{if(f(z),z===me.STATISTICS)D.loadAllFinances();else{const G=z===me.ACTUAL?"actual":"planned";D.switchStatus(G)}},te=async z=>{try{await P.createWorker(z),Y("Работник успешно создан")}catch(G){M("Ошибка создания работника: "+G.message)}},fe=z=>{t(`/worker/${z.id}`)},Ce=async z=>{try{await P.deleteWorker(z),Y("Работник успешно удален")}catch(G){M("Ошибка удаления работника: "+G.message)}},ye=z=>{t(`/worker/${z.id}`)},Z=z=>{t(`/worker/${z.id}`)},Qe=async z=>{try{await F.createClient(z),A("addClient"),Y("Клиент успешно создан")}catch(G){M("Ошибка создания клиента: "+G.message)}},ve=async(z,G)=>{try{await F.updateClient(z,G),A("editClient"),Y("Клиент успешно обновлен")}catch(ct){M("Ошибка обновления клиента: "+ct.message)}},ne=async z=>{if(confirm("Вы уверены, что хотите удалить этого клиента?"))try{await F.deleteClient(z),Y("Клиент успешно удален")}catch(G){M("Ошибка удаления клиента: "+G.message)}},R=async z=>{try{if(z.isTransfer){console.log("🔄 Создание перевода между кассами через новый API:",z);const G={amount:Math.abs(Number(z.amount)),cash_desk_from_id:Number(z.cashDeskFromId),cash_desk_to_id:Number(z.cashDeskToId),date:z.date,description:z.description||"Перевод между кассами"};console.log("📤 Отправляемые данные для transfer API:",G),await D.createTransfer(G),Y("Перевод между кассами успешно выполнен")}else console.log("💰 Создание финансовой операции:",z),await D.createFinance(z),z.employee?Y("Зарплата успешно выплачена"):Y("Операция успешно создана");A("addFinance")}catch(G){console.error("❌ Ошибка создания операции:",G),M("Ошибка создания операции: "+G.message)}},ee=async z=>{try{console.log("🔄 Обновление финансовой операции:",z);const G=N==null?void 0:N.id;if(!G)throw new Error("ID операции не найден");const ct={date:z.date,amount:Math.abs(Number(z.amount)),type:z.type,status:z.status,description:z.description||"",category:z.category,cash_desk_id:z.cash_desk_id,client_id:z.client_id,worker_id:z.worker_id};Object.keys(ct).forEach(ia=>{ct[ia]===void 0&&delete ct[ia]}),console.log("📤 Отправляем данные в API:",ct),await D.updateFinance(G,ct),A("editFinance"),Y("Операция успешно обновлена")}catch(G){console.error("❌ Ошибка обновления операции:",G),M("Ошибка обновления операции: "+G.message)}},ae=z=>{console.log("📝 Редактирование финансовой операции:",z),$("editFinance",z)},W=async z=>{if(confirm("Вы уверены, что хотите удалить эту операцию?"))try{await D.deleteFinance(z),Y("Операция успешно удалена")}catch(G){console.error("❌ Ошибка удаления операции:",G),M("Ошибка удаления операции: "+G.message)}},X=async z=>{try{await I.createCashDesk(z),A("addCashDesk"),Y("Касса успешно создана")}catch(G){M("Ошибка создания кассы: "+G.message)}},Se=async z=>{try{const G=C==null?void 0:C.id;if(!G)throw new Error("ID кассы не найден");await I.updateCashDesk(G,z),A("editCashDesk"),Y("Касса успешно обновлена")}catch(G){M("Ошибка обновления кассы: "+G.message)}},nt=async z=>{if(confirm("Вы уверены, что хотите удалить эту кассу??"))try{await I.deleteCashDesk(z),Y("Касса успешно удалена")}catch(G){M("Ошибка удаления кассы: "+G.message)}},Wt=async(z,G)=>{try{await F.updateClientStatus(z,G),Y("Статус клиента обновлен")}catch(ct){M("Ошибка обновления статуса: "+ct.message)}};return x==="worker-card"&&a?r.jsx(Mv,{workerId:parseInt(a),onBack:()=>t("/workers"),onEdit:fe,onDelete:Ce,onError:M,onSuccess:Y,workersService:P,financesService:D}):x==="client-card"?r.jsx(Iv,{clientId:s,onBack:()=>t("/"),onEdit:z=>$("editClient",z),onDelete:ne,onError:M,onSuccess:Y}):i==="CRM_FORM"?r.jsx(Pv,{}):r.jsxs(r.Fragment,{children:[r.jsx(L0,{}),r.jsxs("div",{className:"container mx-auto px-4 py-6",children:[r.jsx(I0,{activeTab:i,onTabChange:K}),i===re.LEADS&&r.jsx(rv,{leads:F.clients,loading:F.loading,onUpdateStatus:Wt,onCardClick:z=>window.open(`/client/${z.id}`,"_blank"),onAddLead:()=>$("addClient"),searchTerm:v,onSearch:S}),i===re.CLIENTS&&r.jsx(H0,{clients:F.clients,loading:F.loading,showResults:!0,onEditClient:z=>$("editClient",z),onDeleteClient:ne,onAddClient:()=>$("addClient")}),i===re.FINANCES&&r.jsx(ag,{finances:D.finances,clients:F.clients,cashDesks:I.cashDesks,workers:P.workers,financeSummary:D.financeSummary,loading:D.loading,onAddFinance:()=>$("addFinance"),onEditFinance:ae,onDeleteFinance:W,onError:M,activeSubTab:u,onSubTabChange:J,onApplyFilters:D.applyFilters}),i===re.CASH_DESKS&&r.jsx(og,{cashDesks:I.cashDesks,loading:I.loading,showResults:I.showResults,onEditCashDesk:z=>$("editCashDesk",z),onDeleteCashDesk:nt,onAddCashDesk:()=>$("addCashDesk"),onViewTransactions:z=>$("viewCashDeskTransactions",z)}),i===re.WORKERS&&r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"mb-6",children:r.jsx(M0,{searchTerm:d,onSearchChange:z=>{y(z),P.searchAllWorkers(z)},placeholder:"Поиск работников..."})}),r.jsx(sv,{workers:P.workers,loading:P.loading,searchTerm:d,onSearchChange:z=>{y(z),P.searchAllWorkers(z)},onAddWorker:()=>$("addWorker"),onEditWorker:fe,onDeleteWorker:Ce,onViewWorkerStats:ye,onViewWorkerFinances:Z})]})]}),r.jsx(av,{isOpen:h.addClient,onClose:()=>A("addClient"),onSuccess:Qe,onError:M,context:i===re.LEADS?ce.LEADS:ce.CLIENTS}),r.jsx(lv,{isOpen:h.editClient,client:k,onClose:()=>A("editClient"),onSuccess:ve,onError:M}),r.jsx(cv,{isOpen:h.addFinance,onClose:()=>A("addFinance"),onSuccess:R,onError:M}),r.jsx(uv,{isOpen:h.editFinance,finance:N,onClose:()=>A("editFinance"),onSuccess:ee,onError:M}),r.jsx(dv,{isOpen:h.addCashDesk,onClose:()=>A("addCashDesk"),onSuccess:X,onError:M}),r.jsx(mv,{isOpen:h.editCashDesk,cashDesk:C,onClose:()=>A("editCashDesk"),onSuccess:Se,onError:M}),r.jsx(vv,{isOpen:h.viewCashDeskTransactions,cashDesk:E,onClose:()=>A("viewCashDeskTransactions")}),r.jsx(bv,{isOpen:h.addWorker,onClose:()=>A("addWorker"),onSubmit:te,loading:P.loading}),r.jsx(P0,{message:V.message,type:V.type,isVisible:V.isVisible,onClose:B})]})};function zv(){return r.jsx(d0,{children:r.jsx("div",{className:"min-h-screen bg-gray-50",children:r.jsx(O0,{children:r.jsx(Ov,{})})})})}Fo.createRoot(document.getElementById("root")).render(r.jsx(zv,{}));console.log("🚀 Deployed at Wed Jul 16 04:35:59 +07 2025");console.log("🎉 ФИНАЛЬНЫЙ ТЕСТ ДЕПЛОЯ ПРОШЕЛ! Время:",new Date().toLocaleString());
